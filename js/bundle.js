const regeneratorRuntime = require('runtime.js');"use strict";function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=_superPropBase(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(i):a.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(){var e=function(e){function ButtonAnim(){return _classCallCheck(this,ButtonAnim),_possibleConstructorReturn(this,_getPrototypeOf(ButtonAnim).call(this))}return _inherits(ButtonAnim,Laya.Script),_createClass(ButtonAnim,[{key:"onAwake",value:function(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onDown),this.owner.on(Laya.Event.MOUSE_UP,this,this.onUp),this.owner.on(Laya.Event.MOUSE_OUT,this,this.onUp)}},{key:"onDisable",value:function(){this.owner.offAll(),Laya.Tween.clearAll(this)}},{key:"onDown",value:function(){Laya.Tween.to(this.owner,{scaleX:.8,scaleY:.8},100)}},{key:"onUp",value:function(){Laya.Tween.to(this.owner,{scaleX:1,scaleY:1},100)}}]),ButtonAnim}(),t=function(){function GameConstant(){_classCallCheck(this,GameConstant)}return _createClass(GameConstant,null,[{key:"Init",value:function(){var e=oe.GetLocaleConfig("game_constant");null!=e&&(this.charging=e.charging/60,this.loss=e.loss,this.speedSecond=e.speed,this.speed=e.speed/1e3,this.max_level=e.max_level)}}]),GameConstant}();t.deltaTime=16.66,t.charging=.005,t.loss=.6,t.speed=.004,t.speedSecond=4,t.max_level=3,t.bodySkinIdInBuff=16,t.buffSlowMotionTime=200;var i=function(){function LevelData(){_classCallCheck(this,LevelData),this.totalLen=0,this.speed=0,this.speedSecond=0,this.bgm="1.mp3",this.bgmDuration=0,this.bgmInterval=3e3,this.bgmAdress="",this.bgmName="",this.bgmSinger="",this.npcArray=[],this.boardArray=[],this.floorBarArray=[],this.lastLevel=0,this.initSpeedSecond=0,this.cfgLvPoints=null,this.cfgLvInfos=null,this.cfgBgmInfos=null,this.maxLevel=0,this.cfgLvPoints=oe.GetLocaleConfig("level_point"),this.cfgLvInfos=oe.GetLocaleConfig("level_info"),this.cfgBgmInfos=oe.GetLocaleConfig("bgm_info"),this.maxLevel=this.cfgLvInfos?this.cfgLvInfos.length:0}return _createClass(LevelData,[{key:"GetLevelInfo",value:function(e){if(this.cfgLvInfos)for(var t=0;t<this.cfgLvInfos.length;t++)if(this.cfgLvInfos[t].ID==e)return this.cfgLvInfos[t];return null}},{key:"GetBgmInfo",value:function(e){if(this.cfgBgmInfos)for(var t=0;t<this.cfgBgmInfos.length;t++)if(this.cfgBgmInfos[t].ID==e)return this.cfgBgmInfos[t];return null}},{key:"InitData",value:function(e){if(!this.cfgLvInfos||!this.cfgLvPoints||!this.cfgBgmInfos)return!1;var i=this.cfgLvInfos[e-1];if(!i)return!1;var o=this.cfgLvPoints[i.bgm_ID];if(!o)return!1;var r=this.GetBgmInfo(i.bgm_ID);if(!r)return!1;if(this.lastLevel==e)return!0;this.npcArray=[],this.boardArray=[],this.floorBarArray=[],console.log("=====>重置数组"),this.lastLevel=e,this.speedSecond=r.speed||t.speedSecond,this.initSpeedSecond=this.speedSecond,this.speed=this.speedSecond/1e3,this.totalLen=r.length*this.speedSecond,this.bgm=r.ID+".mp3",this.bgmDuration=r.bgm_end,r.bgm_interval&&r.bgm_interval>0?this.bgmInterval=1e3*r.bgm_interval:this.bgmInterval=0,this.bgmAdress=r.adress,this.bgmName=r.bgm_name,this.bgmSinger=r.bgm_singer;for(var l=0;l<o.length;l++){var h=o[l];if(1==h.type){for(var c=h.parameter.split(","),u=0;u<c.length;u++)if("0"!=c[u]){var d=new a;d.Init(u,h.distance*this.speedSecond,c[u]),this.boardArray.push(d)}}else if(2==h.type){var g=new n;g.Init(h.distance*this.speedSecond,h.parameter),this.floorBarArray.push(g)}else if(3==h.type)for(var m=h.parameter.split(","),f=0;f<m.length;f++)if("0"!=m[f]){var y=new s;y.Init(f,h.distance*this.speedSecond),this.npcArray.push(y)}}return!0}},{key:"AdjustSpeed",value:function(e){console.log("====调整速度====",e),this.speedSecond=e,this.speed=e/1e3}},{key:"RecoverSpeed",value:function(){this.speedSecond=this.initSpeedSecond,this.speed=this.initSpeedSecond/1e3}}]),LevelData}(),n=function(){function ColorFloorBar(){_classCallCheck(this,ColorFloorBar)}return _createClass(ColorFloorBar,[{key:"Init",value:function(e,t){this.pos=new Laya.Vector3(0,0,e),this.prefabName="change_"+t}}]),ColorFloorBar}(),a=function(){function ColorBoard(){_classCallCheck(this,ColorBoard)}return _createClass(ColorBoard,[{key:"Init",value:function(e,t,i){0==e?this.pos=new Laya.Vector3(1.7,0,t):1==e?this.pos=new Laya.Vector3(0,0,t):2==e&&(this.pos=new Laya.Vector3(-1.7,0,t)),this.prefabName="board_"+i,this.skinId=12+Number(i)}}]),ColorBoard}(),s=function(){function NpcPlayer(){_classCallCheck(this,NpcPlayer)}return _createClass(NpcPlayer,[{key:"Init",value:function(e,t){0==e?this.pos=new Laya.Vector3(1.7,0,t):1==e?this.pos=new Laya.Vector3(0,0,t):2==e&&(this.pos=new Laya.Vector3(-1.7,0,t)),this.prefabName="npcPlayer"}}]),NpcPlayer}(),o=function(){function UserData(){_classCallCheck(this,UserData)}return _createClass(UserData,null,[{key:"InitLevelInstance",value:function(){this.levelData=new i}},{key:"getLevelById",value:function(e){for(var t=Object.keys(this.allLevel),i=0;i<t.length;i++){var n=t[i];if(Number(n)==e)return this.allLevel[n]}return-1}}]),UserData}();o.code="",o.token="",o.openId="",o.nickName="",o.gender=0,o.avatarUrl="",o.score=0,o.level=1,o.lastUnlockLevel=1,o.hasUnlock=!1,o.gold=0,o.isNew=!1,o.isLogin=!1,o.loginTime=0,o.loginLocalTime=0,o.lookVideoNum=0,o.doubleStartNum=0,o.shareFailNum=0,o.tryBodySkinId=12,o.isShare=!1,o.bannerTimes=0,o.curMultiple=1,o.inviteShareCount=0,o.attrShareLevel=1,o.buffKeepTime=0,o.attrVideoLevel=1,o.kickBoardCharging=0,o.allLevel={},o.levelData=null;var r=function(){function StorageMgr(){_classCallCheck(this,StorageMgr)}return _createClass(StorageMgr,null,[{key:"setStorage",value:function(e){var t=JSON.stringify(e.val);window.strEnc&&(t=window.strEnc(t,oe.encryptDESKey1,oe.encryptDESKey2,oe.encryptDESKey3)),Laya.Browser.onMiniGame?window.wx.setStorage({key:e.key,data:t,success:e.success,fail:e.fail,complete:e.complete}):localStorage.setItem(e.key,t)}},{key:"getStorage",value:function(e){var t=null;try{t=Laya.Browser.onMiniGame?window.wx.getStorageSync(e):localStorage.getItem(e),window.strDec&&(t=window.strDec(t,oe.encryptDESKey1,oe.encryptDESKey2,oe.encryptDESKey3))}catch(e){}return t}},{key:"getLocalVirbort",value:function(){return"1"!=(Laya.Browser.onMiniGame?window.wx.getStorageSync("virbort"):localStorage.getItem("virbort"))}},{key:"setLocalVirbort",value:function(e){Laya.Browser.onMiniGame?window.wx.setStorage({key:"virbort",success:null,fail:null,complete:null,data:e}):localStorage.setItem("virbort",e)}},{key:"getLocalSound",value:function(){return"1"!=(Laya.Browser.onMiniGame?window.wx.getStorageSync("sound"):localStorage.getItem("sound"))}},{key:"setLocalSound",value:function(e){Laya.Browser.onMiniGame?window.wx.setStorage({key:"sound",success:null,fail:null,complete:null,data:e}):localStorage.setItem("sound",e)}},{key:"saveUserData",value:function(){var e={token:o.token,openId:o.openId,score:o.score,level:o.level};StorageMgr.setStorage({key:"userData",val:e})}},{key:"getLocalUserData",value:function(){if(!o.isLogin){var e=StorageMgr.getStorage("userData");e&&e.length>0&&(e=JSON.parse(e),o.openId=e.openId,o.score=e.score||0,o.level=e.level||1)}}},{key:"getLocalGuide",value:function(e){return"1"==(Laya.Browser.onMiniGame?window.wx.getStorageSync("guide-"+e):localStorage.getItem("guide-"+e))}},{key:"setLocalGuide",value:function(e){Laya.Browser.onMiniGame?window.wx.setStorage({key:"guide-"+e,success:null,fail:null,complete:null,data:"1"}):localStorage.setItem("guide-"+e,"1")}}]),StorageMgr}(),l=Laya.EventDispatcher,h=function(e){function EventMgr(){return _classCallCheck(this,EventMgr),_possibleConstructorReturn(this,_getPrototypeOf(EventMgr).call(this))}return _inherits(EventMgr,l),_createClass(EventMgr,[{key:"emit",value:function(e,t){EventMgr.eventDispatcher.event(e,t)}},{key:"onEvent",value:function(e,t,i,n){EventMgr.eventDispatcher.on(e,t,i,null==n?null:[n])}},{key:"onOnceEvent",value:function(e,t,i,n){EventMgr.eventDispatcher.once(e,t,i,null==n?null:[n])}},{key:"onOffEvent",value:function(e,t,i,n){EventMgr.eventDispatcher.off(e,t,i)}}]),EventMgr}();h.eventDispatcher=new l,h.instance=new h;var c,u="BANNER_SHOW",d="BannerAdHomeError",g="BannerAdTrySkinError",m="BannerAdResurgenceError",f="BannerAdSettleError",y="BannerAdGameOverError",v="BannerAdOnLineCoinRewardError",p="BannerAdGoldenEggError",w="PLAYER_DIE",b="PLAYER_COUNT_CHANGE",L="PLAYER_KICK",k="UPDATE_GOLD",_="DRAW_MOUSE_DOWN",A="DRAW_MOUSE_MOVE",I="LOAD_3D_COMPELETE",C="NET_ERROR";!function(e){e[e.Hero=1]="Hero",e[e.Gun=2]="Gun",e[e.Follower=3]="Follower",e[e.Try=4]="Try",e[e.GoldDouble=5]="GoldDouble",e[e.Skin=6]="Skin"}(c||(c={}));var B,S=function(){function HttpUtils(){_classCallCheck(this,HttpUtils)}return _createClass(HttpUtils,[{key:"request",value:function(e,t){var i=this,n=e.meth||"post",a=e.data||{},s="";s=e.url.indexOf("https://")>-1||e.url.indexOf("http://")>-1?e.url:oe.serverUrl+e.url;o.token&&(a.token=o.token);var r=new Laya.HttpRequest;r.http.timeout=1e4,r.http.ontimeout=function(n){t&&i.request(e,t)},r.once(Laya.Event.COMPLETE,this,function(t){t&&t.data&&(t=JSON.parse(t.data)),e.callback&&e.callback(t),e.callback=null,e=null}),r.once(Laya.Event.ERROR,this,function(n){h.instance.emit(C),t&&Laya.timer.once(5e3,i,function(){i.request(e,t)})});var l=JSON.stringify(a);console.log("url==",s+"  param==",l),oe.encryptDES&&window.strEnc&&(l=window.strEnc(l,oe.encryptDESKey1,oe.encryptDESKey2,oe.encryptDESKey3)),r.send(s,"param="+encodeURIComponent(l),n,"json",["Content-Type","application/x-www-form-urlencoded"])}},{key:"requestStatistics",value:function(e){var t=e.meth||"post",i=e.data||{};e.url=e.url||"";var n=oe.statisticsUrl+e.url;o.token&&(i.token=o.token);var a=new Laya.HttpRequest;a.once(Laya.Event.COMPLETE,this,function(t){e.callback&&e.callback(t)}),a.once(Laya.Event.ERROR,this,function(e){i.fail&&i.fail(e)});var s=JSON.stringify(i);a.send(n,"param="+s,t,"json",["Content-Type","application/x-www-form-urlencoded"])}},{key:"getConfig",value:function(e,t){if(oe.serverUrls[e]){var i=new Laya.HttpRequest;i.once(Laya.Event.COMPLETE,this,function(i){i&&"object"==_typeof(i)?t&&t(e,i):t&&t(e,null)}),i.send(oe.serverUrls[e],"","get","json",["Content-Type","application/json"])}}}]),HttpUtils}(),P=function(){function MyLog(){_classCallCheck(this,MyLog)}return _createClass(MyLog,null,[{key:"log",value:function(e){if(oe.isLog){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];null!=i&&i.length>0?console.log(e,i):console.log(e)}}},{key:"error",value:function(e){if(oe.isLog){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];null!=i&&i.length>0?console.error(e,i):console.error(e)}}}]),MyLog}();!function(e){e[e.NORMAL=1e3]="NORMAL",e[e.ATTR_UPGRADE=1001]="ATTR_UPGRADE",e[e.RESURGENCE=1002]="RESURGENCE",e[e.UNLOCK_LEVEL=1003]="UNLOCK_LEVEL",e[e.EGG=1004]="EGG"}(B||(B={}));var M=function(){function StatisticsMgr(){_classCallCheck(this,StatisticsMgr),this.httpsArr=[]}return _createClass(StatisticsMgr,[{key:"init",value:function(){Laya.timer.loop(6e4,this,this.goPost)}},{key:"loginStatisticsPost",value:function(){var e={action:"1005",from_appid:o.fromAppid,from_imgid:o.fromImgid,code:o.code,isnew:o.isNew?1:0};this.statisticsPost(e)}},{key:"authorStatistics",value:function(){var e={action:"1006",from_appid:o.fromAppid,from_imgid:o.fromImgid,code:o.code,isnew:o.isNew?1:0};this.statisticsPost(e)}},{key:"startGameStatistics",value:function(){this.statisticsPost({action:"1008"})}},{key:"shareStatistics",value:function(e){var t={action:"1009",type:e};this.statisticsPost(t)}},{key:"clickVideoStatistics",value:function(e){var t={action:"1010",type:e};this.statisticsPost(t)}},{key:"videoPlayOverAdStatistics",value:function(e){var t={action:"1011",type:e};this.statisticsPost(t)}},{key:"navigateToMiniProgramStatistics",value:function(e){e.action="1007",this.statisticsPost(e)}},{key:"navigateToMiniProgramBackStatistics",value:function(e){e.action="1017",this.statisticsPost(e)}},{key:"interstitialAdStatistics",value:function(){this.statisticsPost({action:"1101",type:4})}},{key:"statisticsPost",value:function(e){var t=this,i={channel:o.channelId,my_appid:oe.myAppid,openid:o.openId};for(var n in e)e.hasOwnProperty(n)&&"toLinks"!=n&&(i[n]=e[n]);i.fail=function(){t.httpsArr.push(i)},i.callback=function(e){0!=e.code&&t.httpsArr.push(i)},se.instance.statisticsPost(i)}},{key:"goPost",value:function(){for(var e=this,t=0;t<this.httpsArr.length;t++){var i=this.httpsArr[t];i&&(this.httpsArr[t].index=t,i.index=t,i.fail=null,i.callback=function(t){if(0==t.code)for(var i=0;i<e.httpsArr.length;i++){e.httpsArr[i].index=t.index,e.httpsArr.splice(i,1);break}},se.instance.statisticsPost(i))}}}]),StatisticsMgr}();M.instance=new M;var E,D=function(e){function CameraShake(){var e;return _classCallCheck(this,CameraShake),(e=_possibleConstructorReturn(this,_getPrototypeOf(CameraShake).apply(this,arguments))).shakeTime=0,e.shakeAmount=0,e.isShake=!1,e}return _inherits(CameraShake,Laya.Script3D),_createClass(CameraShake,[{key:"onAwake",value:function(){this.myTransform=this.owner.transform}},{key:"Shake",value:function(e,t){this.originalPos=this.myTransform.localPosition.clone(),this.shakeTime=e,this.shakeAmount=t,this.isShake=!0}},{key:"ResetCameraPos",value:function(){this.myTransform.localPosition=this.originalPos.clone(),this.StopShake()}},{key:"StopShake",value:function(){this.shakeTime=0,this.isShake=!1}},{key:"onUpdate",value:function(){if(this.isShake)if(this.shakeTime>0){this.shakeTime-=Laya.updateTimer.scale>0?Laya.updateTimer.delta:0;var e=this.InsideUnitCircle();this.myTransform.localPosition=new Laya.Vector3(this.originalPos.x+e.x*this.shakeAmount,this.originalPos.y+e.y*this.shakeAmount,this.originalPos.z)}else this.ResetCameraPos()}},{key:"InsideUnitCircle",value:function(){var e=Math.sqrt(Math.random()),t=2*Math.random()*Math.PI;return{x:e*Math.cos(t),y:e*Math.sin(t)}}}]),CameraShake}(),T=function(){function SceneMgr(){_classCallCheck(this,SceneMgr),this.cameraPos=new Laya.Vector3(0,12,-8.3),this.skinLists={},this.skinColorLists={12:new Laya.Vector4(1,1,1,1),13:new Laya.Vector4(14/255,248/255,11/255,1),14:new Laya.Vector4(35/255,182/255,1,1),15:new Laya.Vector4(243/255,38/255,234/255,1),16:new Laya.Vector4(243/255,38/255,.2,1),17:new Laya.Vector4(1,249/255,23/255,1)},this.skyColorList=[new Laya.Vector4(236/255,232/255,158/255,1),new Laya.Vector4(160/255,219/255,235/255,1),new Laya.Vector4(229/255,140/255,224/255,1),new Laya.Vector4(161/255,248/255,162/255,1),new Laya.Vector4(187/255,142/255,233/255,1),new Laya.Vector4(231/255,182/255,156/255,1)],this.fogColors=[new Laya.Vector3(236/255,232/255,158/255),new Laya.Vector3(160/255,219/255,235/255),new Laya.Vector3(229/255,140/255,224/255),new Laya.Vector3(161/255,248/255,162/255),new Laya.Vector3(187/255,142/255,233/255),new Laya.Vector3(231/255,182/255,156/255)],this.outVector4=new Laya.Vector4}return _createClass(SceneMgr,[{key:"InitMain",value:function(e){Laya.stage.addChildAt(e,0),this.mainScene=e,this.mainCamera=e.getChildByName("Main Camera"),this.cameraShake=this.mainCamera.addComponent(D),this.mainScene.enableFog=!0,this.mainScene.fogStart=10,this.mainScene.fogRange=50;var t=e.getChildByName("zhuguang");t.shadowMode=Laya.ShadowMode.SoftLow,t.shadowDistance=15,t.shadowStrength=.5,this.models=e.getChildByName("models");var i=this.models.getChildByName("npcPlayer");i&&(i.getChildByName("body").getChildByName("NN_player").skinnedMeshRenderer.castShadow=!0);this.models.active=!1,this.effects=e.getChildByName("effects"),this.effects.active=!1,this.road=e.getChildByName("road"),this.road.meshRenderer.receiveShadow=!0,this.player=e.getChildByName("player"),this.player.getChildByName("body").getChildByName("NN_player").skinnedMeshRenderer.castShadow=!0,this.player.active=!1,this.trail=e.getChildByName("trail"),this.trail.trailFilter.alignment=Laya.TrailFilter.ALIGNMENT_VIEW,this.trailColorGradient=this.trail.trailFilter.colorGradient;for(var n=e.getChildByName("skins"),a=n.meshRenderer.sharedMaterials.length,s=0;s<a;s++){var o=n.meshRenderer.sharedMaterials[s].name;this.skinLists[o]=n.meshRenderer.sharedMaterials[s]}}},{key:"getSkinMaterialsByName",value:function(e){return this.skinLists[e]?this.skinLists[e]:null}},{key:"getSkinColorByName",value:function(e){return this.skinColorLists[e]?this.skinColorLists[e]:null}},{key:"ChangeScene",value:function(){var e=le.random(0,this.skyColorList.length-1);this.mainScene.fogColor=this.fogColors[e],this.mainCamera.clearColor=this.skyColorList[e]}},{key:"WorldToScreen2",value:function(e){return this.mainCamera.viewport.project(e,this.mainCamera.projectionViewMatrix,this.outVector4),new Laya.Vector2(this.outVector4.x/Laya.stage.clientScaleX,this.outVector4.y/Laya.stage.clientScaleY)}}]),SceneMgr}();T.Instance=new T,function(e){e[e.player=9]="player",e[e.playerIdle=10]="playerIdle",e[e.change=11]="change",e[e.board=12]="board",e[e.emotion=13]="emotion"}(E||(E={}));var x=Laya.Vector3,O=function(){function MathUtil(){_classCallCheck(this,MathUtil)}return _createClass(MathUtil,null,[{key:"Range",value:function(e,t){return e>t?-1:e==t?e:Math.round(Math.random()*(t-e)+e)}},{key:"RangeNumber",value:function(e,t){return e>t?-1:e==t?e:e+Math.random()*(t-e)}},{key:"RandRate",value:function(e,t){for(var i=this.Range(1,t),n=0;n<e.length;n++)if((i-=e[n])<=0)return n;return-1}},{key:"RandRate1",value:function(e,t){for(var i=this.Range(1,t),n=0,a=0;a<e.length;a++)if(i<(n+=e[a]))return a;return-1}},{key:"RangeArray",value:function(e,t,i,n){if(e>=t)return null;if(i>t-e+1)return null;var a=new Array;if(n)for(;a.length<i;)a.push(MathUtil.Range(e,t));else for(;a.length<i;){var s=MathUtil.Range(e,t);-1==a.indexOf(s)&&a.push(s)}return a}},{key:"Clamp01",value:function(e){return e<0?0:e>1?1:e}},{key:"Clamp",value:function(e,t,i){return e<t?t:e>i?i:e}},{key:"AddV",value:function(e,t){return new Laya.Vector3(e.x+t.x,e.y+t.y,e.z+t.z)}},{key:"SubV",value:function(e,t){return new Laya.Vector3(e.x-t.x,e.y-t.y,e.z-t.z)}},{key:"ScaleV",value:function(e,t){return new Laya.Vector3(e.x*t,e.y*t,e.z*t)}},{key:"CV3",value:function(e){return new Laya.Vector3(e[0],e[1],e[2])}},{key:"RV3",value:function(e,t,i){var n=new x(0,0,0);x.scale(e,Math.cos(MathUtil.Deg2Rad*i),n);var a=new x(0,0,0);x.scale(t,(1-Math.cos(MathUtil.Deg2Rad*i))*(e.x*t.x+e.y*t.y+e.z*t.z),a);var s=new x(0,0,0),o=new x(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x);return x.scale(o,Math.sin(MathUtil.Deg2Rad*i),s),new x(n.x+a.x+s.x,n.y+a.y+s.y,n.z+a.z+s.z)}}]),MathUtil}();O.Rad2Deg=57.29578,O.Deg2Rad=.01745329;var j=function(e){function Buff(){return _classCallCheck(this,Buff),_possibleConstructorReturn(this,_getPrototypeOf(Buff).apply(this,arguments))}return _inherits(Buff,Laya.Script3D),_createClass(Buff,null,[{key:"Init",value:function(){this.energy=0,this.buffStartTime=0,this.isInBuff=!1,this.moveEndPosBuff=0}},{key:"Update",value:function(){oe.hideTotalTime>0||(this.energy<1?(this.energy=Math.min(1,this.energy+t.charging),this.energy>=1&&(this.buffStartTime=Laya.timer.currTimer,this._setBuff(!0))):Laya.timer.currTimer-this.buffStartTime>o.buffKeepTime&&(this.energy=0,this._setBuff(!1)))}},{key:"AddEnergy",value:function(){this.energy>=1||(this.energy=Math.min(1,this.energy+o.kickBoardCharging),this.energy>=1&&(this.buffStartTime=Laya.timer.currTimer,this._setBuff(!0)))}},{key:"lossEnergy",value:function(){this.energy=Math.max(0,this.energy-t.loss),this._setBuff(!1)}},{key:"SetApproachBuff",value:function(){this.energy=.999}},{key:"_setBuff",value:function(e){this.isInBuff=e;var t=Y.Instance.moveDis;this.moveEndPosBuff=e?t+o.buffKeepTime*Y.Instance.Speed:0}}]),Buff}();j.energy=0,j.buffStartTime=0,j.isInBuff=!1,j.moveEndPosBuff=0;var V,G=function(e){function ElementBase(){var e;return _classCallCheck(this,ElementBase),(e=_possibleConstructorReturn(this,_getPrototypeOf(ElementBase).apply(this,arguments))).threshold=-10,e.npcWaveDis=15,e.playerKickDis=3,e.birthZ=0,e.birthRalatePlayerZ=0,e.anim=null,e.playWaveAni=!1,e.emitKickAni=!1,e}return _inherits(ElementBase,Laya.Script3D),_createClass(ElementBase,[{key:"Init",value:function(e){if(this.obj=this.owner,this.obj.transform.localPosition=e,this.meshObj=this.owner,this.birthZ=e.z,this.birthRalatePlayerZ=e.z+3,this.isDead=!1,this.emitKickAni=!1,this.obj.layer!=E.emotion){if(this.obj.layer==E.playerIdle){var i=this.obj.getChildByName("body");this.anim=i.getComponent(Laya.Animator),this.anim.play("stand"),this.playWaveAni=!1}Laya.timer.loop(t.deltaTime,this,this.onMyUpdate)}}},{key:"onMyUpdate",value:function(){oe.isHide||oe.playingVideo||Y.Instance.gameStatus==z.Execute&&(this.birthRalatePlayerZ-Y.Instance.moveDis<this.threshold?H.Instance.Push(this.obj):this.obj.layer==E.playerIdle?this.anim&&!this.playWaveAni&&this.birthRalatePlayerZ-Y.Instance.moveDis<=this.npcWaveDis&&(this.playWaveAni=!0,this.anim.play("wave")):this.obj.layer==E.board?!j.isInBuff&&!this.isDead&&!this.emitKickAni&&this.birthRalatePlayerZ-Y.Instance.moveDis<=this.playerKickDis&&(this.emitKickAni=!0,h.instance.emit(L)):this.obj.layer==E.change&&Y.Instance.isRecoveredElement&&!this.meshObj.meshRenderer.enable&&(this.meshObj.meshRenderer.enable=!0))}}]),ElementBase}(),N=function(e){function EmotionBoard(){var e;return _classCallCheck(this,EmotionBoard),(e=_possibleConstructorReturn(this,_getPrototypeOf(EmotionBoard).apply(this,arguments))).boardSkinId=0,e}return _inherits(EmotionBoard,G),_createClass(EmotionBoard,[{key:"Init",value:function(e){_get(_getPrototypeOf(EmotionBoard.prototype),"Init",this).call(this,e)}},{key:"OnBreakOut",value:function(){var e=this;if(!this.isDead){this.isDead=!0,this.obj.active=!1,X.instance.playSound("kick_emotion_"+le.random(1,3)),this._createEffect("emotion_break");var t=this.effectObj.getComponent(Laya.Animator).getDefaultState().clip.duration();Laya.timer.once(500*t,this,function(){H.Instance.PushEffect(e.effectObj),H.Instance.Push(e.obj)})}}},{key:"_createEffect",value:function(e){this.effectObj=H.Instance.PopEffect(e),this.obj.parent.addChild(this.effectObj),this.effectObj.active=!0,this.effectObj.transform.localPosition=this.obj.transform.localPosition,this.effectObj.transform.localRotation=this.obj.transform.localRotation}},{key:"onDisable",value:function(){Laya.timer.clearAll(this)}}]),EmotionBoard}(),R=function(e){function PlayerMgr(){var e;return _classCallCheck(this,PlayerMgr),(e=_possibleConstructorReturn(this,_getPrototypeOf(PlayerMgr).apply(this,arguments))).deltaTime=0,e.moveDirtX=0,e.playerList=[],e.movePoints=[],e.pointInterval=20,e.lastBodySkinId=13,e.lastPlayKickSoundPosZ=-1,e.isCanStartFall=!1,e.trialTimeChange={time:.01},e.lastColor=null,e.lastColor1=null,e.lastColorTime1=0,e.relieveEffect=null,e.isClickDowning=!1,e}return _inherits(PlayerMgr,Laya.Script3D),_createClass(PlayerMgr,[{key:"onEnable",value:function(){h.instance.onEvent(_,this,this.OnMyMouseDown),h.instance.onEvent(A,this,this.OnMyMouseMove)}},{key:"onDisable",value:function(){h.instance.onOffEvent(_,this,this.OnMyMouseDown),h.instance.onOffEvent(A,this,this.OnMyMouseMove)}},{key:"OnMyMouseDown",value:function(){if(Y.Instance.gameStatus==z.PassEmotion&&this.isCanStartFall)return Y.Instance.setSlowMotion(!1),void this.FallToEmotion()}},{key:"OnMyMouseMove",value:function(e){this.moveDirtX=e.moveX}},{key:"GamePrepare",value:function(){this.lastBodySkinId=13,this.lastPlayKickSoundPosZ=-1,this.isCanStartFall=!1,this.deltaTime=0,this._resetValues(),this._initFirstPlayer(new Laya.Vector3(0,0,-3)),this.playerList.length>0&&this.playerList[0].GamePrepare()}},{key:"_resetValues",value:function(){this.lastColor=null,this.lastColor1=null;var e=this.playerList.length;e>0&&this.playerList.splice(0,e);var t=this.movePoints.length;e>0&&this.movePoints.splice(0,t)}},{key:"_initFirstPlayer",value:function(e){var t=H.Instance.PopPlayer();if(null!=t){T.Instance.mainScene.addChild(t),t.transform.localPosition=e,t.active=!0;var i=t.addComponent(U),n=this.movePoints.length;i.Init(0,V.Player,T.Instance.trail,this.lastBodySkinId,n),this.playerList.push(i)}}},{key:"GameStart",value:function(){this.pointInterval=Math.ceil(80/Y.Instance.SpeedSecond),this.playerList.length>0&&this.playerList[0].GameStart()}},{key:"GameExecute",value:function(){this.MoveForward()}},{key:"MoveForward",value:function(){if(!(oe.hideTotalTime>0)){Y.Instance.moveDis=Math.min(Y.Instance.endLen,Y.Instance.Speed*(Laya.timer.currTimer-Y.Instance.startTime));var e=T.Instance.trail.transform.localPosition,t=e.x;t=O.Clamp(e.x-this.moveDirtX,-2,2),this.moveDirtX=0,Y.Instance.moveDisX+=.6*(t-e.x),T.Instance.trail.trailFilter.alignment=t-e.x!=0?Laya.TrailFilter.ALIGNMENT_TRANSFORM_Z:Laya.TrailFilter.ALIGNMENT_VIEW;var i=new Laya.Vector3(t,e.y,-3+Y.Instance.moveDis);T.Instance.trail.transform.localPosition=i,this.movePoints.push(i),this.CheckPointsCapacity();for(var n=0;n<this.playerList.length;n++)this.playerList[n].StartMove()}}},{key:"GameRevive",value:function(){var e=this;this._resetValues(),null==this.relieveEffect&&(this.relieveEffect=H.Instance.PopEffect("relieve"),T.Instance.mainScene.addChild(this.relieveEffect)),this.relieveEffect.active=!0;var t=T.Instance.trail.transform.localPosition;this.relieveEffect.transform.localPosition=new Laya.Vector3(t.x,.8,t.z),Laya.timer.once(1e3,this,function(){e.relieveEffect.active=!1}),this._initFirstPlayer(new Laya.Vector3(0,0,t.z)),this.playerList.length>0&&this.playerList[0].GameRevive()}},{key:"ForwardToEmotion",value:function(){var e=this,i=0;j.isInBuff&&(i=200);for(var n=this.playerList.length,a=function(t){var n=e.playerList[t];Laya.Tween.to({time:0},{time:100},150,null,Laya.Handler.create(e,function(){n.OnFall(t)}),100*t+i)},s=0;s<n;s++)a(s);Laya.timer.loop(t.deltaTime,this,this.CheckPlayerFallCollision)}},{key:"_getFirstPlayerWhenFall",value:function(){for(var e=0;e<this.playerList.length;e++)if(this.playerList[e]&&!this.playerList[e].isDead&&this.playerList[e].isFalling)return this.playerList[e];return null}},{key:"_getFirstEmotionWhenFall",value:function(){for(var e=0;e<Y.Instance.emotionObj.numChildren;e++){var t=Y.Instance.emotionObj.getChildAt(e).getComponent(N);if(t&&!t.isDead)return t}return null}},{key:"FallToEmotion",value:function(){var e=this;if(!this.isClickDowning){var t=this._getFirstPlayerWhenFall();if(null!=t){var i=this._getFirstEmotionWhenFall();if(null!=i){this.isClickDowning=!0,Laya.Tween.clearAll(t.obj.transform),t.FinishFallAni();var n=Y.Instance.emotionObj.transform.localPositionY,a=n+i.obj.transform.localPositionY,s=t.obj.transform.localPositionY,o=Math.abs(s-a);Laya.Tween.clearAll(Y.Instance.emotionObj.transform),Y.Instance.CompleteEmotionRotateAni(),Laya.Tween.to(Y.Instance.emotionObj.transform,{localPositionY:n+3*o/4},60),Laya.Tween.to(t.obj.transform,{localPositionY:s-o/4},60,null,Laya.Handler.create(this,function(){t.breakHp--,t.breakHp<=0?(e.RemovePlayerOfEmotion(),Laya.Tween.to(Y.Instance.emotionObj.transform,{localPositionY:n+o},1e4)):(t.startFallMove2(s-o-2,3e3),Y.Instance.setSlowMotion(!0));var i=e._getFirstEmotionWhenFall();null!=i&&i.OnBreakOut(),e.isClickDowning=!1}))}}}}},{key:"CheckPlayerFallCollision",value:function(){if(!this.isClickDowning)if(this.playerList.length<1)Laya.timer.clear(this,this.CheckPlayerFallCollision);else{var e=this._getFirstPlayerWhenFall();if(null!=e){var t=this._getFirstEmotionWhenFall();if(null!=t&&e.obj.transform.localPositionY<=t.obj.transform.localPositionY+Y.Instance.emotionObj.transform.localPositionY){e.breakHp--,e.breakHp<=0&&this.RemovePlayerOfEmotion(),t.OnBreakOut();var i=Y.Instance.emotionObj.transform.localPositionY;Laya.Tween.to(Y.Instance.emotionObj.transform,{localPositionY:i+2},1e4)}}}}},{key:"CheckPointsCapacity",value:function(){var e=this.movePoints.length;if(!(e%this.pointInterval>0)){var t=this.playerList.length,i=this.pointInterval*(t+1);if(e>i){var n=e-i;this.movePoints.splice(0,n);for(var a=0;a<this.playerList.length;a++)this.playerList[a].UpdatePosIndex(n)}}}},{key:"AddFollowPlayer",value:function(){var e=H.Instance.PopPlayer();if(null!=e){T.Instance.mainScene.addChild(e),e.active=!0;var t=e.addComponent(U),i=this.playerList.length,n=this.playerList[i-1],a=this.movePoints.length,s=Math.max(0,a-1-i*this.pointInterval);t.Init(i,V.Follow,n.obj,n.bodySkinId,s),t.GameStart(),this.playerList.push(t),e.active=!j.isInBuff,h.instance.emit(b,[1])}}},{key:"RemovePlayerOfExcute",value:function(){if(!(this.playerList.length<1)){var e=this.playerList[0];this.lastBodySkinId=e.bodySkinId,e.Dead(),this.playerList.splice(0,1);for(var t=null,i=0,n=0;n<this.playerList.length;n++){var a=this.playerList[n];null!=a&&(0==i?a.ResetItWhenRemoveTop(i,V.Player,T.Instance.trail,this.lastBodySkinId,i*this.pointInterval):null!=t&&a.ResetItWhenRemoveTop(i,V.Follow,t.followObj,t.bodySkinId,i*this.pointInterval),t=a,i++)}h.instance.emit(b,[-1]),this.playerList.length<=0&&Y.Instance.Dead()}}},{key:"RemovePlayerOfEmotion",value:function(){this.playerList.length<1||(this.playerList[0].Dead(),this.playerList.splice(0,1),h.instance.emit(b,[-1]),this.playerList.length<=0?(Y.Instance.setSlowMotion(!1),Y.Instance.GamePass()):Y.Instance.setSlowMotion(!0))}},{key:"GetTopPlayer",value:function(){return this.playerList.length>0?this.playerList[0]:null}},{key:"TriggBuffEffect",value:function(){var e=this.playerList.length;if(!(e<1)){this.lastColor=null,this.lastColor1=null,this.playerList[0].TriggerBuff();for(var t=1;t<e;t++)this.playerList[t].MergePosWhenBuffOn()}}},{key:"CloseBuffEffect",value:function(){var e=this.playerList.length;if(!(e<1)){var t=this.movePoints.length;this.playerList[0].CloseBuff();for(var i=this.playerList[0].bodySkinId,n=1;n<e;n++)null!=this.playerList[n]&&this.playerList[n].ExtendPosWhenBuffOff(t-1-n*this.pointInterval,i)}}},{key:"UnionBodySkin",value:function(){var e=this.playerList.length;if(!(e<2))for(var t=this.playerList[0].bodySkinId,i=1;i<e;i++)null!=this.playerList[i]&&this.playerList[i].InitBodySkin(t)}},{key:"CheckTrailColor",value:function(e){var t=new Laya.Color(e.x,e.y,e.z);null==this.lastColor1||this.lastColor1.r===t.r&&this.lastColor1.g===t.g&&this.lastColor1.b===t.b?null==this.lastColor||this.lastColor.r===t.r&&this.lastColor.g===t.g&&this.lastColor.b===t.b?null==this.lastColor&&this._changeTrailColor(t):this._changeTrailColor2(t,this.lastColor):this._changeTrailColor3(t,this.lastColor1,this.lastColor)}},{key:"_changeTrailColor",value:function(e){Laya.Tween.clearAll(this.trialTimeChange),T.Instance.trailColorGradient.updateColorRGB(0,0,e),T.Instance.trailColorGradient.updateColorRGB(1,.01,e),T.Instance.trailColorGradient.updateColorRGB(2,.99,e),T.Instance.trailColorGradient.updateColorRGB(3,1,e),this.lastColor=e}},{key:"_changeTrailColor2",value:function(e,t){T.Instance.trailColorGradient.updateColorRGB(0,0,e),T.Instance.trailColorGradient.updateColorRGB(1,.01,e),this.lastColor=t,this.lastColor1=e,this.trialTimeChange.time=.01,Laya.Tween.clearAll(this.trialTimeChange);var i=Math.max(-3,T.Instance.trail.transform.localPositionZ-3e3*Y.Instance.Speed),n=(T.Instance.trail.transform.localPositionZ-i)/Y.Instance.Speed;Laya.Tween.to(this.trialTimeChange,{time:.99,update:new Laya.Handler(this,this.changeTrailTime,[e]),complete:Laya.Handler.create(this,this.changeTrailComplete,[e])},n)}},{key:"_changeTrailColor3",value:function(e,t,i){Laya.Tween.clearAll(this.trialTimeChange),this.lastColorTime1=this.trialTimeChange.time,T.Instance.trailColorGradient.updateColorRGB(0,0,e),T.Instance.trailColorGradient.updateColorRGB(1,.01,e),T.Instance.trailColorGradient.updateColorRGB(2,this.lastColorTime1,t),T.Instance.trailColorGradient.updateColorRGB(3,1,i),this.lastColor=t,this.lastColor1=e,this.trialTimeChange.time=.01;var n=Math.max(-3,T.Instance.trail.transform.localPositionZ-3e3*Y.Instance.Speed),a=(T.Instance.trail.transform.localPositionZ-n)/Y.Instance.Speed;Laya.Tween.to(this.trialTimeChange,{time:.99,update:new Laya.Handler(this,this.changeTrailTime1,[e,t]),complete:Laya.Handler.create(this,this.changeTrailComplete,[e])},a)}},{key:"changeTrailTime",value:function(e){T.Instance.trailColorGradient.updateColorRGB(1,this.trialTimeChange.time,e)}},{key:"changeTrailTime1",value:function(e,t){this.trialTimeChange.time+this.lastColorTime1<=.99&&T.Instance.trailColorGradient.updateColorRGB(2,this.trialTimeChange.time+this.lastColorTime1,t),T.Instance.trailColorGradient.updateColorRGB(1,this.trialTimeChange.time,e)}},{key:"changeTrailComplete",value:function(e){T.Instance.trailColorGradient.updateColorRGB(1,.01,e),T.Instance.trailColorGradient.updateColorRGB(2,.99,e),T.Instance.trailColorGradient.updateColorRGB(3,1,e),this.lastColor=e,this.lastColor1=null}}],[{key:"Instance",get:function(){if(null==PlayerMgr.instance&&T.Instance.mainScene){var e=new Laya.Sprite3D;T.Instance.mainScene.addChild(e),PlayerMgr.instance=e.addComponent(PlayerMgr)}return PlayerMgr.instance}}]),PlayerMgr}(),W=function(){function VibrateMgr(){_classCallCheck(this,VibrateMgr)}return _createClass(VibrateMgr,null,[{key:"vibrateShort",value:function(){$.callAPIMethodByProxy("vibrateShort")}},{key:"vibrateLong",value:function(){$.callAPIMethodByProxy("vibrateLong")}}]),VibrateMgr}(),F=function(e){function Board(){var e;return _classCallCheck(this,Board),(e=_possibleConstructorReturn(this,_getPrototypeOf(Board).apply(this,arguments))).boardSkinId=0,e}return _inherits(Board,G),_createClass(Board,[{key:"InitBoard",value:function(e,t){_get(_getPrototypeOf(Board.prototype),"Init",this).call(this,e),this.meshObj.meshRenderer.castShadow=!0,this.boardSkinId=t,this._changeSkin(t)}},{key:"ChangeSkinInBuff",value:function(){this.boardSkinId!=t.bodySkinIdInBuff&&this._changeSkin(t.bodySkinIdInBuff)}},{key:"RecoverSkin",value:function(){this.boardSkinId!=t.bodySkinIdInBuff&&this._changeSkin(this.boardSkinId)}},{key:"_changeSkin",value:function(e){var t=T.Instance.getSkinMaterialsByName("expression_"+e);t&&(this.meshObj.meshRenderer.material=t)}},{key:"OnBreakOut",value:function(){var e=this;if(!this.isDead){this.isDead=!0,this.obj.active=!1,W.vibrateShort(),this.CreateEffect("board_break"),this.birthZ!=R.Instance.lastPlayKickSoundPosZ&&(R.Instance.lastPlayKickSoundPosZ=this.birthZ,X.instance.playSound("kick_board_"+le.random(1,4)));var t=this.effectObj.getComponent(Laya.Animator).getDefaultState().clip.duration();Laya.timer.once(1e3*t,this,function(){H.Instance.PushEffect(e.effectObj),H.Instance.Push(e.obj)})}}},{key:"CreateEffect",value:function(e){this.effectObj=H.Instance.PopEffect(e);for(var t=0;t<this.effectObj.numChildren;t++){this.effectObj.getChildAt(t).meshRenderer.material=this.meshObj.meshRenderer.sharedMaterial}this.obj.parent.addChild(this.effectObj),this.effectObj.active=!0,this.effectObj.transform.localPosition=this.obj.transform.localPosition,this.effectObj.transform.localRotation=this.obj.transform.localRotation}},{key:"onDestroy",value:function(){Laya.timer.clearAll(this)}}]),Board}();!function(e){e[e.Player=0]="Player",e[e.Follow=1]="Follow",e[e.Npc=2]="Npc"}(V||(V={}));var U=function(e){function PlayerBase(){var e;return _classCallCheck(this,PlayerBase),(e=_possibleConstructorReturn(this,_getPrototypeOf(PlayerBase).apply(this,arguments))).bodyObj=null,e.bodyMaterial=null,e.anim=null,e.bodySkinId=13,e._index=0,e.posIndex=0,e.isDead=!1,e.moveInterVal=1,e.distanceFromTrail=0,e.isPlayingKick=!1,e.isFalling=!1,e.increaseEffect=null,e.increaseSubObj=null,e.deadEffect=null,e.mergeBuffEffect=null,e.breakHp=0,e._duration=0,e._startTimer=0,e._stattPosX=0,e._startPosY=0,e._startPosZ=0,e._targetPosY=0,e.fallStartPosY=0,e.mergeMoveInterval=1,e}return _inherits(PlayerBase,Laya.Script3D),_createClass(PlayerBase,[{key:"onAwake",value:function(){this.obj=this.owner,this.bodyObj=this.obj.getChildByName("body"),this.bodyObj.active=!0;var e=this.bodyObj.getChildByName("NN_player");this.bodyMaterial=e.skinnedMeshRenderer.material,this.anim=this.bodyObj.getComponent(Laya.Animator),this.anim.enabled=!0,this.increaseEffect=this.obj.getChildByName("increase"),this.increaseSubObj=this.increaseEffect.getChildAt(0),this.increaseEffect.active=!1,this.deadEffect=this.obj.getChildByName("rolefra"),this.deadEffect.transform.localPosition=new Laya.Vector3(0,.6,-.4),this.deadEffect.active=!1,this.mergeBuffEffect=this.obj.getChildByName("gather"),this.mergeBuffEffect&&(this.mergeBuffEffect.active=!1)}},{key:"AddEvent",value:function(){h.instance.onEvent(L,this,this.OnKick)}},{key:"RemoveEvent",value:function(){h.instance.onOffEvent(L,this,this.OnKick)}},{key:"Init",value:function(e,t,i,n,a){this._index=e,this.type=t,this.followObj=i,this.posIndex=a,this.bodySkinId=n,this.isDead=!1,this.isFalling=!1,this.moveInterVal=1,this.type==V.Player&&this.AddEvent(),this.rig=this.obj.getComponent(Laya.Rigidbody3D),null==this.rig&&(this.rig=this.obj.addComponent(Laya.Rigidbody3D),this.rig.isKinematic=!0,this.rig.mass=100,this.rig.overrideGravity=!1),this.rig.enabled=!0,this.obj.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.obj.transform.localScale=new Laya.Vector3(1,1,1),this.InitBodySkin(),this.StartMove()}},{key:"ResetItWhenRemoveTop",value:function(e,t,i,n,a){this._index=e,this.type=t,this.followObj=i,this.bodySkinId=n,this.moveInterVal=2,this.distanceFromTrail=a,this.type==V.Player&&this.AddEvent(),this.rig=this.obj.getComponent(Laya.Rigidbody3D),null==this.rig&&(this.rig=this.obj.addComponent(Laya.Rigidbody3D),this.rig.isKinematic=!0,this.rig.mass=100,this.rig.overrideGravity=!1),this.rig.enabled=!0,0==this.obj.active&&(this.obj.active=!0),this.InitBodySkin()}},{key:"InitBodySkin",value:function(e){null!=e?this._changeSkin(e,!0):this._changeSkin(this.bodySkinId,!0)}},{key:"GamePrepare",value:function(){this.anim.play("stand")}},{key:"GameStart",value:function(){this.anim.play("run")}},{key:"GameOver",value:function(){}},{key:"GameRevive",value:function(){this.anim.play("stand")}},{key:"OnFall",value:function(e){var i=this;this._index=e,this.breakHp=3,this._duration=1500,this._startTimer=Laya.timer.currTimer,this._stattPosX=this.obj.transform.localPositionX,this._startPosY=this.obj.transform.localPositionY,this._startPosZ=this.obj.transform.localPositionZ,this._index>0?Laya.timer.once(100,this,function(){i.anim.enabled=!0,i.anim.play("fall")}):(this.anim.enabled=!0,this.anim.play("fall"),Laya.timer.once(this._duration,this,function(){R.Instance.isCanStartFall=!0,Y.Instance.setSlowMotion(!0)})),Laya.timer.loop(t.deltaTime,this,this._updateFallMove1)}},{key:"_updateFallMove1",value:function(){var e=Laya.timer.currTimer-this._startTimer;if(!(e<0)){if(e>this._duration)return Laya.timer.clear(this,this._updateFallMove1),this.fallStartPosY=this.obj.transform.localPositionY,void this.startFallMove2();var t=e/this._duration;this.obj.transform.localPositionX=this._stattPosX+t*-this._stattPosX,this.obj.transform.localPositionY=this._startPosY+t*(1.4+.5*this._index),this.obj.transform.localPositionZ=this._startPosZ+t*(Y.Instance.endLen+10-this._startPosZ),this.obj.transform.localRotationEulerY=75*t}}},{key:"startFallMove2",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1?arguments[1]:void 0;this.isFalling=!0,this._startTimer=Laya.timer.currTimer,this._duration=i||6e3+1e3*this._index,this._startPosY=this.obj.transform.localPositionY,this._targetPosY=e,Laya.timer.loop(t.deltaTime,this,this._updateFallMove2)}},{key:"_updateFallMove2",value:function(){var e=Laya.timer.currTimer-this._startTimer;if(!(e<0))if(e>this._duration)Laya.timer.clear(this,this._updateFallMove2);else{var t=e/this._duration;this.obj.transform.localPositionY=this._startPosY+t*(this._targetPosY-this._startPosY)}}},{key:"FinishFallAni",value:function(){this.anim.enabled=!1,Laya.timer.clearAll(this)}},{key:"OnKick",value:function(){var e=this;if(this.type==V.Player&&!this.isPlayingKick&&!j.isInBuff){var t=le.random(1,3);this.anim.play("kick"+t),this.isPlayingKick=!0;var i=this.anim.getCurrentAnimatorPlayState().animatorState.clip.duration();Laya.timer.once(1e3*i,this,function(){e.isPlayingKick=!1,Y.Instance.gameStatus==z.Execute&&e.anim.play("run")})}}},{key:"UpdatePosIndex",value:function(e){this.posIndex-=e}},{key:"StartMove",value:function(){Y.Instance.gameStatus==z.Execute&&this._setPosMove()}},{key:"TriggerBuff",value:function(){this._changeSkinInBuff(),null==this.mergeBuffEffect&&(this.mergeBuffEffect=H.Instance.PopEffect("gather"),this.obj.addChild(this.mergeBuffEffect),this.mergeBuffEffect.transform.localPosition=new Laya.Vector3(0,.55,0)),this.mergeBuffEffect.active=!0,Laya.Tween.to(this.obj.transform,{localScaleX:1.6,localScaleY:1.6,localScaleZ:1.6},1e3)}},{key:"CloseBuff",value:function(){this.mergeBuffEffect.active=!1,this.obj.transform.localScale=new Laya.Vector3(1,1,1),this._changeSkin(this.bodySkinId,!0),Y.Instance.gameStatus==z.Execute?Laya.Tween.to(this.obj.transform,{localScaleX:1,localScaleY:1,localScaleZ:1},300,Laya.Ease.quadOut):(Laya.Tween.clearTween(this.obj.transform),this.obj.transform.localScale=new Laya.Vector3(1,1,1))}},{key:"MergePosWhenBuffOn",value:function(){var e=R.Instance.movePoints.length;this.mergeMoveInterval=Math.max(1,Math.floor((e-1-this.posIndex)/(t.buffSlowMotionTime/t.deltaTime))),Laya.timer.loop(t.deltaTime,this,this._setPosMoveWhenBuffOn)}},{key:"ExtendPosWhenBuffOff",value:function(e,t){this.posIndex=e,this._setPosMove(),this.obj.active=!0,-1!=t&&this._changeSkin(t,!0),this.anim.play("run")}},{key:"_setPosMove",value:function(){if(!(this.posIndex>=R.Instance.movePoints.length||this.posIndex<0)){this.moveInterVal>1&&Math.abs(R.Instance.movePoints.length-1-this.posIndex-this.distanceFromTrail)<=3&&(this.moveInterVal=1,this.posIndex=R.Instance.movePoints.length-1-this.distanceFromTrail);var e=this.obj.transform.localPosition,i=R.Instance.movePoints[this.posIndex],n=i.z,a=i.x;if(this.type==V.Follow)for(var s=R.Instance.movePoints.length,o=R.Instance.movePoints[s-1].z,r=o-(n=o-t.deltaTime*this._index*R.Instance.pointInterval*Y.Instance.Speed),l=s-1;l>=0&&!(R.Instance.movePoints[l].z-e.z<=0);l--)R.Instance.movePoints[l].z-n<r&&(r=R.Instance.movePoints[l].z-n,a=R.Instance.movePoints[l].x);this.obj.transform.localPosition=new Laya.Vector3(a,e.y,n),this.posIndex+=this.moveInterVal}}},{key:"_setPosMoveWhenBuffOn",value:function(){if(this.posIndex>=R.Instance.movePoints.length||this.posIndex<0)return Laya.timer.clear(this,this._setPosMoveWhenBuffOn),void(this.obj.active=!1);var e=R.Instance.movePoints[this.posIndex],t=this.obj.transform.localPosition;this.obj.transform.localPosition=new Laya.Vector3(e.x,t.y,e.z),this.posIndex+=this.mergeMoveInterval}},{key:"Dead",value:function(){this.isDead=!0,this.bodyObj.active=!1,this.clearSomething(),Laya.timer.clear(this,this._hideDeadEffect),this.deadEffect.active=!1,this.deadEffect.active=!0,Laya.timer.once(1e3,this,this._hideDeadEffect)}},{key:"_hideDeadEffect",value:function(){this.deadEffect.active=!1,this.obj.transform.localPosition=new Laya.Vector3(0,0,-3),this.obj.transform.localScale=new Laya.Vector3(1,1,1),this.obj.transform.localRotationEuler=new Laya.Vector3(0,0,0),H.Instance.PushPlayer(this.obj)}},{key:"_changeSkin",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||e!=this.bodySkinId){this.bodySkinId=e;var t=T.Instance.getSkinColorByName(e.toString());this.bodyMaterial.albedoColor=t,this.type==V.Player&&R.Instance.CheckTrailColor(t)}}},{key:"_changeSkinInBuff",value:function(){var e=T.Instance.getSkinColorByName(t.bodySkinIdInBuff.toString());this.bodySkinId!=t.bodySkinIdInBuff&&(this.bodyMaterial.albedoColor=e),R.Instance.CheckTrailColor(e)}},{key:"_addPlayerEffect",value:function(){this.increaseEffect.active&&Laya.timer.clear(this,this._hideAddPlayerEffect),X.instance.playSound("increase");var e=this.increaseSubObj.transform.localScale;j.isInBuff?e.x<2&&(this.increaseSubObj.transform.localScale=new Laya.Vector3(2,2,2)):e.x>1&&(this.increaseSubObj.transform.localScale=new Laya.Vector3(1,1,1)),this.increaseEffect.active=!1,this.increaseEffect.active=!0,Laya.timer.once(1e3,this,this._hideAddPlayerEffect)}},{key:"_hideAddPlayerEffect",value:function(){this.increaseEffect.active=!1}},{key:"onTriggerEnter",value:function(e){if(Y.Instance.gameStatus==z.Execute&&!this.isDead){var t=e.owner;if(t.layer==E.change){var i=12+Number(t.name.substr(t.name.length-1,1));!j.isInBuff||Y.Instance.isRecoveredElement?(this.type==V.Player&&X.instance.playSound("change"),this._changeSkin(i)):this.bodySkinId=i}else if(this.type==V.Player&&1===this.moveInterVal)if(t.layer==E.playerIdle)R.Instance.AddFollowPlayer(),H.Instance.Push(t),this._addPlayerEffect();else if(t.layer==E.board){var n=t.getComponent(F);n&&!n.isDead&&(n.OnBreakOut(),0==j.isInBuff&&(this.bodySkinId!=n.boardSkinId?(j.lossEnergy(),R.Instance.RemovePlayerOfExcute()):j.AddEnergy()))}}}},{key:"clearSomething",value:function(){Laya.Tween.clearAll(this.obj.transform),Laya.timer.clearAll(this)}},{key:"onDestroy",value:function(){this.RemoveEvent()}}]),PlayerBase}(),H=function(){function PoolMgr(){_classCallCheck(this,PoolMgr),this.poolMap={}}return _createClass(PoolMgr,[{key:"Push",value:function(e){if(null!=e){e.active=!1;var t=e.getComponent(G);t&&t.destroy(),e.removeSelf();var i=e.name;this.poolMap[i]||(this.poolMap[i]=[]),this.poolMap[i].push(e)}}},{key:"PushPlayer",value:function(e){if(null!=e){e.active=!1;var t=e.getComponent(U);t&&t.destroy(),e.removeSelf();var i=e.name;this.poolMap[i]||(this.poolMap[i]=[]),this.poolMap[i].push(e)}}},{key:"PushEffect",value:function(e){if(null!=e){e.active=!1,e.removeSelf();var t=e.name;this.poolMap[t]||(this.poolMap[t]=[]),this.poolMap[t].push(e)}}},{key:"Pop",value:function(e){return this.poolMap[e]&&this.poolMap[e].length>0?this.poolMap[e].pop():this.CreateModelObj(e)}},{key:"PopPlayer",value:function(){var e="player";return this.poolMap[e]&&this.poolMap[e].length>0?this.poolMap[e].pop():Laya.Sprite3D.instantiate(T.Instance.player)}},{key:"PopEffect",value:function(e){return this.poolMap[e]&&this.poolMap[e].length>0?this.poolMap[e].pop():this.CreateEffectObj(e)}},{key:"CreateModelObj",value:function(e){var t=T.Instance.models.getChildByName(e);if(t)return Laya.Sprite3D.instantiate(t)}},{key:"CreateEffectObj",value:function(e){var t=T.Instance.effects.getChildByName(e);if(t)return Laya.Sprite3D.instantiate(t)}}]),PoolMgr}();H.Instance=new H;var z,Y=function(e){function GameMgr(){var e;return _classCallCheck(this,GameMgr),(e=_possibleConstructorReturn(this,_getPrototypeOf(GameMgr).apply(this,arguments))).gameResult=!1,e.gameResultPlayer=0,e.endLen=50,e.levelData=null,e.elementInitLen=40,e.elementPosAdd=5,e.isCreateEndPos=!1,e.boardNextIndex=0,e.floorBarNextIndex=0,e.npcNextIndex=0,e.isSlowMotion=!1,e.isBuffProcessing=!1,e.isRecoveredElement=!1,e.bgmPreLoadMap={},e.preparePlayBgm=!1,e.startTime=0,e.victoryEffect=null,e.cameraPos=new Laya.Vector3(-.52,5.74,-10.85),e.boardRecoverSkinDis=5,e.emotionRotateTween=null,e.curLevel=1,e.timeScale=1,e}return _inherits(GameMgr,Laya.Script3D),_createClass(GameMgr,[{key:"InitUpdate",value:function(){Laya.timer.loop(t.deltaTime,this,this.UpdateFunc)}},{key:"UpdateFunc",value:function(){oe.hideCurrTimer>0&&(oe.hideTotalTime<=0&&(oe.hideTotalTime=Laya.timer.currTimer-oe.hideCurrTimer),oe.hideCurrTimer=0,oe.isHide=!1,oe.hideTotalTime>0&&(console.log("排除掉后台停留时间==>",oe.hideTotalTime,Laya.timer.delta),this.gameStatus==z.Execute&&this.UpdateValuesWhenOnShow(),oe.hideTotalTime=0,oe.isBackFromBackground||(oe.isBackFromBackground=!0,X.instance.resumeBGM()))),oe.isHide||oe.playingVideo||this.gameStatus==z.Execute&&(this.GameExecute(),this.MoveCamera())}},{key:"GameExecute",value:function(){j.Update(),!this.isBuffProcessing&&j.isInBuff?this.GameTrigBuff():this.isBuffProcessing&&!j.isInBuff&&this.GameCloseBuff(),R.Instance.GameExecute(),this.moveDis>=this.endLen?this.GamePassToEmotion():(j.isInBuff&&!this.isRecoveredElement&&j.moveEndPosBuff-this.moveDis<=this.boardRecoverSkinDis&&this.RecoverElementcToCoseBuff(),this.CreateElements())}},{key:"MoveCamera",value:function(){T.Instance.mainCamera.transform.localPosition=new Laya.Vector3(this.cameraPos.x+this.moveDisX,this.cameraPos.y,this.cameraPos.z+this.moveDis)}},{key:"Init",value:function(){this.InitUpdate(),this.levelData=new i,this.gameStatus=z.None,this.cmdObj=new Laya.Sprite3D,T.Instance.mainScene.addChild(this.cmdObj),this.GamePrepare()}},{key:"GamePrepare",value:function(){this.gameStatus=z.Wait,this.moveDis=0,this.moveDisX=0,T.Instance.mainCamera.transform.localPosition=this.cameraPos,T.Instance.trail.trailFilter.time=0,T.Instance.trail.transform.localPosition=new Laya.Vector3(0,.15,-3),this.cmdObj.transform.localPosition=new Laya.Vector3(0,0,0),j.Init(),this.InitSceneData(),R.Instance.GamePrepare()}},{key:"InitSceneData",value:function(){this.elementNextPos=0,this.boardNextIndex=0,this.floorBarNextIndex=0,this.npcNextIndex=0,this.isCreateEndPos=!1,T.Instance.ChangeScene()}},{key:"GameStart",value:function(){var e=this;this.gameStatus=z.Execute,T.Instance.trail.trailFilter.time=3,this.gameResult=!1,W.vibrateLong(),R.Instance.GameStart(),M.instance.startGameStatistics(),this.preparePlayBgm=!0,this.startTime=Laya.timer.currTimer;var t=3/this.Speed;Laya.timer.once(t,this,function(){X.instance.playLevelBGM(e.LevelBgm(),0)})}},{key:"Dead",value:function(){var e=this;GameMgr.Instance.gameStatus=z.Over,X.instance.pauseLevelBGM(),this.GameFail(),T.Instance.cameraShake.Shake(500,1),j.isInBuff&&this.GameCloseBuff(),Laya.timer.once(1e3,this,function(){h.instance.emit(w,[!0]),e.GameOver()})}},{key:"GameOver",value:function(){GameMgr.Instance.gameStatus=z.Over,this.gameResult=!1}},{key:"GamePass",value:function(){this.gameStatus=z.Pass,this.gameResult=!0,this.GameWin(),W.vibrateLong(),Laya.timer.once(1e3,this,function(){X.instance.playBGM(),h.instance.emit(w,[!1])})}},{key:"GamePassToEmotion",value:function(){var e=this;this.gameStatus=z.PassEmotion,this.gameResultPlayer=R.Instance.playerList.length,this.CreateEmotions(10,10+3*this.gameResultPlayer);var t=100;j.isInBuff?(t=200,this.GameCloseBuff()):R.Instance.UnionBodySkin(),R.Instance.ForwardToEmotion(),Laya.Tween.to(T.Instance.mainCamera.transform,{localPositionX:this.cameraPos.x-.2,localPositionZ:-2.05+this.moveDis},1050,null,Laya.Handler.create(this,function(){e.emotionRotateTween=Laya.Tween.to(e.emotionObj.transform,{localRotationEulerY:75},8e4)}),t)}},{key:"CompleteEmotionRotateAni",value:function(){this.emotionRotateTween&&this.emotionObj.transform.localPositionY<75&&(this.emotionRotateTween.clear(),Laya.Tween.to(this.emotionObj.transform,{localRotationEulerY:75},200))}},{key:"GameWin",value:function(){var e=this;X.instance.playSound("victory"),null==this.victoryEffect&&(this.victoryEffect=H.Instance.PopEffect("victory"),T.Instance.mainScene.addChild(this.victoryEffect)),this.victoryEffect.active=!0,this.victoryEffect.transform.localPosition=new Laya.Vector3(0,0,this.moveDis-12),Laya.timer.once(2e3,this,function(){e.victoryEffect.active=!1})}},{key:"GameFail",value:function(){X.instance.playSound("fail")}},{key:"GameExit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.gameStatus=z.None,this.DestroyAllElement(),this.GamePrepare(),e&&this.InitLevelData()}},{key:"GameRestart",value:function(){this.GameExit(!0)}},{key:"InitLevelData",value:function(){(this.curLevel=o.level,this.curLevel>o.levelData.maxLevel&&(this.curLevel=this.curLevel%o.levelData.maxLevel,0==this.curLevel&&(this.curLevel=o.levelData.maxLevel)),console.log("=====关卡等级==",o.level,o.levelData.maxLevel,this.curLevel),this.levelData.InitData(this.curLevel))&&(this.endLen=this.levelData.totalLen,T.Instance.road.transform.localScaleZ=this.endLen/10+1,!1===this.PreLoadLevelBgmComplete()&&this.ToLoadLevelBgm(),this.CreateElements());console.log(this.levelData)}},{key:"PreLoadLevelBgmComplete",value:function(){this.bgmPreLoadMap[this.levelData.bgm]||null!=Laya.loader.getRes(this.levelData.bgmAdress)&&(this.bgmPreLoadMap[this.levelData.bgm]=!0);return!!this.bgmPreLoadMap[this.levelData.bgm]&&(X.instance.prepareLevelBGM(this.levelData.bgmAdress),!0)}},{key:"ToLoadLevelBgm",value:function(){var e=this;Laya.loader.load(this.levelData.bgmAdress,Laya.Handler.create(this,function(t){null!=t?(e.bgmPreLoadMap[e.levelData.bgm]=!0,X.instance.prepareLevelBGM(e.levelData.bgmAdress),console.log("音乐加载完成")):X.instance.prepareLevelBGM("res/sound/0.mp3")}),null,Laya.Loader.SOUND)}},{key:"LevelBgm",value:function(){return this.bgmPreLoadMap[this.levelData.bgm]?this.levelData.bgmAdress:"res/sound/0.mp3"}},{key:"BgmIsLoaded",value:function(){return!0===this.bgmPreLoadMap[this.levelData.bgm]}},{key:"SetBgmLoaded",value:function(){return this.bgmPreLoadMap[this.levelData.bgm]=!0}},{key:"CreateElements",value:function(){for(;this.elementNextPos<=this.moveDis&&!this.isCreateEndPos;){for(var e=this.boardNextIndex;e<this.levelData.boardArray.length;e++){var t=this.levelData.boardArray[e];if(!(t.pos.z<this.elementInitLen+this.elementNextPos)){this.boardNextIndex=e;break}var i=H.Instance.Pop(t.prefabName);if(null!=i){this.cmdObj.addChild(i),i.active=!0;var n=i.addComponent(F);n.InitBoard(t.pos,t.skinId),j.isInBuff&&t.pos.z<=j.moveEndPosBuff&&n.ChangeSkinInBuff()}this.boardNextIndex++}for(var a=this.floorBarNextIndex;a<this.levelData.floorBarArray.length;a++){var s=this.levelData.floorBarArray[a];if(!(s.pos.z<this.elementInitLen+this.elementNextPos)){this.floorBarNextIndex=a;break}var o=H.Instance.Pop(s.prefabName);null!=o&&(this.cmdObj.addChild(o),o.active=!0,o.addComponent(G).Init(s.pos),o.meshRenderer.enable=!j.isInBuff||s.pos.z>j.moveEndPosBuff),this.floorBarNextIndex++}for(var r=this.npcNextIndex;r<this.levelData.npcArray.length;r++){var l=this.levelData.npcArray[r];if(!(l.pos.z<this.elementInitLen+this.elementNextPos)){this.npcNextIndex=r;break}var h=H.Instance.Pop(l.prefabName);null!=h&&(this.cmdObj.addChild(h),h.active=!0,h.addComponent(G).Init(l.pos)),this.npcNextIndex++}if(this.endLen<this.elementInitLen+this.elementNextPos){var c=H.Instance.Pop("end_1");this.cmdObj.addChild(c),c.active=!0,c.transform.localPosition=new Laya.Vector3(0,0,this.endLen-.8),c.transform.localScale=new Laya.Vector3(1,1,1),this.isCreateEndPos=!0,null==this.emotionObj&&(this.emotionObj=new Laya.Sprite3D,T.Instance.mainScene.addChild(this.emotionObj)),Laya.Tween.clearAll(this.emotionObj.transform),this.emotionObj.transform.localPosition=new Laya.Vector3(0,-1,this.endLen+10),this.emotionObj.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.CreateEmotions(0,10)}this.elementNextPos+=this.elementPosAdd}}},{key:"CreateEmotions",value:function(e,t){for(var i=0,n=e;n<t;){var a=le.random(1,10),s=H.Instance.Pop("expression_"+a);if(s)this.emotionObj.addChild(s),s.active=!0,s.addComponent(N).Init(new Laya.Vector3(0,2*-n,0)),n++;if(++i>=t-e+10)break}}},{key:"GameRevive",value:function(){this.reviveCount+=1;for(var e=this.cmdObj.numChildren-1;e>=0;e--){var t=this.cmdObj.getChildAt(e);null!=t&&(t.transform.localPositionZ<=this.moveDis&&H.Instance.Push(t))}this.moveDisX=0,T.Instance.mainCamera.transform.localPosition=new Laya.Vector3(this.cameraPos.x,this.cameraPos.y,this.cameraPos.z+this.moveDis),T.Instance.trail.trailFilter.time=0,T.Instance.trail.transform.localPosition=new Laya.Vector3(0,.15,-3+this.moveDis),R.Instance.GameRevive(),X.instance.playSound("relieve")}},{key:"GameReviveStart",value:function(){this.gameStatus=z.Execute,T.Instance.trail.trailFilter.time=3,R.Instance.GameStart(),j.SetApproachBuff(),this.startTime=Math.floor(Laya.timer.currTimer-this.moveDis/this.Speed);var e=((Laya.timer.currTimer-this.startTime)*this.Speed-3)/this.SpeedSecond;console.log("==复活节点===>",e,this.startTime),X.instance.playLevelBGM(this.LevelBgm(),e)}},{key:"GameTrigBuff",value:function(){if(!this.isBuffProcessing){this.isBuffProcessing=!0,this.isRecoveredElement=!1;for(var e=this.cmdObj.numChildren,t=0;t<e;t++){var i=this.cmdObj.getChildAt(t);if(null!=i&&!(i.transform.localPositionZ>j.moveEndPosBuff))if(i.layer==E.board){var n=i.getComponent(F);n&&n.ChangeSkinInBuff()}else i.layer==E.change&&(i.meshRenderer.enable=!1)}R.Instance.TriggBuffEffect(),X.instance.playSound("gather")}}},{key:"GameCloseBuff",value:function(){this.isBuffProcessing&&(this.isBuffProcessing=!1,this.gameStatus==z.Execute||this.isRecoveredElement||this.RecoverElementcToCoseBuff())}},{key:"RecoverElementcToCoseBuff",value:function(){this.isRecoveredElement=!0;for(var e=this.cmdObj.numChildren-1;e>=0;e--){var t=this.cmdObj.getChildAt(e);if(null!=t&&t.layer==E.board)if(t.transform.localPositionZ<=j.moveEndPosBuff)H.Instance.Push(t);else{var i=t.getComponent(F);i&&i.RecoverSkin()}}R.Instance.CloseBuffEffect(),X.instance.playSound("relieve")}},{key:"DestroyAllElement",value:function(){for(var e=this.cmdObj.numChildren-1;e>=0;e--){var t=this.cmdObj.getChildAt(e);null!=t&&H.Instance.Push(t)}if(this.cmdObj.numChildren>0&&this.cmdObj.removeChildren(),null!=this.emotionObj){for(var i=this.emotionObj.numChildren-1;i>=0;i--){var n=this.emotionObj.getChildAt(i);null!=n&&H.Instance.Push(n)}this.emotionObj.numChildren>0&&this.emotionObj.removeChildren()}}},{key:"UpdateValuesWhenOnShow",value:function(){this.startTime>0&&(this.startTime+=oe.hideTotalTime),j.buffStartTime>0&&(j.buffStartTime+=oe.hideTotalTime)}},{key:"GameScore",value:function(){return Math.floor(this.moveDis)}},{key:"setSlowMotion",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;this.isSlowMotion==e&&Laya.timer.scale===t||(this.isSlowMotion=e,Laya.timer.scale=e?t:1)}},{key:"_setSlowMotionInBuff",value:function(){var e=this;this.setSlowMotion(!0,.1),Laya.timer.once(t.buffSlowMotionTime,this,function(){e.setSlowMotion(!1)})}},{key:"Speed",get:function(){return this.levelData.speed}},{key:"SpeedSecond",get:function(){return this.levelData.speedSecond}}],[{key:"Instance",get:function(){if(null==GameMgr.instance&&T.Instance.mainScene){var e=new Laya.Sprite3D;T.Instance.mainScene.addChild(e),GameMgr.instance=e.addComponent(GameMgr)}return GameMgr.instance}}]),GameMgr}();!function(e){e[e.None=0]="None",e[e.Wait=1]="Wait",e[e.Execute=2]="Execute",e[e.Pause=3]="Pause",e[e.Pass=4]="Pass",e[e.Over=5]="Over",e[e.PassEmotion=6]="PassEmotion"}(z||(z={}));var X=function(){function SoundMgr(){_classCallCheck(this,SoundMgr),this.bgmIndex=-1,this.bgmName="",this.bgmDevelop=null,this.bgmLvCurrTime=0,this.bgmLevelIsPaused=!1,this.bgmIsStoped=!1}return _createClass(SoundMgr,[{key:"playSound",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(oe.isSound){var i="res/sound/"+e+".mp3";if(Laya.Browser.onMiniGame){var n=Laya.Pool.getItem(e);null==n&&((n=window.wx.createInnerAudioContext()).src="res/sound/"+e+".mp3",n.onEnded(function(){Laya.Pool.recover(e,n),n.offEnded()})),n.playbackRate=t,n.play()}else Laya.SoundManager.playSound(i,1)}}},{key:"playBGM",value:function(){var e=this;if(oe.isSound){this.stopLevelBGM(),this.bgmIsStoped=!1;var t="res/sound/bgm.mp3";Laya.Browser.onMiniGame?(this.bgm||(this.bgm=window.wx.createInnerAudioContext(),this.bgm.src=t,this.bgm.loop=!0,this.bgm.onError(function(e){console.log("音乐错误：",e)}),this.bgm.onPause(function(){!oe.isHide&&!e.bgmIsStoped&&e.bgm.currentTime>=0&&(oe.isHide=!0,oe.isBackFromBackground=!1,oe.hideCurrTimer=Laya.timer.currTimer,console.log("界面音乐进入未知后台行为====",e.bgm.currentTime))})),this.bgm.play()):Laya.SoundManager.playMusic(t,0),this.bgmIndex=1}}},{key:"prepareLevelBGM",value:function(e){var t=this,i=e;Laya.Browser.onMiniGame&&(this.bgmLevel||(this.bgmLevel=window.wx.createInnerAudioContext(),this.bgmLevel.loop=!1,this.bgmLevel.onPlay(function(){t.bgmLvCurrTime=t.bgmLevel.currentTime,console.log("实际播放時間===",t.bgmLevel.currentTime)}),this.bgmLevel.onTimeUpdate(function(){t.bgmLvCurrTime=t.bgmLevel.currentTime}),this.bgmLevel.onPause(function(){console.log("暂停时间点===",t.bgmLevel.currentTime),!oe.isHide&&t.bgmLvCurrTime>0&&t.bgmLevel.currentTime>=0&&(oe.isHide=!0,oe.isBackFromBackground=!1,oe.hideCurrTimer=Laya.timer.currTimer,t.bgmLvCurrTime=t.bgmLevel.currentTime,console.log("进入未知后台行为====",t.bgmLvCurrTime,Y.Instance.startTime,oe.hideCurrTimer))}),this.bgmLevel.onEnded(function(){t.bgmLvCurrTime=0,console.log("音乐播放结束")}),this.bgmLevel.onStop(function(){t.bgmLvCurrTime=0,console.log("音乐停止==",t.bgmLevel.currentTime)})),this.bgmLevel.src=i)}},{key:"playLevelBGM",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.stopHomeBGM();var i=e;this.bgmName=e,this.bgmLevelIsPaused=!1,Laya.Browser.onMiniGame?(this.bgmLevel||this.prepareLevelBGM(e),this.bgmLevel.startTime=t,this.bgmLevel.volume=oe.isSound?1:.01,this.bgmLevel.play()):(this.bgmDevelop=null!=t||null!=t?Laya.SoundManager.playMusic(i,1,null,t):Laya.SoundManager.playMusic(i,1),this.bgmDevelop.volume=oe.isSound?1:.01),this.bgmIndex=2}},{key:"pauseLevelBGM",value:function(){if(Laya.Browser.onMiniGame){if(2==this.bgmIndex&&this.bgmLvCurrTime>0){var e=this.bgmLvCurrTime;this.bgmLevel.stop(),this.bgmLevel.seek(e),this.bgmLevelIsPaused=!0}}else this.bgmDevelop&&(this.bgmLvCurrTime=this.bgmDevelop.position,this.bgmDevelop.pause(),this.bgmLevelIsPaused=!0)}},{key:"stopHomeBGM",value:function(){Laya.Browser.onMiniGame?this.bgm&&(this.bgmIsStoped=!0,this.bgm.stop()):Laya.SoundManager.stopMusic()}},{key:"stopLevelBGM",value:function(){Laya.Browser.onMiniGame?this.bgmLevel&&(this.bgmLevel.stop(),this.bgmLevel.seek(0),this.bgmLvCurrTime=0):Laya.SoundManager.stopMusic()}},{key:"stopBGM",value:function(){Laya.Browser.onMiniGame?(this.bgm&&(this.bgmIsStoped=!0,this.bgm.stop()),this.bgmLevel&&(this.bgmLevel.stop(),this.bgmLevel.seek(0)),this.bgmIndex=-1,this.bgmLvCurrTime=0):Laya.SoundManager.stopMusic()}},{key:"pauseBGM",value:function(){Laya.Browser.onMiniGame?2==this.bgmIndex&&this.bgmLvCurrTime>0&&!this.bgmLevelIsPaused?this.stopLevelBGM():1==this.bgmIndex&&this.stopHomeBGM():this.stopBGM()}},{key:"resumeBGM",value:function(){Laya.Browser.onMiniGame?2==this.bgmIndex&&this.bgmLvCurrTime>0&&!this.bgmLevelIsPaused?(this.playLevelBGM(this.bgmName,this.bgmLvCurrTime),console.log("恢复关卡音乐==>"+this.bgmLvCurrTime)):1==this.bgmIndex&&(this.playBGM(),console.log("恢复界面音乐")):this.playBGM()}},{key:"getBgmLevelPauseTime",value:function(){return this.bgmLvCurrTime}},{key:"getBgmLevelCurrTime",value:function(){return Laya.Browser.onMiniGame?this.bgmLvCurrTime:this.bgmDevelop?this.bgmDevelop.position:0}},{key:"printBgmCurTime",value:function(){Laya.Browser.onMiniGame?2==this.bgmIndex?console.log("音乐位置：",this.bgmLvCurrTime):this.playBGM():this.bgmDevelop&&console.log("音乐位置：",this.bgmDevelop.position)}}]),SoundMgr}();X.instance=new X;var q=function(){function ViewMgr(){_classCallCheck(this,ViewMgr),this.viewDic={},this.events=["goHome","openTip","openResurgence","openFighting","openGoldenEggView","openGameOver","openGameBox","openConvergeAdNew","openFriendInvite","openConvergeAdForMainView"]}return _createClass(ViewMgr,[{key:"init",value:function(){for(var e=0;e<this.events.length;e++)h.instance.onEvent(this.events[e],this,this[this.events[e]])}},{key:"goHome",value:function(e){this.openView({viewName:"MainHomeView.scene",closeAll:!0})}},{key:"openFighting",value:function(e){this.openView({viewName:"GameFighting.scene",closeAll:!0,data:e})}},{key:"openResurgence",value:function(e){this.openView({viewName:"Resurgence.scene",closeAll:!0,data:e})}},{key:"openGameOver",value:function(e){this.openView({viewName:"GameOver.scene",closeAll:!0,data:e})}},{key:"openGoldenEggView",value:function(e){this.openView({viewName:"GoldenEggView.scene",closeAll:!1,data:e})}},{key:"openConvergeAdNew",value:function(e){ViewMgr.instance.openView({viewName:"ConvergeAdNew.scene",closeAll:!1,data:e})}},{key:"openTip",value:function(e){if(Laya.Browser.onMiniGame){var t={};t.title=e,t.icon="none",window.wx.showToast(t)}else this.openView({viewName:"Tip.scene",closeAll:!1,data:e})}},{key:"openGameBox",value:function(e){this.openView({viewName:"GameBox.scene",closeAll:!1,data:e})}},{key:"openFriendInvite",value:function(e){this.openView({viewName:"FriendInvite.scene",closeAll:!1,data:e})}},{key:"openConvergeAdForMainView",value:function(e){ViewMgr.instance.openView({viewName:"ConvergeAdForMainView.scene",closeAll:!1,data:e})}},{key:"openView",value:function(e){var t=this,i=e.viewName,n=(e.cls,e.closeAll||!1);n&&(this.viewDic={}),le.isNull(this.viewDic[i])&&(this.viewDic[i]=i,Laya.Scene.open(i,n,Laya.Handler.create(this,function(n){t.viewDic[i]=n;var a=n._components;if(a)for(var s=0;s<a.length;s++){var o=a[s];if(o.isMyBaseView){o.openView(e.data);break}}})))}},{key:"closeView",value:function(e){le.isNull(this.viewDic[e])||(this.viewDic[e].destroy(),this.viewDic[e]=null)}},{key:"hideView",value:function(e){le.isNull(this.viewDic[e])||(this.viewDic[e].visible=!1)}},{key:"getView",value:function(e){var t=this.viewDic[e];return le.isNull(t)?null:t}}]),ViewMgr}();q.instance=new q;var K=function(){function WxAdManager(){_classCallCheck(this,WxAdManager),this.isInited=!1,this.isInterstitial=!1,this.interstitialList=[],this.videoPlayedTimes=0,this.bannerAd_zhujiemianTime=-1,this.bannerAd_zhujiemianlingqujinbiTime=-1,this.bannerAd_shiyongpifuTime=-1,this.bannerAd_fuhuoTime=-1,this.bannerAd_jiesuanjinbiTime=-1,this.bannerAd_jiesuanjiemianTime=-1,this.bannerAd_goldenEggTime=-1,this.totalBannerTimes=0}return _createClass(WxAdManager,[{key:"compareVersion",value:function(e,t){e=e.split("."),t=t.split(".");for(var i=Math.max(e.length,t.length);e.length<i;)e.push("0");for(;t.length<i;)t.push("0");for(var n=0;n<i;n++){var a=parseInt(e[n]),s=parseInt(t[n]);if(a>s)return 1;if(a<s)return-1}return 0}},{key:"init",value:function(){Laya.Browser.onMiniGame&&!this.isInited&&(oe.systemInfo.SDKVersion&&this.compareVersion(oe.systemInfo.SDKVersion,"2.0.4")>=0&&(this.isInited=!0,this.showBannerAd_fuhuo(!0),this.showBannerAd_jiesuanjiemian(!0),this.showBannerAd_jiesuanjinbi(!0),this.showBannerAd_shiyongpifu(!0),this.showBannerAd_zhujiemian(!0),this.showBannerAd_zhujiemianlingqujinbi(!0),this.showBannerAd_goldenEgg(!0)),oe.systemInfo.SDKVersion&&this.compareVersion(oe.systemInfo.SDKVersion,"2.6.0"))}},{key:"getAdInfo",value:function(e){for(var t=null,i=0;i<oe.allAdsControl.length;i++)if(oe.allAdsControl[i].ad_position_id==e){t=oe.allAdsControl[i];break}return t}},{key:"isAdRefresh",value:function(){return this.totalBannerTimes<oe.ctrlInfo.adRefreshTimes}},{key:"showBannerAd_zhujiemian",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(101);if(null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=Laya.stage.width/2-140,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_zhujiemianTime>0&&Laya.timer.currTimer-this.bannerAd_zhujiemianTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_zhujiemian());var o=t.ad_id.split(",");return this.bannerAd_zhujiemian||(this.totalBannerTimes++,this.bannerAd_zhujiemianTime=Laya.timer.currTimer,this.bannerAd_zhujiemian=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_zhujiemian.onResize(function(e){var t=WxAdManager.Instance.bannerAd_zhujiemian;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(console.log("宽高比:"+a/i),t.style.top=t.style.top-10,console.log("长屏幕手机:",t.style.top)))}),this.bannerAd_zhujiemian.onError(function(e){h.instance.emit(d),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_zhujiemian()}),this.bannerAd_zhujiemian.onLoad(function(){})),e?(s&&(this.bannerAd_zhujiemianTime=-1),null!=this.bannerAd_zhujiemian&&this.bannerAd_zhujiemian.hide(),!0):(this.bannerAd_zhujiemian&&this.bannerAd_zhujiemian.show(),!0)}},{key:"hideBannerAd_zhujiemian",value:function(){this.bannerAd_zhujiemian&&this.bannerAd_zhujiemian.hide()}},{key:"destroyBannerAd_zhujiemian",value:function(){this.bannerAd_zhujiemian&&(this.bannerAd_zhujiemian.destroy(),this.bannerAd_zhujiemian=null)}},{key:"showBannerAd_zhujiemianlingqujinbi",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(107);if(null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_zhujiemianlingqujinbiTime>0&&Laya.timer.currTimer-this.bannerAd_zhujiemianlingqujinbiTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_zhujiemianlingqujinbi());var o=t.ad_id.split(",");return this.bannerAd_zhujiemianlingqujinbi||(this.totalBannerTimes++,this.bannerAd_zhujiemianlingqujinbiTime=Laya.timer.currTimer,this.bannerAd_zhujiemianlingqujinbi=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_zhujiemianlingqujinbi.onResize(function(e){var t=WxAdManager.Instance.bannerAd_zhujiemianlingqujinbi;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(t.style.top=t.style.top-25))}),this.bannerAd_zhujiemianlingqujinbi.onError(function(e){h.instance.emit(v),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_zhujiemianlingqujinbi()}),this.bannerAd_zhujiemianlingqujinbi.onLoad(function(){})),e?(s&&(this.bannerAd_zhujiemianlingqujinbiTime=-1),null!=this.bannerAd_zhujiemianlingqujinbi&&this.bannerAd_zhujiemianlingqujinbi.hide(),!0):(null!=this.bannerAd_zhujiemianlingqujinbi&&(0!=oe.wudian_level[6]&&1==oe.ctrlInfo.isWudian?(console.log("show_zhujiemianlingqujinbi ConfigData.ctrlInfo.lateDelay[6] = ",oe.ctrlInfo.lateDelay[6]),Laya.timer.clear(this,this.show_zhujiemianlingqujinbi),Laya.timer.once(oe.ctrlInfo.lateDelay[6],this,this.show_zhujiemianlingqujinbi)):(Laya.timer.clear(this,this.show_zhujiemianlingqujinbi),Laya.timer.once(700,this,this.show_zhujiemianlingqujinbi))),!0)}},{key:"show_zhujiemianlingqujinbi",value:function(){console.log("show_zhujiemianlingqujinbi"),this.bannerAd_zhujiemianlingqujinbi&&this.bannerAd_zhujiemianlingqujinbi.show()}},{key:"hideBannerAd_zhujiemianlingqujinbi",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.bannerAd_zhujiemianlingqujinbi&&this.bannerAd_zhujiemianlingqujinbi.hide()}},{key:"destroyBannerAd_zhujiemianlingqujinbi",value:function(){this.bannerAd_zhujiemianlingqujinbi&&(this.bannerAd_zhujiemianlingqujinbi.destroy(),this.bannerAd_zhujiemianlingqujinbi=null)}},{key:"showBannerAd_shiyongpifu",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(103);if(null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_shiyongpifuTime>0&&Laya.timer.currTimer-this.bannerAd_shiyongpifuTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_shiyongpifu());var o=t.ad_id.split(",");return this.bannerAd_shiyongpifu||(this.totalBannerTimes++,this.bannerAd_shiyongpifuTime=Laya.timer.currTimer,this.bannerAd_shiyongpifu=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_shiyongpifu.onResize(function(e){var t=WxAdManager.Instance.bannerAd_shiyongpifu;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(t.style.top=t.style.top-25))}),this.bannerAd_shiyongpifu.onError(function(e){h.instance.emit(g),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_shiyongpifu()}),this.bannerAd_shiyongpifu.onLoad(function(){})),e?(console.log("预加载广告"),s&&(this.bannerAd_shiyongpifuTime=-1),null!=this.bannerAd_shiyongpifu&&this.bannerAd_shiyongpifu.hide(),!0):(null!=this.bannerAd_shiyongpifu&&(0!=oe.wudian_level[0]&&1==oe.ctrlInfo.isWudian?(Laya.timer.clear(this,this.show_shiyongpifu),console.log("shiyongpifu ConfigData.ctrlInfo.lateDelay[0] ="+oe.ctrlInfo.lateDelay[0]),Laya.timer.once(oe.ctrlInfo.lateDelay[0],this,this.show_shiyongpifu)):(Laya.timer.clear(this,this.show_shiyongpifu),Laya.timer.once(700,this,this.show_shiyongpifu))),!0)}},{key:"show_shiyongpifu",value:function(){console.log("show_shiyongpifu"),this.bannerAd_shiyongpifu&&this.bannerAd_shiyongpifu.show()}},{key:"hideBannerAd_shiyongpifu",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.bannerAd_shiyongpifu&&this.bannerAd_shiyongpifu.hide()}},{key:"destroyBannerAd_shiyongpifu",value:function(){this.bannerAd_shiyongpifu&&(this.bannerAd_shiyongpifu.destroy(),this.bannerAd_shiyongpifu=null)}},{key:"showBannerAd_fuhuo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(104);if(console.log("showBannerAd_fuhuo adInfo =",t),null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_fuhuoTime>0&&Laya.timer.currTimer-this.bannerAd_fuhuoTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_fuhuo());var o=t.ad_id.split(",");return this.bannerAd_fuhuo||(this.totalBannerTimes++,this.bannerAd_fuhuoTime=Laya.timer.currTimer,this.bannerAd_fuhuo=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_fuhuo.onResize(function(e){var t=WxAdManager.Instance.bannerAd_fuhuo;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(t.style.top=t.style.top-25))}),this.bannerAd_fuhuo.onError(function(e){h.instance.emit(m),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_fuhuo()}),this.bannerAd_fuhuo.onLoad(function(){})),e?(console.log("预加载广告"),s&&(this.bannerAd_fuhuoTime=-1),null!=this.bannerAd_fuhuo&&this.bannerAd_fuhuo.hide(),!0):(null!=this.bannerAd_fuhuo&&(0!=oe.wudian_level[1]&&1==oe.ctrlInfo.isWudian?(Laya.timer.clear(this,this.show_fuhuo),Laya.timer.once(oe.ctrlInfo.lateDelay[1],this,this.show_fuhuo),console.log("shiyongpifu ConfigData.ctrlInfo.lateDelay[1] ="+oe.ctrlInfo.lateDelay[1])):(Laya.timer.clear(this,this.show_fuhuo),Laya.timer.once(700,this,this.show_fuhuo))),!0)}},{key:"show_fuhuo",value:function(){console.log("show_fuhuo"),this.bannerAd_fuhuo&&this.bannerAd_fuhuo.show()}},{key:"hideBannerAd_fuhuo",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.bannerAd_fuhuo&&this.bannerAd_fuhuo.hide()}},{key:"destroyBannerAd_fuhuo",value:function(){this.bannerAd_fuhuo&&(this.bannerAd_fuhuo.destroy(),this.bannerAd_fuhuo=null)}},{key:"showBannerAd_jiesuanjinbi",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(105);if(console.log("showBannerAd_jiesuanjinbi adInfo =",t),null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_jiesuanjinbiTime>0&&Laya.timer.currTimer-this.bannerAd_jiesuanjinbiTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_jiesuanjinbi());var o=t.ad_id.split(",");return this.bannerAd_jiesuanjinbi||(this.totalBannerTimes++,this.bannerAd_jiesuanjinbiTime=Laya.timer.currTimer,this.bannerAd_jiesuanjinbi=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_jiesuanjinbi.onResize(function(e){var t=WxAdManager.Instance.bannerAd_jiesuanjinbi;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(t.style.top=t.style.top-25))}),this.bannerAd_jiesuanjinbi.onError(function(e){h.instance.emit(f),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_jiesuanjinbi()}),this.bannerAd_jiesuanjinbi.onLoad(function(){})),e?(console.log("预加载广告"),s&&(this.bannerAd_jiesuanjinbiTime=-1),null!=this.bannerAd_jiesuanjinbi&&this.bannerAd_jiesuanjinbi.hide(),!0):(null!=this.bannerAd_jiesuanjinbi&&(0!=oe.wudian_level[2]&&1==oe.ctrlInfo.isWudian?(console.log("show_jiesuanjinbi ConfigData.ctrlInfo.lateDelay[2] = ",oe.ctrlInfo.lateDelay[2]),Laya.timer.clear(this,this.show_jiesuanjinbi),Laya.timer.once(oe.ctrlInfo.lateDelay[2],this,this.show_jiesuanjinbi)):(Laya.timer.clear(this,this.show_jiesuanjinbi),Laya.timer.once(700,this,this.show_jiesuanjinbi))),!0)}},{key:"show_jiesuanjinbi",value:function(){console.log("show_jiesuanjinbi"),this.bannerAd_jiesuanjinbi&&this.bannerAd_jiesuanjinbi.show()}},{key:"hideBannerAd_jiesuanjinbi",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.bannerAd_jiesuanjinbi&&this.bannerAd_jiesuanjinbi.hide()}},{key:"destroyBannerAd_jiesuanjinbi",value:function(){this.bannerAd_jiesuanjinbi&&(this.bannerAd_jiesuanjinbi.destroy(),this.bannerAd_jiesuanjinbi=null)}},{key:"showBannerAd_jiesuanjiemian",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(106);if(null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_jiesuanjiemianTime>0&&Laya.timer.currTimer-this.bannerAd_jiesuanjiemianTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_jiesuanjiemian());var o=t.ad_id.split(",");return this.bannerAd_jiesuanjiemian||(this.totalBannerTimes++,this.bannerAd_jiesuanjiemianTime=Laya.timer.currTimer,this.bannerAd_jiesuanjiemian=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_jiesuanjiemian.onResize(function(e){var t=WxAdManager.Instance.bannerAd_jiesuanjiemian;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(t.style.top=t.style.top-25))}),this.bannerAd_jiesuanjiemian.onError(function(e){h.instance.emit(y),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_jiesuanjiemian()}),this.bannerAd_jiesuanjiemian.onLoad(function(){})),e?(console.log("预加载广告"),s&&(this.bannerAd_jiesuanjiemianTime=-1),null!=this.bannerAd_jiesuanjiemian&&this.bannerAd_jiesuanjiemian.hide(),!0):(null!=this.bannerAd_jiesuanjiemian&&(0!=oe.wudian_level[3]&&1==oe.ctrlInfo.isWudian?(Laya.timer.clear(this,this.show_jiesuanjiemian),Laya.timer.once(oe.ctrlInfo.lateDelay[3],this,this.show_jiesuanjiemian),console.log("show_jiesuanjiemian ConfigData.ctrlInfo.lateDelay[3] = ",oe.ctrlInfo.lateDelay[3])):(Laya.timer.clear(this,this.show_jiesuanjiemian),Laya.timer.once(700,this,this.show_jiesuanjiemian))),!0)}},{key:"show_jiesuanjiemian",value:function(){console.log("show_jiesuanjiemian"),this.bannerAd_jiesuanjiemian&&this.bannerAd_jiesuanjiemian.show()}},{key:"hideBannerAd_jiesuanjiemian",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.bannerAd_jiesuanjiemian&&this.bannerAd_jiesuanjiemian.hide()}},{key:"destroyBannerAd_jiesuanjiemian",value:function(){this.bannerAd_jiesuanjiemian&&(this.bannerAd_jiesuanjiemian.destroy(),this.bannerAd_jiesuanjiemian=null)}},{key:"showBannerAd_goldenEgg",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!Laya.Browser.onMiniGame||!this.isInited)return!1;if(!oe.allAdsControl)return!1;var t=this.getAdInfo(102);if(null==t||0==t.ad_status)return!1;var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight,s=!1;this.bannerAd_goldenEggTime>0&&Laya.timer.currTimer-this.bannerAd_goldenEggTime>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&(s=!0,WxAdManager.Instance.destroyBannerAd_goldenEgg());var o=t.ad_id.split(",");return this.bannerAd_goldenEgg||(this.totalBannerTimes++,this.bannerAd_goldenEggTime=Laya.timer.currTimer,this.bannerAd_goldenEgg=window.wx.createBannerAd({adUnitId:o[O.Range(0,o.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerAd_goldenEgg.onResize(function(e){var t=WxAdManager.Instance.bannerAd_goldenEgg;t&&(t.style.left=(i-t.style.realWidth)/2,t.style.top=a-t.style.realHeight,a/i>2&&(t.style.top=t.style.top-25))}),this.bannerAd_goldenEgg.onError(function(e){h.instance.emit(p),console.log("广告加载错误:",e),WxAdManager.Instance.destroyBannerAd_goldenEgg()}),this.bannerAd_goldenEgg.onLoad(function(){})),e?(console.log("预加载广告"),s&&(this.bannerAd_goldenEggTime=-1),null!=this.bannerAd_goldenEgg&&this.bannerAd_goldenEgg.hide(),!0):(null!=this.bannerAd_goldenEgg&&(0!=oe.wudian_level[7]&&1==oe.ctrlInfo.isWudian?(console.log("show_goldenEgg ConfigData.ctrlInfo.lateDelay[7] = ",oe.ctrlInfo.lateDelay[7]),Laya.timer.clear(this,this.show_goldenEgg),Laya.timer.once(oe.ctrlInfo.lateDelay[7],this,this.show_goldenEgg)):(Laya.timer.clear(this,this.show_goldenEgg),Laya.timer.once(700,this,this.show_goldenEgg))),!0)}},{key:"show_goldenEgg",value:function(){console.log("show_goldenEgg"),this.bannerAd_goldenEgg&&this.bannerAd_goldenEgg.show()}},{key:"hideBannerAd_goldenEgg",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.bannerAd_goldenEgg&&this.bannerAd_goldenEgg.hide()}},{key:"destroyBannerAd_goldenEgg",value:function(){this.bannerAd_goldenEgg&&(this.bannerAd_goldenEgg.destroy(),this.bannerAd_goldenEgg=null)}},{key:"hideBannerAd",value:function(){Laya.timer.clear(this,this.show_zhujiemianlingqujinbi),Laya.timer.clear(this,this.show_shiyongpifu),Laya.timer.clear(this,this.show_fuhuo),Laya.timer.clear(this,this.show_jiesuanjinbi),Laya.timer.clear(this,this.show_jiesuanjiemian),Laya.timer.clear(this,this.showBannerAd_goldenEgg),this.hideBannerAd_fuhuo(),this.hideBannerAd_jiesuanjiemian(),this.hideBannerAd_jiesuanjinbi(),this.hideBannerAd_shiyongpifu(),this.hideBannerAd_zhujiemian(),this.hideBannerAd_zhujiemianlingqujinbi(),this.hideBannerAd_goldenEgg()}},{key:"initRewardedVideoAd_shuangbeikaiju",value:function(e){Laya.Browser.onMiniGame&&this.isInited&&(this.rewardedVideoAd_shuangbeikaiju=window.wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd_shuangbeikaiju&&(this.rewardedVideoAd_shuangbeikaiju.onLoad(function(){WxAdManager.Instance.hasAd_shuangbeikaiju=!0}),this.rewardedVideoAd_shuangbeikaiju.onError(function(e){WxAdManager.Instance.hasAd_shuangbeikaiju=!1,null!=WxAdManager.Instance.callBackErro_shuangbeikaiju&&WxAdManager.Instance.callBackErro_shuangbeikaiju(WxAdManager.Instance.caller_shuangbeikaiju)}),this.rewardedVideoAd_shuangbeikaiju.onClose(function(e){e&&e.isEnded||void 0===e?(WxAdManager.Instance.videoPlayedTimes+=1,null!=WxAdManager.Instance.callBackSuc_shuangbeikaiju&&WxAdManager.Instance.callBackSuc_shuangbeikaiju(WxAdManager.Instance.caller_shuangbeikaiju)):null!=WxAdManager.Instance.callBackFail_shuangbeikaiju&&WxAdManager.Instance.callBackFail_shuangbeikaiju(WxAdManager.Instance.caller_shuangbeikaiju)})))}},{key:"showVideo_shuangbeikaiju",value:function(e,t,i,n,a){this.isInited&&(this.caller_shuangbeikaiju=t,this.callBackSuc_shuangbeikaiju=i,this.callBackFail_shuangbeikaiju=n,this.callBackErro_shuangbeikaiju=a,this.hasAd_shuangbeikaiju?(this.hasAd_shuangbeikaiju=!1,this.rewardedVideoAd_shuangbeikaiju.show()):this.rewardedVideoAd_shuangbeikaiju.load().then(function(){WxAdManager.Instance.rewardedVideoAd_shuangbeikaiju.show(),WxAdManager.Instance.hasAd_shuangbeikaiju=!1}))}},{key:"initRewardedVideoAd_zhujiemianduobeijinbi",value:function(e){Laya.Browser.onMiniGame&&this.isInited&&(this.rewardedVideoAd_zhujiemianduobeijinbi=window.wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd_zhujiemianduobeijinbi&&(this.rewardedVideoAd_zhujiemianduobeijinbi.onLoad(function(){WxAdManager.Instance.hasAd_zhujiemianduobeijinbi=!0}),this.rewardedVideoAd_zhujiemianduobeijinbi.onError(function(e){WxAdManager.Instance.hasAd_zhujiemianduobeijinbi=!1,null!=WxAdManager.Instance.callBackErro_zhujiemianduobeijinbi?WxAdManager.Instance.callBackErro_zhujiemianduobeijinbi(WxAdManager.Instance.caller_zhujiemianduobeijinbi):null!=WxAdManager.Instance.callBackSuc_zhujiemianduobeijinbi&&WxAdManager.Instance.callBackSuc_zhujiemianduobeijinbi(WxAdManager.Instance.caller_zhujiemianduobeijinbi)}),this.rewardedVideoAd_zhujiemianduobeijinbi.onClose(function(e){e&&e.isEnded||void 0===e?(WxAdManager.Instance.videoPlayedTimes+=1,null!=WxAdManager.Instance.callBackSuc_zhujiemianduobeijinbi&&WxAdManager.Instance.callBackSuc_zhujiemianduobeijinbi(WxAdManager.Instance.caller_zhujiemianduobeijinbi)):null!=WxAdManager.Instance.callBackFail_zhujiemianduobeijinbi&&WxAdManager.Instance.callBackFail_zhujiemianduobeijinbi(WxAdManager.Instance.caller_zhujiemianduobeijinbi)})))}},{key:"showVideo_zhujiemianduobeijinbi",value:function(e,t,i,n,a){this.isInited&&(this.caller_zhujiemianduobeijinbi=t,this.callBackSuc_zhujiemianduobeijinbi=i,this.callBackFail_zhujiemianduobeijinbi=n,this.callBackErro_zhujiemianduobeijinbi=a,this.hasAd_zhujiemianduobeijinbi?(this.hasAd_zhujiemianduobeijinbi=!1,this.rewardedVideoAd_zhujiemianduobeijinbi.show()):this.rewardedVideoAd_zhujiemianduobeijinbi.load().then(function(){WxAdManager.Instance.rewardedVideoAd_zhujiemianduobeijinbi.show(),WxAdManager.Instance.hasAd_zhujiemianduobeijinbi=!1}))}},{key:"initRewardedVideoAd_shiyongpifu",value:function(e){Laya.Browser.onMiniGame&&this.isInited&&(this.rewardedVideoAd_shiyongpifu=window.wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd_shiyongpifu&&(this.rewardedVideoAd_shiyongpifu.onLoad(function(){WxAdManager.Instance.hasAd_shiyongpifu=!0}),this.rewardedVideoAd_shiyongpifu.onError(function(e){WxAdManager.Instance.hasAd_shiyongpifu=!1,null!=WxAdManager.Instance.callBackErro_shiyongpifu?WxAdManager.Instance.callBackErro_shiyongpifu(WxAdManager.Instance.caller_shiyongpifu):null!=WxAdManager.Instance.callBackSuc_shiyongpifu&&WxAdManager.Instance.callBackSuc_shiyongpifu(WxAdManager.Instance.caller_shiyongpifu)}),this.rewardedVideoAd_shiyongpifu.onClose(function(e){e&&e.isEnded||void 0===e?(WxAdManager.Instance.videoPlayedTimes+=1,null!=WxAdManager.Instance.callBackSuc_shiyongpifu&&WxAdManager.Instance.callBackSuc_shiyongpifu(WxAdManager.Instance.caller_shiyongpifu)):null!=WxAdManager.Instance.callBackFail_shiyongpifu&&WxAdManager.Instance.callBackFail_shiyongpifu(WxAdManager.Instance.caller_shiyongpifu)})))}},{key:"showVideo_shiyongpifu",value:function(e,t,i,n,a){this.isInited&&(this.caller_shiyongpifu=t,this.callBackSuc_shiyongpifu=i,this.callBackFail_shiyongpifu=n,this.callBackErro_shiyongpifu=a,this.hasAd_shiyongpifu?(this.hasAd_shiyongpifu=!1,this.rewardedVideoAd_shiyongpifu.show()):this.rewardedVideoAd_shiyongpifu.load().then(function(){WxAdManager.Instance.rewardedVideoAd_shiyongpifu.show(),WxAdManager.Instance.hasAd_shiyongpifu=!1}))}},{key:"initRewardedVideoAd_fuhuo",value:function(e){Laya.Browser.onMiniGame&&this.isInited&&(this.rewardedVideoAd_fuhuo=window.wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd_fuhuo&&(this.rewardedVideoAd_fuhuo.onLoad(function(){WxAdManager.Instance.hasAd_fuhuo=!0}),this.rewardedVideoAd_fuhuo.onError(function(e){WxAdManager.Instance.hasAd_fuhuo=!1,null!=WxAdManager.Instance.callBackErro_fuhuo&&WxAdManager.Instance.callBackErro_fuhuo(WxAdManager.Instance.caller_fuhuo)}),this.rewardedVideoAd_fuhuo.onClose(function(e){e&&e.isEnded||void 0===e?(WxAdManager.Instance.videoPlayedTimes+=1,null!=WxAdManager.Instance.callBackSuc_fuhuo&&WxAdManager.Instance.callBackSuc_fuhuo(WxAdManager.Instance.caller_fuhuo)):null!=WxAdManager.Instance.callBackFail_fuhuo&&WxAdManager.Instance.callBackFail_fuhuo(WxAdManager.Instance.caller_fuhuo)})))}},{key:"showVideo_fuhuo",value:function(e,t,i,n,a){this.isInited&&(this.caller_fuhuo=t,this.callBackSuc_fuhuo=i,this.callBackFail_fuhuo=n,this.callBackErro_fuhuo=a,this.hasAd_fuhuo?(this.hasAd_fuhuo=!1,this.rewardedVideoAd_fuhuo.show()):this.rewardedVideoAd_fuhuo.load().then(function(){WxAdManager.Instance.rewardedVideoAd_fuhuo.show(),WxAdManager.Instance.hasAd_fuhuo=!1}))}},{key:"initRewardedVideoAd_jiesuanjinbi",value:function(e){Laya.Browser.onMiniGame&&this.isInited&&(this.rewardedVideoAd_jiesuanjinbi=window.wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd_jiesuanjinbi&&(this.rewardedVideoAd_jiesuanjinbi.onLoad(function(){WxAdManager.Instance.hasAd_jiesuanjinbi=!0}),this.rewardedVideoAd_jiesuanjinbi.onError(function(e){WxAdManager.Instance.hasAd_jiesuanjinbi=!1,null!=WxAdManager.Instance.callBackErro_jiesuanjinbi?WxAdManager.Instance.callBackErro_jiesuanjinbi(WxAdManager.Instance.caller_jiesuanjinbi):null!=WxAdManager.Instance.callBackSuc_jiesuanjinbi&&WxAdManager.Instance.callBackSuc_jiesuanjinbi(WxAdManager.Instance.caller_jiesuanjinbi)}),this.rewardedVideoAd_jiesuanjinbi.onClose(function(e){e&&e.isEnded||void 0===e?(WxAdManager.Instance.videoPlayedTimes+=1,null!=WxAdManager.Instance.callBackSuc_jiesuanjinbi&&WxAdManager.Instance.callBackSuc_jiesuanjinbi(WxAdManager.Instance.caller_jiesuanjinbi)):null!=WxAdManager.Instance.callBackFail_jiesuanjinbi&&WxAdManager.Instance.callBackFail_jiesuanjinbi(WxAdManager.Instance.caller_jiesuanjinbi)})))}},{key:"showVideo_jiesuanjinbi",value:function(e,t,i,n,a){this.isInited&&(this.caller_jiesuanjinbi=t,this.callBackSuc_jiesuanjinbi=i,this.callBackFail_jiesuanjinbi=n,this.callBackErro_jiesuanjinbi=a,this.hasAd_jiesuanjinbi?(this.hasAd_jiesuanjinbi=!1,this.rewardedVideoAd_jiesuanjinbi.show()):this.rewardedVideoAd_jiesuanjinbi.load().then(function(){WxAdManager.Instance.rewardedVideoAd_jiesuanjinbi.show(),WxAdManager.Instance.hasAd_jiesuanjinbi=!1}))}},{key:"initRewardedVideoAd_shangcheng",value:function(e){Laya.Browser.onMiniGame&&this.isInited&&(this.rewardedVideoAd_shangcheng=window.wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd_shangcheng&&(this.rewardedVideoAd_shangcheng.onLoad(function(){WxAdManager.Instance.hasAd_shangcheng=!0}),this.rewardedVideoAd_shangcheng.onError(function(e){WxAdManager.Instance.hasAd_shangcheng=!1,null!=WxAdManager.Instance.callBackErro_shangcheng?WxAdManager.Instance.callBackErro_shangcheng(WxAdManager.Instance.caller_shangcheng):null!=WxAdManager.Instance.callBackSuc_shangcheng&&WxAdManager.Instance.callBackSuc_shangcheng(WxAdManager.Instance.caller_shangcheng)}),this.rewardedVideoAd_shangcheng.onClose(function(e){e&&e.isEnded||void 0===e?(WxAdManager.Instance.videoPlayedTimes+=1,null!=WxAdManager.Instance.callBackSuc_shangcheng&&WxAdManager.Instance.callBackSuc_shangcheng(WxAdManager.Instance.caller_shangcheng)):null!=WxAdManager.Instance.callBackFail_shangcheng&&WxAdManager.Instance.callBackFail_shangcheng(WxAdManager.Instance.caller_shangcheng)})))}},{key:"showVideo_shangcheng",value:function(e,t,i,n,a){this.isInited&&(this.caller_shangcheng=t,this.callBackSuc_shangcheng=i,this.callBackFail_shangcheng=n,this.callBackErro_shangcheng=a,this.hasAd_shangcheng?(this.hasAd_shangcheng=!1,this.rewardedVideoAd_shangcheng.show()):this.rewardedVideoAd_shangcheng.load().then(function(){WxAdManager.Instance.rewardedVideoAd_shangcheng.show(),WxAdManager.Instance.hasAd_shangcheng=!1}))}}],[{key:"Instance",get:function(){return null==WxAdManager.instance&&(WxAdManager.instance=new WxAdManager),WxAdManager.instance}}]),WxAdManager}(),Z=function(){function WXAPI(){var e=this;_classCallCheck(this,WXAPI),this._launch={},this.btns=[],this.stime=0,this.shareBackArgs={},this.isInited=!1,this.rewardedVideoAds=null,this.hasAd=!1,this.interstitialAd=null,this.canShareTimeline=!1,this.isHide=!1,this.videoPlayedTimes=0,this.preInterstitalsTime=0,this._launch=window.wx.getLaunchOptionsSync(),h.instance.onOnceEvent("getSystemParamListBack",this,function(){e.showShareMenu()}),window.wx.onShow(function(t){e.isHide=!1;var i=Laya.Browser.now()-e.stime;oe.isHide&&oe.hideTotalTime<=0&&e.stime>0&&(oe.hideTotalTime=i+100,e.stime=0,X.instance.resumeBGM()),oe.isHide=!1,oe.isBackFromBackground=!0,console.log("回到前台====",i,oe.hideTotalTime,Laya.Browser.now());var n=t.shareTicket,a=t.query||{};if(null!=n&&a.avatarUrlGroup&&a.nickNameGroup);else{var s=e.shareBackArgs||{};i>=3e3?(s.success=!0,o.shareFailNum=0,e.shareBack&&e.myCaller&&e.shareBack.call(e.myCaller,s),e.shareBack=null):(s.success=!1,o.shareFailNum++,o.shareFailNum>2&&(s.success=!0,o.shareFailNum=0),e.shareBack&&e.myCaller&&e.shareBack.call(e.myCaller,s),e.shareBack=null)}!o.isShare&&oe.ctrlInfo.gameBackTolist&&Laya.timer.frameOnce(1,e,function(){if(!q.instance.getView("ConvergeAdNew.scene")){var e=!1;1==oe.ctrlInfo.gameBackTolist[0]&&q.instance.getView("SkinTrial.scene")?e=!0:1==oe.ctrlInfo.gameBackTolist[1]&&q.instance.getView("Resurgence.scene")?e=!0:1==oe.ctrlInfo.gameBackTolist[2]&&(q.instance.getView("RewardView.scene")||q.instance.getView("RankRewordView.scene"))?e=!0:1==oe.ctrlInfo.gameBackTolist[3]&&q.instance.getView("GameOver.scene")?e=!0:1==oe.ctrlInfo.gameBackTolist[4]&&q.instance.getView("MainView.scene")?e=!0:1==oe.ctrlInfo.gameBackTolist[6]&&(q.instance.getView("OnHookView.scene")||q.instance.getView("InviteView.scene"))?e=!0:1==oe.ctrlInfo.gameBackTolist[8]&&q.instance.getView("FriendInvite.scene")?e=!0:1==oe.ctrlInfo.gameBackTolist[9]&&q.instance.getView("GameFighting.scene")&&(e=!0),e&&h.instance.emit("openConvergeAdNew")}}),o.isShare=!1,e.shareBackArgs={}}),window.wx.onHide(function(){oe.isHide=!0,oe.isBackFromBackground=!1,e.isHide=!0,e.stime=Laya.Browser.now(),oe.hideCurrTimer=Laya.timer.currTimer,console.log("退到后台======",oe.hideCurrTimer,Laya.Browser.now())})}return _createClass(WXAPI,[{key:"init",value:function(){Laya.Browser.onMiniGame&&(oe.systemInfo.SDKVersion&&le.compareVersion(oe.systemInfo.SDKVersion,"2.0.4")>=0&&(this.isInited=!0,le.compareVersion(oe.systemInfo.SDKVersion,"2.6.0")>=0&&(this.canPlayInterstitial=!0),oe.osType==ae.Android&&le.compareVersion(oe.systemInfo.SDKVersion,"2.11.3")>=0&&(this.canShareTimeline=!0),this.initVedioCom()),this.preBannerTimeOther=Laya.timer.currTimer,this.preInterstitalsTime=0)}},{key:"ShareFileTip",value:function(e){var t=1==o.shareFailNum?"分享失败,请分享至大于30人的群":"改群已分享过,请换个群";window.wx.showModal({title:"提示",content:t,showCancel:!0,cancelText:"取消",confirmText:"去分享",success:e})}},{key:"IsHide",value:function(){return this.isHide}},{key:"onGoShare",value:function(e){this.myCaller=e.caller,this.shareBack=e.callback,this.shareBackArgs=e.args||{}}},{key:"doLogin",value:function(e){var t=this;if(Laya.Browser.onMiniGame){var i=this;window.wx.login({success:function(i){o.code=i.code;var n=t.getLaunchData(),a={};a.code=i.code,n.query&&(a.inviteId=n.query.invite_uid||"",a.channelId=n.query.channel||"",o.fromImgid=n.query.cur_share_id||""),n.referrerInfo&&(o.fromAppid=n.referrerInfo.appId),a.appid=oe.myAppid,a.nowVersion=oe.version,a.success=e.success,a.timeout=e.timeout,a.fail=e.fail,se.instance.login(a)},fail:function(){Laya.timer.once(5e3,i,function(){i.doLogin(e)})}})}}},{key:"getOffsetOpenDomain",value:function(){return this.offsetOpenDomain}},{key:"getLaunchData",value:function(){return this._launch}},{key:"getQuery",value:function(){return this._launch.query}},{key:"getReferrerInfo",value:function(){return this._launch.referrerInfo}},{key:"uploadRankDate",value:function(e){if(Laya.Browser.onMiniGame){var t=[];le.isNull(e.level)||t.push({key:"level",value:e.level+""}),le.isNull(e.score)||t.push({key:"score",value:e.score+""}),window.wx.setUserCloudStorage({KVDataList:t,success:function(){}})}}},{key:"showShareMenu",value:function(){if(Laya.Browser.onMiniGame){var e={withShareTicket:!0};this.canShareTimeline&&(e.menus=["shareAppMessage","shareTimeline"]),window.wx.showShareMenu(e);var t=this.createShareInfo();null!=t?(window.wx.onShareAppMessage(function(){return t}),this.canShareTimeline&&window.wx.onShareTimeline(function(){return t})):console.log("分享信息為null")}}},{key:"createShareInfo",value:function(e){if(!oe.getCtrlData("shareInfo"))return null;var t=JSON.parse(oe.getCtrlData("shareInfo"));if(!t||0==t.length)return null;var i=le.random(0,t.length-1),n=t[i].title,a=t[i].img,s="invite_uid="+(o.userId?o.userId:"");return s+="&cur_share_id="+t[i].id,s+="&channel="+(o.channelId?o.channelId:""),e&&(e.id&&(s+="&scene="+e.id),e.itemId&&(s+="&itemId="+e.itemId),e.type&&(s+="&type="+e.type),e.share_title&&(n=e.share_title),e.share_img&&(a=e.share_img)),{title:n,imageUrl:a,query:s}}},{key:"shareAppMessage",value:function(e){if(Laya.Browser.onMiniGame&&(e.callback&&this.onGoShare(e),oe.getCtrlData("shareInfo"))){M.instance.shareStatistics(e.type);var t=this.createShareInfo(e);null!=t?window.wx.shareAppMessage(t):console.log("分享信息為null")}}},{key:"navigateToMiniProgram",value:function(e){e&&e.to_appid&&Laya.Browser.onMiniGame&&(M.instance.navigateToMiniProgramStatistics(e),window.wx.navigateToMiniProgram({appId:e.to_appid,path:e.toLinks,extraData:{foo:"bar"},complete:function(){e.complete&&e.complete(),e.complete=null},fail:function(){if(window.wx.showToast({title:"跳转失败"}),e.fail&&e.fail(),e.fail=null,!q.instance.getView("ConvergeAdNew.scene")&&oe.ctrlInfo.adCancelTolist){var t=!1;1==oe.ctrlInfo.adCancelTolist[0]&&q.instance.getView("SkinTrial.scene")?t=!0:1==oe.ctrlInfo.adCancelTolist[1]&&q.instance.getView("Resurgence.scene")?t=!0:1==oe.ctrlInfo.adCancelTolist[2]&&(q.instance.getView("RewardView.scene")||q.instance.getView("RankRewordView.scene"))?t=!0:1==oe.ctrlInfo.adCancelTolist[3]&&q.instance.getView("GameOver.scene")?t=!0:1==oe.ctrlInfo.adCancelTolist[4]&&q.instance.getView("MainView.scene")?t=!0:1==oe.ctrlInfo.adCancelTolist[6]&&q.instance.getView("InviteView.scene")?t=!0:1==oe.ctrlInfo.adCancelTolist[8]&&q.instance.getView("FriendInvite.scene")?t=!0:1==oe.ctrlInfo.adCancelTolist[9]&&q.instance.getView("GameFighting.scene")&&(t=!0),t&&h.instance.emit("openConvergeAdNew")}},success:function(){M.instance.navigateToMiniProgramBackStatistics(e),e.callback&&e.callback("success"),e.callback=null}}))}},{key:"setOpenDomainOffset",value:function(){var e=Laya.stage.width-We.width;e<0&&(e=0);var t=Laya.stage.height-We.height;t<0&&(t=0),this.offsetOpenDomain=new Laya.Vector2(e,t)}},{key:"createAuthorizationButton",value:function(e){if(Laya.Browser.onMiniGame){var t=this;window.wx.getSetting({success:function(i){if(i.authSetting&&i.authSetting["scope.userInfo"])P.log("已经授权");else{var n=Laya.stage.width,a=Laya.stage.height,s=Laya.Browser.width/Laya.Browser.pixelRatio/n,r=Laya.Browser.height/Laya.Browser.pixelRatio/a,l=(e.x-e.width/2)*s,h=(e.y+t.offsetOpenDomain.y-e.height/2)*r,c=e.width*s,u=e.height*r;e.isFull&&(l=0,h=(e.y+t.offsetOpenDomain.y/2)*r,c=c,u=u,"#ff0703");var d=window.wx.createUserInfoButton({type:"text",text:"",style:{left:l,top:h,width:c,height:u}});t.btns&&t.btns.push({button:d,isFull:e.isFull}),d.onTap(function(i){i&&i.userInfo?(o.nickName=i.userInfo.nickName,o.gender=i.userInfo.gender,o.avatarUrl=i.userInfo.avatarUrl,M.instance.authorStatistics(),se.instance.updateUserInfo(),t.btns&&t.btns.forEach(function(e){e&&e.button.destroy()}),t.btns=null,d.destroy(),e.successBack&&e.successBack()):(t.destoryAuthorization(),e.failBack&&e.failBack())})}},fail:function(){},complete:function(){}})}}},{key:"destoryAuthorization",value:function(){oe.repeatAuthorization?this.setAuthorizationCheck(!1):(oe.isCreateAuthorization=!0,this.btns&&this.btns.forEach(function(e){e&&e.button.destroy()}))}},{key:"setAuthorizationCheck",value:function(e){this.btns&&this.btns.forEach(function(t){t&&(e?t.button.show():t.button.hide())})}},{key:"vibrateShort",value:function(){Laya.Browser.onMiniGame&&oe.isVirbort&&window.wx.vibrateShort()}},{key:"vibrateLong",value:function(){Laya.Browser.onMiniGame&&oe.isVirbort&&window.wx.vibrateLong()}},{key:"openCustomerServiceConversation",value:function(){window.wx.openCustomerServiceConversation()}},{key:"cleanVideoCall",value:function(){this.myCaller=null,this.callBackSuc=null,this.callBackFail=null,this.callBackErro=null}},{key:"CanPlayVideo",value:function(){return this.isInited&&this.hasAd}},{key:"initVedioCom",value:function(){var e=this,t=this;if(this.isInited){var i="",n=K.Instance.getAdInfo(201);if(n&&(i=n.ad_id),this.rewardedVideoAds=window.wx.createRewardedVideoAd({adUnitId:i}),null==this.rewardedVideoAds)return;this.rewardedVideoAds.onLoad(function(){t.hasAd=!0}),this.rewardedVideoAds.onError(function(){X.instance.resumeBGM(),t.hasAd=!1,e.callBackErro?e.callBackErro():(null!=t.callBackSuc&&t.callBackSuc(),e.cleanVideoCall())}),this.rewardedVideoAds.onClose(function(i){i&&i.isEnded||void 0===i?(M.instance.videoPlayOverAdStatistics(e._type),t.videoPlayedTimes+=1,null!=t.callBackSuc&&t.callBackSuc()):null!=t.callBackFail&&t.callBackFail(),X.instance.resumeBGM(),e.cleanVideoCall()})}}},{key:"showVideo",value:function(e){var t=this;if(this.isInited){e.posID;this._type=e._type||0,this.myCaller=e.caller,this.callBackSuc=e.callBackSuc,this.callBackFail=e.callBackFail,this.callBackErro=e.callBackErro,M.instance.clickVideoStatistics(this._type),X.instance.pauseBGM(),this.hasAd?(this.hasAd=!1,this.rewardedVideoAds.show()):this.rewardedVideoAds.load().then(function(){t.rewardedVideoAds.show(),t.hasAd=!1})}}},{key:"loadBannerAdOtherFast",value:function(){Laya.Browser.onMiniGame&&this.isInited&&this.showBannerAdOther(!0)}},{key:"showGoldenEggBannerAD",value:function(){this.bannerOther&&(this.bannerOther.show(),console.log("显示砸金蛋广告"))}},{key:"showInterstitialAD",value:function(){if(this.isInited&&this.canPlayInterstitial){if(Laya.timer.currTimer-this.preInterstitalsTime<oe.ctrlInfo.innerAD_delayed_time)return void console.log("时间间隔未到");console.log("显示插屏广告"),this.hideInterstitialAD();var e="",t=K.Instance.getAdInfo(301);t&&(e=t.ad_id),window.wx.createInterstitialAd&&(this.interstitialAd=window.wx.createInterstitialAd({adUnitId:e})),this.interstitialAd&&(this.interstitialAd.show().catch(function(e){console.error("插屏失败=",JSON.stringify(e))}),M.instance.interstitialAdStatistics()),this.preInterstitalsTime=Laya.timer.currTimer}}},{key:"hideInterstitialAD",value:function(){this.interstitialAd&&(this.interstitialAd.destroy&&this.interstitialAd.destroy(),this.interstitialAd=null)}},{key:"loadBannerAdHome",value:function(){Laya.Browser.onMiniGame&&this.isInited&&this.showBannerAdHome()}},{key:"showBannerAdHome",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_zhujiemian()}},{key:"showBannerAdTrySkin",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_shiyongpifu()}},{key:"showBannerAdResurgence",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_fuhuo()}},{key:"showBannerAdSettle",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_jiesuanjinbi()}},{key:"showBannerAdGameOver",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_jiesuanjiemian()}},{key:"showBannerAdOnLineCoinReward",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_zhujiemianlingqujinbi()}},{key:"showBannerAdGoldenEgg",value:function(){return!!Laya.Browser.onMiniGame&&K.Instance.showBannerAd_goldenEgg()}},{key:"showBannerAdOtherFast",value:function(){this.bannerOther?this.bannerOther.show():this.showBannerAdOther()}},{key:"showBannerAdOther",value:function(e){var t=this;if(Laya.Browser.onMiniGame&&this.isInited){this.destoryAllBannerAd();var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight;Laya.timer.currTimer-this.preBannerTimeOther>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&this.bannerOther&&(this.bannerOther.destroy(),this.bannerOther=null),this.bannerOther||(this.destroyBannerAdOther(),this.statisticsbannerUpdateCount(),this.bannerOther=window.wx.createBannerAd({adUnitId:oe.bannerAdIds[le.random(0,oe.bannerAdIds.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerOther.onResize(function(){t.bannerOther.style.left=(i-t.bannerOther.style.realWidth)/2,t.bannerOther.style.top=a-t.bannerOther.style.realHeight-10,a/i>2&&(t.bannerOther.style.top=t.bannerOther.style.top-25)}),this.bannerOther.onError(function(e){console.log("广告加载错误:",e)}),this.preBannerTimeOther=Laya.timer.currTimer),e||null!=this.bannerOther&&this.bannerOther.show()}}},{key:"showBannerAdClassicEndFast",value:function(){this.bannerClassicEnd?this.bannerClassicEnd.show():this.showBannerAdClassicEnd()}},{key:"showBannerAdClassicEnd",value:function(e){var t=this;if(Laya.Browser.onMiniGame&&this.isInited){this.destoryAllBannerAd();var i=oe.systemInfo.windowWidth,n=i,a=oe.systemInfo.windowHeight;Laya.timer.currTimer-this.preBannerTimeOther>oe.ctrlInfo.adDelayedTime&&this.isAdRefresh()&&this.bannerClassicEnd&&(this.bannerClassicEnd.destroy(),this.bannerClassicEnd=null),this.bannerClassicEnd||(this.destroyBannerAdClassicEnd(),this.statisticsbannerUpdateCount(),this.bannerClassicEnd=window.wx.createBannerAd({adUnitId:oe.bannerAdIds[le.random(0,oe.bannerAdIds.length-1)],style:{left:0,top:a-100,width:n}}),this.bannerClassicEnd.onError(function(e){console.log("广告加载错误:",e)}),this.bannerClassicEnd.onResize(function(){t.bannerClassicEnd.style.left=(i-t.bannerClassicEnd.style.realWidth)/2,t.bannerClassicEnd.style.top=a-t.bannerClassicEnd.style.realHeight-10,a/i>2&&(t.bannerClassicEnd.style.top=t.bannerClassicEnd.style.top-25)}),this.preBannerTimeOther=Laya.timer.currTimer),e||null!=this.bannerClassicEnd&&this.bannerClassicEnd.show()}}},{key:"isAdRefresh",value:function(){return o.bannerTimes<oe.ctrlInfo.adRefreshTimes}},{key:"statisticsbannerUpdateCount",value:function(){se.instance.statisticsbannerUpdateCount()}},{key:"destroyBannerAdHome",value:function(){K.Instance.hideBannerAd()}},{key:"destroyBannerAdOther",value:function(){K.Instance.hideBannerAd()}},{key:"destroyBannerAdClassicEnd",value:function(){K.Instance.hideBannerAd()}},{key:"destoryAllBannerAd",value:function(){K.Instance.hideBannerAd()}}],[{key:"ald",value:function(e,t){}}]),WXAPI}(),J=function(){function WXSubDomain(){_classCallCheck(this,WXSubDomain)}return _createClass(WXSubDomain,[{key:"setOpenView",value:function(e){this.wxOpenDataView=e}},{key:"closeFriendRank",value:function(){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"closeFriendRank"})}},{key:"openFriendRank",value:function(e){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"openFriendRank",data:e})}},{key:"openGameOver",value:function(e){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"openGameOver",data:e})}},{key:"closeGameOver",value:function(){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"closeGameOver"})}},{key:"openSurpassOther",value:function(e){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"openSurpassOther",data:e})}},{key:"closeSurpassOther",value:function(){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"closeSurpassOther"})}},{key:"openGoingSurpassOther",value:function(e){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"openGoingSurpassOther",data:e})}},{key:"closeGoingSurpassOther",value:function(){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"closeGoingSurpassOther"})}},{key:"openProvocationOther",value:function(e){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"openProvocationOther",data:e})}},{key:"closeProvocationOther",value:function(){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"closeProvocationOther"})}},{key:"upSelfScore",value:function(e){Laya.Browser.onMiniGame&&this.wxOpenDataView&&this.wxOpenDataView.postMsg({type:"upSelfScore",data:e})}}]),WXSubDomain}(),Q=function(){function AndroidAPI(){_classCallCheck(this,AndroidAPI)}return _createClass(AndroidAPI,[{key:"createShareInfo",value:function(e){e&&(e.id&&"&scene="+e.id,e.itemId&&"&itemId="+e.itemId,e.type&&e.type)}},{key:"onGoShare",value:function(e){AndroidAPI.caller=e.caller,AndroidAPI.shareBack=e.callback,AndroidAPI.shareBackArgs=e.args||{}}},{key:"shareAppMessage",value:function(e){e.callback&&this.onGoShare(e);var t=this.createShareInfo(e);window.Android.share(t)}},{key:"showVideo",value:function(e){!AndroidAPI.isLookAdc&&Laya.Browser.onAndroid&&(AndroidAPI.isLookAdc=!0,AndroidAPI._type=e._type||0,AndroidAPI.myCaller=e.caller,AndroidAPI.callBackSuc=e.callBackSuc,AndroidAPI.callBackFail=e.callBackFail,AndroidAPI.callBackErro=e.callBackErro,M.instance.clickVideoStatistics(AndroidAPI._type),window.Android.getVedioAd("getVedioAd"))}},{key:"showBannerAdOtherFast",value:function(){AndroidAPI.requesAdBannerShow()}},{key:"showBannerAdOther",value:function(e){AndroidAPI.requesAdBannerShow()}},{key:"showBannerAdClassicEndFast",value:function(){AndroidAPI.requesAdBannerShow()}},{key:"showBannerAdClassicEnd",value:function(e){AndroidAPI.requesAdBannerShow()}},{key:"destroyBannerAdHome",value:function(){AndroidAPI.destoryAllBannerAd()}},{key:"destroyBannerAdOther",value:function(){AndroidAPI.destoryAllBannerAd()}},{key:"destroyBannerAdClassicEnd",value:function(){AndroidAPI.destoryAllBannerAd()}},{key:"loadBannerAdHome",value:function(){}},{key:"showBannerAdHome",value:function(e){AndroidAPI.requesAdBannerShow()}}],[{key:"doLogin",value:function(){Laya.Browser.onAndroid&&window.Android.requestUserToken()}},{key:"requestUserTokenBack",value:function(e){}},{key:"requestRebornGiftScore",value:function(){Laya.Browser.onAndroid&&window.Android.requestRebornGiftScore()}},{key:"requestRebornGiftScoreBack",value:function(e){}},{key:"requestRewardToUser",value:function(){Laya.Browser.onAndroid&&window.Android.requestRewardToUser(1)}},{key:"requestshareBack",value:function(e){var t=this.shareBackArgs||{};"1"==e?(t.success=!0,this.shareBack&&this.caller&&this.shareBack.call(this.caller,t),this.shareBack=null):(t.success=!1,this.shareBack&&this.caller&&this.shareBack.call(this.caller,t),this.shareBack=null)}},{key:"vibrateLong",value:function(){Laya.Browser.onAndroid&&!oe.isVirbort&&window.Android.vibrateLong()}},{key:"vibrateShort",value:function(){Laya.Browser.onAndroid&&!oe.isVirbort&&window.Android.vibrateShort()}},{key:"closeGame",value:function(){Laya.Browser.onAndroid&&window.Android.back()}},{key:"cleanVideoCall",value:function(){AndroidAPI.myCaller=null,AndroidAPI.callBackSuc=null,AndroidAPI.callBackFail=null,AndroidAPI.callBackErro=null}},{key:"requestVoideAdBack",value:function(e){switch(Number(e)){case-1:this.callBackErro&&this.callBackErro();break;case 0:this.callBackFail&&this.callBackFail();break;case 1:M.instance.videoPlayOverAdStatistics(this._type),this.callBackSuc&&this.callBackSuc()}this.cleanVideoCall()}},{key:"destoryAllBannerAd",value:function(){Laya.Browser.onAndroid&&window.Android.requesAdBannerClose()}},{key:"requesAdBannerShow",value:function(){Laya.Browser.onAndroid&&window.Android.requesAdBannerShow()}}]),AndroidAPI}();Q.isLookAdc=!1,Q.shareBackArgs={},Q.myCaller=null;var $=function(e){function PlatformMgr(){return _classCallCheck(this,PlatformMgr),_possibleConstructorReturn(this,_getPrototypeOf(PlatformMgr).call(this))}return _inherits(PlatformMgr,Laya.Script),_createClass(PlatformMgr,null,[{key:"initPlatform",value:function(){switch(oe.releasePlatform){case"wx":PlatformMgr.ptAPI=new Z,PlatformMgr.subDomain=new J;break;case"fb":break;case"android":PlatformMgr.ptAPI=new Q,window.Android2JS=PlatformMgr.ptAPI,PlatformMgr.subDomain=null}}},{key:"callAPIMethodByProxy",value:function(e,t){if(PlatformMgr.ptAPI&&PlatformMgr.ptAPI[e])return PlatformMgr.ptAPI[e](t)}},{key:"callSubDomainMethodByProxy",value:function(e,t){if(PlatformMgr.subDomain&&PlatformMgr.subDomain[e])return PlatformMgr.subDomain[e](t)}}]),PlatformMgr}(),ee=function(e){function WXLaunch(){var e;return _classCallCheck(this,WXLaunch),(e=_possibleConstructorReturn(this,_getPrototypeOf(WXLaunch).apply(this,arguments))).progress=0,e.scene3dUrl="res3d/LayaScene_Main/Conventional/Main.ls",e.isLoadingStatistic=!1,e.jsonRes=["config"],e}return _inherits(WXLaunch,Laya.Script),_createClass(WXLaunch,[{key:"onEnable",value:function(){var e=this;this.owner.height=Laya.stage.height;var t=this.owner.getChildByName("progressGroup");this.pro=t.getChildByName("progress"),this.proLabel=t.getChildByName("proLab"),this.netMsg=this.owner.getChildByName("netMsg"),this.netMsg.visible=!1,this.closeButton=this.netMsg.getChildByName("closeButton"),this.closeButton.on(Laya.Event.CLICK,this,function(){e.netMsg.visible=!1,e.closeButton.offAll()}),this.loadRes(),Laya.timer.once(1,this,function(){var i=Laya.stage.height-1334;i<0&&(i=0),t.y+=i/4,e.owner.height=Laya.stage.height})}},{key:"loadRes",value:function(){var e=this,t=[{url:"res/atlas/common.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/game.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/mainview.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/numberFonts.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/aggregation.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/goldenEgg.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/rank.atlas",type:Laya.Loader.ATLAS}];this.jsonRes.forEach(function(e){t.push({url:"res/json/"+e+".json",type:Laya.Loader.JSON})});var i=this;Laya.Browser.onMiniGame?window.wx.loadSubpackage({name:"res3d",success:function(n){console.log("加載成功3d"),window.wx.loadSubpackage({name:"res",success:function(n){Laya.loader.load(t,Laya.Handler.create(e,function(){i.updateProgress(.9),e.loadResComplete()}),Laya.Handler.create(e,function(e){console.log("res********:"+e),i.updateProgress(.6+.3*e)}))},fail:function(t){e.loadRes()}}).onProgressUpdate(function(e){i.updateProgress(.3+.003*e.progress)})},fail:function(t){e.loadRes()}}).onProgressUpdate(function(e){i.updateProgress(.003*e.progress)}):Laya.loader.load(t,Laya.Handler.create(this,function(){i.updateProgress(.9),e.loadResComplete()}),Laya.Handler.create(this,function(e){i.updateProgress(e)}))}},{key:"loadResComplete",value:function(){console.log("前往3d资源加载==="),Laya.Scene3D.load(this.scene3dUrl,Laya.Handler.create(this,this.On3DResLoadComplete))}},{key:"On3DResLoadComplete",value:function(e){this.updateProgress(.95),T.Instance.InitMain(e),WXLaunch.isLoad3DRes=!0,this.CheckLogin()}},{key:"CheckLogin",value:function(){this.EnterGame()}},{key:"updateProgress",value:function(e){this.progress=e>1?1:e<0?0:e,this.progress>=1?(this.proLabel.text="游戏加载完毕，即将进入游戏...",this.pro.width=502):(this.pro.width=502*this.progress,this.proLabel.text="资源加载中..."+Math.floor(100*this.progress)+"%")}},{key:"EnterGame",value:function(){X.instance.playBGM(),this.jsonRes.forEach(function(e){oe.initConfigData(e,Laya.Loader.getRes("res/json/"+e+".json"),!1),console.log("初始化本地配表")}),o.isLogin=!0,this.updateProgress(1),o.InitLevelInstance(),t.Init(),Y.Instance.Init(),h.instance.emit("goHome"),Laya.timer.clearAll(this)}}]),WXLaunch}();ee.isLoad3DRes=!1,ee.needLocalTest=!0;var te,ie,ne,ae,se=function(){function HttpMgr(){_classCallCheck(this,HttpMgr),this._http=new S}return _createClass(HttpMgr,[{key:"getAllAdsControl",value:function(){var e={};e.nowVersion=oe.version,e.timeout=this.getAllAdsControl,this._http.request({url:"getAllAdsControl",data:e,callback:function(e){0==e.code&&e.allAdsControl&&(oe.allAdsControl=JSON.parse(e.allAdsControl),K.Instance.init())}})}},{key:"login",value:function(e){this._http.request({url:"userLogin",data:e,callback:function(t){console.log("userLogin:",t),0==t.code?(t.token&&(o.token=t.token),e.success&&e.success(t)):(o.token="",e.fail&&e.fail(t))}})}},{key:"getConfig",value:function(e,t){this._http.getConfig(e,t)}},{key:"getSystemConfig",value:function(){this._http.request({url:"getSystemParamNew",data:{nowVersion:oe.version},callback:function(e){if(P.log("getSystemParamNew:",e),0==e.code){var t=[];if(e.adInfo&&(t=JSON.parse(e.adInfo),oe.osType==ae.IOS))for(var i=t.length-1;i>=0;i--)1==t[i].toHz&&t.splice(i,1);if(oe.ctrlInfo.isWudian=e.positionControl,oe.ctrlInfo.shareInfo=e.shareInfo,oe.ctrlInfo.adInfo=t,oe.ctrlInfo.isGoldeggs=e.isGoldeggs,oe.ctrlInfo.isGoldeggsReward=e.isGoldeggsReward||1e3,oe.ctrlInfo.adRefreshTimes=e.adRefreshTimes||0,oe.ctrlInfo.innerAD_delayed_time=e.innerADDelayedTime||12e4,oe.ctrlInfo.adDelayedTime=e.adDelayedTime||3e4,oe.ctrlInfo.fuhuoUiType=3,oe.ctrlInfo.marqueeBntSwitch=0,oe.ctrlInfo.btuMove=[],oe.ctrlInfo.btuAppear=[],oe.ctrlInfo.adCancelTolist=[],oe.ctrlInfo.gameBackTolist=[],oe.isReadyConfig=!0,ee.needLocalTest?oe.isRemoteConfig=!0:e.configData&&(oe.serverUrls.config=e.configData,oe.RequestConfig("config")),e.adTimes&&(oe.adTimes=e.adTimes-0),e.appBanner&&(oe.appBanner=1==e.appBanner),e.appBannerTimes&&(oe.appBannerTimes=e.appBannerTimes),e.eggsConfigList){var n=e.eggsConfigList.toString().split("#");if(n.length>0){oe.ctrlInfo.eggs_config_list=[];for(var a=0,s=n.length;a<s;++a){var o=[],r=n[a].toString().split(",");if(r.length>0)for(var l=0,c=r.length;l<c;++l)o.push(parseInt(r[l]));oe.ctrlInfo.eggs_config_list.push(o)}}}if(e.luckboxProgressBar&&(oe.luckboxProgressBar=e.luckboxProgressBar.split(",")),e.luckboxVideoProgressBar&&(oe.luckboxVideoProgressBar=e.luckboxVideoProgressBar.split(",")),e.luckboxClickInterval&&(oe.luckboxClickInterval=e.luckboxClickInterval-0),e.luckboxFirstClick&&(oe.luckboxFirstClick=e.luckboxFirstClick-0),e.luckboxContinueClick&&(oe.luckboxContinueClick=e.luckboxContinueClick-0),e.wudianLevel){var u=e.wudianLevel.toString().split(",");if(u.length>0){oe.wudian_level=[];for(var d=0,g=u.length;d<g;++d)oe.wudian_level.push(parseInt(u[d]))}if(oe.wudian_level.length<10)for(var m=0;m<10-oe.wudian_level.length;m++)oe.wudian_level.push(0)}if(e.lateDelayNew){var f=e.lateDelayNew.toString().split(",");if(f.length>0){oe.ctrlInfo.lateDelay=[];for(var y=0,v=f.length;y<v;++y)oe.ctrlInfo.lateDelay.push(parseInt(f[y]))}if(oe.ctrlInfo.lateDelay.length<10)for(var p=0;p<10-oe.ctrlInfo.lateDelay.length;p++)oe.ctrlInfo.lateDelay.push(1100)}if(e.bannerAdIds&&(oe.bannerAdIds=e.bannerAdIds.split(",")),e.randomRewardProbability&&(oe.ctrlInfo.randomRewardProbability=e.randomRewardProbability),e.randomRewardNum&&(oe.ctrlInfo.randomRewardNum=e.randomRewardNum),e.fuhuoUiType&&(oe.ctrlInfo.fuhuoUiType=e.fuhuoUiType),e.marqueeBntSwitch&&(oe.ctrlInfo.marqueeBntSwitch=e.marqueeBntSwitch),e.allAdsControl&&(oe.allAdsControl=JSON.parse(e.allAdsControl),K.Instance.init()),e.spMarqueeBntwwitch){var w=e.spMarqueeBntwwitch.split(",");if(w.length>0){oe.ctrlInfo.sp_marquee_bnt_switch=[];for(var b=0,L=w.length;b<L;++b)oe.ctrlInfo.sp_marquee_bnt_switch.push(parseInt(w[b]))}}if(e.btuMove){var k=e.btuMove.split(",");if(k.length>0){oe.ctrlInfo.btuMove=[];for(var _=0,A=k.length;_<A;++_)oe.ctrlInfo.btuMove.push(parseInt(k[_]))}if(oe.ctrlInfo.btuMove.length<10)for(var I=0;I<10-oe.ctrlInfo.btuMove.length;I++)oe.ctrlInfo.btuMove.push(1600)}if(e.autoVideo){var C=e.autoVideo.split(",");if(C.length>0){oe.autoVideo=[];for(var B=0,S=C.length;B<S;++B)oe.autoVideo.push(parseInt(C[B]))}}if(e.btuAppear){var M=e.btuAppear.split(",");if(M.length>0){oe.ctrlInfo.btuAppear=[];for(var E=0,D=M.length;E<D;++E)oe.ctrlInfo.btuAppear.push(parseInt(M[E]))}if(oe.ctrlInfo.btuAppear.length<10)for(var T=0;T<10-oe.ctrlInfo.btuAppear.length;T++)oe.ctrlInfo.btuAppear.push(100)}if(e.adCancelTolist){var x=e.adCancelTolist.split(",");if(x.length>0){oe.ctrlInfo.adCancelTolist=[];for(var O=0,j=x.length;O<j;++O)oe.ctrlInfo.adCancelTolist.push(parseInt(x[O]))}if(oe.ctrlInfo.adCancelTolist.length<10)for(var V=0;V<10-oe.ctrlInfo.adCancelTolist.length;V++)oe.ctrlInfo.adCancelTolist.push(0)}if(e.gameBackTolist){var G=e.gameBackTolist.split(",");if(G.length>0){oe.ctrlInfo.gameBackTolist=[];for(var N=0,R=G.length;N<R;++N)oe.ctrlInfo.gameBackTolist.push(parseInt(G[N]))}if(oe.ctrlInfo.gameBackTolist.length<10)for(var W=0;W<10-oe.ctrlInfo.gameBackTolist.length;W++)oe.ctrlInfo.gameBackTolist.push(0)}if(e.reviveSwitch){var F=e.reviveSwitch.split(",");if(F.length>0){oe.reviveSwitch=[];for(var U=0,H=F.length;U<H;++U)oe.reviveSwitch.push(parseInt(F[U]))}}if(e.bannerSwitch){var z=e.bannerSwitch.split(",");if(z.length>0){oe.bannerSwitch=[];for(var Y=0,X=z.length;Y<X;++Y)oe.bannerSwitch.push(parseInt(z[Y]))}if(oe.bannerSwitch.length<10)for(var q=0;q<10-oe.bannerSwitch.length;q++)oe.bannerSwitch.push(1)}if(e.inviteSwitch){var Z=e.inviteSwitch.split(",");if(Z.length>0){oe.inviteSwitch=[];for(var J=0,Q=Z.length;J<Q;++J)oe.inviteSwitch.push(parseInt(Z[J]))}if(oe.inviteSwitch.length<10)for(var te=0;te<10-oe.inviteSwitch.length;te++)oe.inviteSwitch.push(0)}if(e.luckboxSwitch){var ie=e.luckboxSwitch.split(",");if(ie.length>0){oe.luckboxSwitch=[];for(var ne=0,se=ie.length;ne<se;++ne)oe.luckboxSwitch.push(parseInt(ie[ne]))}if(oe.luckboxSwitch.length<10)for(var re=0;re<10-oe.luckboxSwitch.length;re++)oe.luckboxSwitch.push(0)}if(e.gamelistSwitch){var le=e.gamelistSwitch.split(",");if(le.length>0){oe.gamelistSwitch=[];for(var he=0,ce=le.length;he<ce;++he)oe.gamelistSwitch.push(parseInt(le[he]))}if(oe.gamelistSwitch.length<10)for(var ue=0;ue<10-oe.gamelistSwitch.length;ue++)oe.gamelistSwitch.push(0)}if(e.gameboxSwitch){var de=e.gameboxSwitch.split(",");if(de.length>0){oe.gameboxSwitch=[];for(var ge=0,me=de.length;ge<me;++ge)oe.gameboxSwitch.push(parseInt(de[ge]))}if(oe.gameboxSwitch.length<10)for(var fe=0;fe<10-oe.gameboxSwitch.length;fe++)oe.gameboxSwitch.push(0)}$.callAPIMethodByProxy("init")}h.instance.emit("getSystemParamListBack")},fail:function(){h.instance.emit("getSystemParamListBack")}},!0)}},{key:"updateUserInfo",value:function(){this._http.request({url:"updateUserInfo",data:{nickname:o.nickName,headimgurl:o.avatarUrl,sex:o.gender}})}},{key:"statisticsPost",value:function(e){this._http.requestStatistics({data:e})}},{key:"lookVideo",value:function(e,t,i){this._http.request({url:"lookVideo",data:{token:o.token,type:e,gunId:t},callback:function(e){console.log(e),0==e.code?(o.lookVideoNum=e.lookVideoNum,le.isNull(e.doubleStartNum)||(o.doubleStartNum=e.doubleStartNum),i&&i(e)):98==e.code&&h.instance.emit("openTip",e.errorMsg)},fail:function(e){h.instance.emit("openTip","英雄升级失败，服务器卡了")}})}},{key:"statisticsbannerUpdateCount",value:function(){this._http.request({url:"videoCallback.action",data:{type:1},callback:function(e){0==e.code&&(o.bannerTimes=e.bannerTimes)}})}},{key:"updateUserMoney",value:function(e,t){this._http.request({url:"updateUserMoney",data:{token:o.token,money:e},callback:function(e){0==e.code&&(o.gold=e.userMoney,t&&t(e))},fail:function(e){}})}},{key:"getWorldRank",value:function(e){this._http.request({url:"getWorldRank.action",data:{page:1,type:1},callback:function(t){0==t.code&&e.success&&e.success(t)}})}},{key:"Settlement",value:function(e){var t={score:e,money:0};o.curMultiple=1,this._http.request({url:"settle.action",data:t,callback:function(e){if(0==e.code){o.score=e.maxScore;var t={score:e.maxScore};$.callAPIMethodByProxy("uploadRankDate",t),$.callSubDomainMethodByProxy("upSelfScore",e.maxScore)}}})}},{key:"shareCallback",value:function(e,t){var i={token:o.token,nowVersion:oe.version};this._http.request({url:"shareCallback.action",data:i,callback:function(i){console.log(" 分享回调:"+JSON.stringify(i)),i&&0==i.code&&(o.inviteShareCount=i.shareCount,o.gold=i.userMoney,t&&t.call(e,i))}})}},{key:"upgradeAttr",value:function(e,t){this._http.request({url:"upgradeAttribute",data:{token:o.token,type:e},callback:function(i){console.log(i),0==i.code&&(1==e?o.attrVideoLevel++:o.attrShareLevel++,t&&t(i))}})}},{key:"passLevelOld",value:function(e,t,i){this._http.request({url:"settle",data:{token:o.token,type:e},callback:function(e){console.log(e),0==e.code?(o.level=e.level,t&&t(e)):i&&i()},fail:function(e){h.instance.emit("openTip","过关失败，服务器卡了"),i&&i()}})}},{key:"passLevel",value:function(e,t,i,n,a){this._http.request({url:"newSettle",data:{token:o.token,type:e,nowLevel:t,settleNum:i},callback:function(e){console.log(e),0==e.code?(e.unlockLevel&&(o.lastUnlockLevel=e.unlockLevel,o.hasUnlock=!0),e.allLevel&&(o.allLevel=JSON.parse(e.allLevel)),n&&n(e)):a&&a()},fail:function(e){h.instance.emit("openTip","过关失败，服务器卡了"),a&&a()}},!0)}},{key:"videoUnlockLevel",value:function(e,t){var i={token:o.token,unlockLevel:e};this._http.request({url:"videoUnlockLevel",data:i,callback:function(e){console.log(e),e&&0==e.code&&(e.unlockLevel&&(o.lastUnlockLevel=e.unlockLevel,o.hasUnlock=!0,o.allLevel[e.unlockLevel.toString()]=0),t&&t(e))}})}},{key:"addStatisticInfo",value:function(e){var t={token:o.token,actionType:e};this._http.request({url:"addStatisticInfo",data:t,callback:function(e){e&&e.code}})}}]),HttpMgr}();se.instance=new se,function(e){e[e.LANDSCAPE=0]="LANDSCAPE",e[e.VERTICAL=1]="VERTICAL"}(te||(te={})),function(e){e[e.LEVEL=0]="LEVEL",e[e.ENDLESS=1]="ENDLESS"}(ie||(ie={})),function(e){e[e.DRAGE=0]="DRAGE",e[e.TOUCH=1]="TOUCH"}(ne||(ne={})),function(e){e[e.IOS=0]="IOS",e[e.Android=1]="Android"}(ae||(ae={}));var oe=function(){function ConfigData(){_classCallCheck(this,ConfigData)}return _createClass(ConfigData,null,[{key:"initLocal",value:function(){ConfigData.isSound=r.getLocalSound(),ConfigData.isVirbort=r.getLocalVirbort(),Laya.Browser.onMiniGame&&(this.releasePlatform="wx",this.systemInfo=window.wx.getSystemInfoSync(),this.systemInfo&&console.log("状态栏高度：",this.systemInfo.statusBarHeight),this.systemInfo&&this.systemInfo.system.indexOf("iOS")>=0?this.osType=ae.IOS:this.osType=ae.Android)}},{key:"RequestConfig",value:function(e){var t=this;se.instance.getConfig(e,function(e,i){if(ConfigData.cacheConfigs.push({key:e,value:i}),ConfigData.cacheConfigs.length==ConfigData.serverUrls.configUrlsCount){for(var n=0;n<ConfigData.cacheConfigs.length;n++)ConfigData.initConfigData(ConfigData.cacheConfigs[n].key,ConfigData.cacheConfigs[n].value,!0);t.isRemoteConfig=!0,console.log("初始化服務端配表")}})}},{key:"initConfigData",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?ConfigData.configs[e]=t:ConfigData.configs[e]||(ConfigData.configs[e]=t)}},{key:"initServer",value:function(e){console.log(e),e&&(this.encryptDESKey1=e.encry[0],this.encryptDESKey2=e.encry[1],this.encryptDESKey3=e.encry[2],this.isDebug?this.serverUrl=this.debugServerUrl:this.serverUrl=e.serverUrl,this.statisticsUrl=e.statisticsUrl,this.myAppid=e.appid)}},{key:"GetConfig",value:function(e){return ConfigData.configs[e]}},{key:"GetLocaleConfig",value:function(e){return ConfigData.configs.config[e]}},{key:"GetConfigByKey",value:function(e,t,i){for(var n=0;n<ConfigData.configs[e].length;n++){if(ConfigData.configs[e][n][t]==i)return ConfigData.configs[e][n]}return null}},{key:"getCtrlData",value:function(e){return this.ctrlInfo[e]}},{key:"setSound",value:function(e){!e||e.length<=0?(ConfigData.isSound=!0,r.setLocalSound("")):(r.setLocalSound("1"),ConfigData.isSound=!1)}},{key:"setVirbort",value:function(e){!e||e.length<=0?(ConfigData.isVirbort=!0,r.setLocalVirbort("")):(r.setLocalVirbort("1"),ConfigData.isVirbort=!1)}},{key:"getAdData",value:function(e){var t=this.getCtrlData("adInfo");if(le.isNull(t))return[];for(var i=t,n=[],a=0;a<i.length;a++){var s=i[a];s.position==e&&n.push(s)}return n}},{key:"getEggConfigByDay",value:function(e){if(e>5)return ConfigData.ctrlInfo.eggs_config_list[ConfigData.ctrlInfo.eggs_config_list.length-1];for(var t=0;t<ConfigData.ctrlInfo.eggs_config_list.length;t++){var i=ConfigData.ctrlInfo.eggs_config_list[t];if(i[0]==e)return i}}}]),ConfigData}();oe.encryptDES=!0,oe.encryptDESKey1="qireNNC1",oe.encryptDESKey2="qireNNC2",oe.encryptDESKey3="qireNNC3",oe.mainBtnsType=1,oe.beginnerGuide=0,oe.releasePlatform="",oe.configs=[],oe.cacheConfigs=[],oe.language="cn",oe.languageData=null,oe.isLog=!0,oe.myAppid="wx9d488b06c6c5455e",oe.version="103",oe.isDebug=!1,oe.serverUrl="https://wx2.qirecomic.com/nnnlc_wx1/",oe.debugServerUrl="http://192.168.1.164:8191/",oe.statisticsUrl="https://log.qirecomic.com/logPost",oe.aladingStatus=1,oe.isHide=!1,oe.hideCurrTimer=0,oe.hideTotalTime=0,oe.isBackFromBackground=!0,oe.playingVideo=!1,oe.isCreateAuthorization=!1,oe.repeatAuthorization=!1,oe.allAdsControl=[],oe.wordRankLst=[{headImage:"https://wx.qlogo.cn/mmopen/vi_32/fP9ib08HjwH7CXKQJ5lJ3dGfgZbKQXlurw4nNVvrjUYTDicCfO0iaB7yLSL4FO63kIyObBic5gJyqOU4Mkf4ar0alA/132",nickname:"暖儿"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/3Pibbf0ib4POR1f0DzveWOXiaF2KxmOLeo2iaXtibfHgiajKlIiczvTXx372d3cbPRxWNeUqdCqvjh8OLQibYPetlgY3icg/132",nickname:"A༺简尚男装༻"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/bfLic3f9Uwv0EtU39EdAhH6pe9XPV1WydJw1uA6nAWiaPsibPibIwmEO1iaWdV0SL2fPg8Rq7RF20kjlG7WUo3VYbicA/132",nickname:"田园"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJVLyXeAOeAoEvbD1mNHMoUYG5fjiasDvjibnkGlzFwYTkiarjibfsb2qnubJqL9Eibica7SbVdaLwynhIA/132",nickname:"路人乙"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqpWPlbWmnbicrTMzUgOQ2WfKnIq8pCcH6e210xtMBicAaH4AHjMkz2P1ypOXDGqNWtg8kn9KkzLRhA/132",nickname:"梅"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/ymj2Grr595LMRSHwBHlpWs2QvNkdsNWWZtXsEOR50Hq2GF7IqPAibDB9AjHpiaIZdAqw8FsLiaic9JuB9Iuicia9ZIcQ/132",nickname:"贤哥"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83epnUKvPpDLVmcTbzCgFEUZE0Mr7egm6OHyOFLcaNmFVZV4fqmX8frFzoY9vUdb4W4E8GHlVS4C99g/132",nickname:"婷"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKf6NtCof06VqlxTuicyqZuQWLduMBicrnGONo7OmwpUPRT9df4Uc8Ef64Lpwk1Uf4gdDZu0s30bkRg/132",nickname:"Sunny珊"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/iasGyIKBSyvHnYBaPFrTosWGPHBNQlibadEK78eL01cw2ibr8ic59H5pbxf8twibby4sNyg5H3e159xUdTzDz8kdBfg/132",nickname:"高家伙场村卫生室"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/cRZxOm30JoGLcKCVH0KSsfd2vXwpRZ0ecJSf6SVQpv8OnkqqDOiciasseFsPNXq5sSfy3M2K7QuVTZ9CbKnwLOLQ/132",nickname:"小叶"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/WTicciam6DbWibb4sBf1PHykkETKbdeyFzSrvSPHjSBJxJrvHYa3kKUHVHb0q57XPVuM61k7NAsQgj2M8xvtNnBZA/132",nickname:"博博"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/VztmaOm4apm04Pl4l1PPnUiaCd3bKPw5pk6Me4Hjsw6jrZiacDib8A1WVqLFSogicJOgNmeCGIpqAtrVo4vY6g1PsQ/132",nickname:"陈艳"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/sIX0s1bh1avI8gibpDN50vjLBkW3LjgPaZnbE3FEUe0uHPwibcrIW4Y93cjgxjJt09OYBc24uO6LnA7Sla0HMf3Q/132",nickname:"妞妞"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/1cibwtFUwzsmcPoib3ibcx0aXsNjmiaKac2OibmUaNgZDlPm8yqKuD47KPcUsfniaPz5ibdpibmc8OIjPHn2jqZzKYct4Q/132",nickname:"吴风庆"},{headImage:"https://wx.qlogo.cn/mmopen/vi_32/aBibticRj7S6lAf7exEB9QiaibgZUqCdD7X2Eicgu4OVSIPibiaWcpv11ibX0Y5dR9zM56rwX0pJ9z1AZLbKRo0mO394ibg/132",nickname:"开心玉情"}],oe.luckboxProgressBar=[50,80],oe.luckboxVideoProgressBar=[88,100],oe.luckboxClickInterval=100,oe.luckboxFirstClick=.1,oe.luckboxContinueClick=.8,oe.jsonRes=[],oe.mainViewTips=!0,oe.skinTrialTips=!0,oe.ctrlInfo={isShare:0,isWudian:0,shareInfo:null,adInfo:null,isGoldeggs:!1,lateDelay:[1600,1400,1600,1600,1100,1100,1100,1100,1100,1100],isGoldeggsReward:1e3,adRefreshTimes:0,innerAD_delayed_time:12e4,adDelayedTime:3e4,fuhuoUiType:3,marqueeBntSwitch:0,btuMove:[],btuAppear:[],adCancelTolist:[],gameBackTolist:[],sp_marquee_bnt_switch:[0,0,0,0,0],eggs_config_list:[[0,0,0],[1,100,1],[2,200,1],[3,300,1],[4,400,1],[5,500,1]],randomRewardNum:50,randomRewardProbability:100},oe.systemInfo={},oe.bannerAdIds=["adunit-c75201b0ba20696e"],oe.rewardedAdIds=["adunit-4a8461f0cafe9d6b"],oe.interstitialIds=[""],oe.firstTimeOpenMainUI=!0,oe.wudian_level=[1,1,1,1,1,1],oe.resurgenceADId=1006,oe.ConvergeToMainUI=!1,oe.isReadyConfig=!1,oe.isRemoteConfig=!1,oe.adTimes=3e3,oe.appBanner=!0,oe.appBannerTimes=4e3,oe.bannerSwitch=[2,3,2,3,2,3,3,3,3,3,3,3],oe.reviveSwitch=[1,1,1],oe.inviteSwitch=[0,0,0,0,0,0,0,0,0,0,0,0],oe.luckboxSwitch=[0,0,0,0,0,0,0,0,0,0,0,0],oe.gamelistSwitch=[0,0,0,0,0,0,0,0,0,0,0,0],oe.gameboxSwitch=[0,0,0,0,1,0,0,0,0,0,0,0],oe.autoVideo=[0,0],oe.serverUrls={server:"https://source.danciby.cn/20200822/159808489576290791.json",config:"",configUrlsCount:1};var re,le=function(){function MyUtils(){_classCallCheck(this,MyUtils)}return _createClass(MyUtils,null,[{key:"isNull",value:function(e){return null==e||null==e||""==e}},{key:"random",value:function(e,t){var i=t-e,n=Math.random();return e+Math.round(n*i)}},{key:"RangeNumber",value:function(e,t){return e>t?-1:e==t?e:e+Math.random()*(t-e)}},{key:"compareVersion",value:function(e,t){e=e.split("."),t=t.split(".");for(var i=Math.max(e.length,t.length);e.length<i;)e.push("0");for(;t.length<i;)t.push("0");for(var n=0;n<i;n++){var a=parseInt(e[n]),s=parseInt(t[n]);if(a>s)return 1;if(a<s)return-1}return 0}},{key:"autoScreenSize",value:function(e){if(Laya.Browser.onMiniGame){var t=oe.systemInfo,i=20;20==t.statusBarHeight||(44==t.statusBarHeight||27==t.statusBarHeight||30==t.statusBarHeight?i+=70:24==t.statusBarHeight?i+=16:25==t.statusBarHeight?i+=64:32==t.statusBarHeight?i+=48:33==t.statusBarHeight?i+=64:35==t.statusBarHeight?i+=80:43==t.statusBarHeight&&(i+=90)),e.forEach(function(e){e.y=i+e.height/2})}}},{key:"scoreConversion",value:function(e){for(var t=null,i=Math.round(e),n=i.toString(),a=[1e12,1e9,1e6,1e3],s=0;s<a.length;s++){var o=Math.floor(i/a[s]);if(o>=1){t=s,n=o.toString();break}}for(var r=/(\d+)(\d{3})/;r.test(n);)n=n.replace(r,"$1,$2");return{value:n.toLocaleString(),isK:t}}},{key:"randomSipArray",value:function(e,t){if(e.length<t)return console.log("数组长度不够"),null;if(e.length==t){for(var i=[],n=0;n<e.length;n++)i.push(e[n]);return i}for(var a=[],s=0;s<e.length;s++)a.push(s);for(var o=[],r=0;r<t;r++){var l=this.random(0,a.length-1),h=a[l];a.splice(l,1),o.push(e[h])}return o}},{key:"RotationEulerY",value:function(e){var t=0,i=e.x,n=e.z,a=Math.abs(180*Math.tan(i/n)/Math.PI);return 0==i&&n>0?t=0:i>0&&n>0?t=a:i>0&&0==n?t=90:i>0&&n<0?t=180-a:0==i&&n<0?t=180:i<0&&n<0?t=180+a:i<0&&0==n?t=270:i<0&&n>0&&(t=360-a),t}},{key:"lookAtTargetPosQuaternion",value:function(e,t){var i=new Laya.Vector3(0,0,0);Laya.Vector3.subtract(e.position.clone(),t.clone(),i);var n=new Laya.Vector3(0,0,0);e.getForward(n);var a=Laya.Vector3.dot(i,n)/(Laya.Vector3.scalarLength(i)*Laya.Vector3.scalarLength(n));a=a>1?1:a<-1?-1:a;var s=Math.acos(a);e.position.x>t.x&&(s*=-1);var o=new Laya.Vector3;Laya.Vector3.cross(i,n,o);var r=new Laya.Quaternion;return Laya.Quaternion.createFromAxisAngle(new Laya.Vector3(0,1,0),s,r),r}},{key:"getAngle",value:function(e,t){var i=new Laya.Vector3(0,0,0);Laya.Vector3.subtract(e.position.clone(),t.clone(),i);var n=new Laya.Vector3(0,0,0);e.getForward(n);var a=Laya.Vector3.dot(i,n)/(Laya.Vector3.scalarLength(i)*Laya.Vector3.scalarLength(n));a=a>1?1:a<-1?-1:a;var s=Math.acos(a);return e.position.x>t.x&&(s*=-1),s}},{key:"getRadian",value:function(e){return Math.PI/180*e}},{key:"CheckCircleAndRectCollider",value:function(e,t,i,n,a){var s=new Laya.Vector2(Math.abs(e.x-i.x),Math.abs(e.z-i.z)),o=new Laya.Vector2(n/2,a/2),r=s.x-o.x;r=r<0?0:r;var l=s.y-o.y;l=l<0?0:l;var h=new Laya.Vector2(r,l);return Laya.Vector2.dot(h,h)<=t*t}},{key:"ServerNow",value:function(){return o.loginTime+Math.floor((Date.now()-o.loginLocalTime)/1e3)}},{key:"CountdownTime",value:function(e){e<0&&(e=0);var t=Math.floor(e/86400),i=Math.floor(e/3600)%24,n=Math.floor(e/60)%60,a=Math.floor(e)%60,s="";if(t>0)s=t+"天"+i+"小时";else if(i>0){s=(i<10?"0"+i:i)+":"+(n<10?"0"+n:n)+":"+(a<10?"0"+a:a)}else{s=(n<10?"0"+n:n)+":"+(a<10?"0"+a:a)}return s}},{key:"GetRangeAxisPos",value:function(e){if(!e||""==e)return 0;var t=e.split(",");return t.length>=2?this.RangeNumber(Number(t[0]),Number(t[1])):Number(t)}}]),MyUtils}(),he=function(e){function cionAni(){var e;return _classCallCheck(this,cionAni),(e=_possibleConstructorReturn(this,_getPrototypeOf(cionAni).call(this))).M_left=0,e.M_right=0,e.L_OR_R=!1,e.zuoyou=!1,e.Addcionain=new Laya.Tween,e.Addcionain1=new Laya.Tween,e.shezhi_thefish(),e}return _inherits(cionAni,Laya.Image),_createClass(cionAni,[{key:"shezhi_thefish",value:function(){this.skin="common/jinbi@2x.png",this.anchorX=.5,this.anchorY=.5,this.rotation=0,this.alpha=1}},{key:"Initialize",value:function(){this.x=300,this.y=640,this.rotation=0,this.alpha=1}},{key:"Random_Int",value:function(e,t){var i=t-e,n=Math.random();return e+Math.round(n*i)}},{key:"OVERhuoquAIn",value:function(e,t,i){var n=this;this.Addcionain.complete(),this.Addcionain1.complete(),this.visible=!1,this.scale(1,1);var a=this.Random_Int(t.x-110,t.x+110),s=this.Random_Int(t.y-100,t.y+100);this.pos(a,s),this.scale(0,0),this.rotation=0,this.visible=!0,this.Addcionain1.to(this,{rotation:360},200,null,Laya.Handler.create(this,function(){n.Addcionain.to(n,{scaleX:2,scaleY:2},100,null,Laya.Handler.create(n,function(){n.Addcionain.to(n,{x:i.x,y:i.y,scaleX:1,scaleY:1,rotation:720},300,null,Laya.Handler.create(n,function(){n.visible=!1,n.rotation=0,n.scale(1,1),n.pos(300,640),n.removeSelf(),Laya.Pool.recover("CONINAIN",n),X.instance.playSound("gold")}))}))})),this.Addcionain.to(this,{scaleX:2.2,scaleY:2.2},200,null,Laya.Handler.create(this,function(){}))}}]),cionAni}(),ce=function(e){function BaseView(){var e;return _classCallCheck(this,BaseView),(e=_possibleConstructorReturn(this,_getPrototypeOf(BaseView).apply(this,arguments))).isMyBaseView=!0,e.offset={y:0},e._speed=1,e}return _inherits(BaseView,Laya.Script),_createClass(BaseView,[{key:"onAwake",value:function(){this.owner.autoDestroyAtClosed=!0,this.owner.height=Laya.stage.height,this.addMinProgram=this.owner.getChildByName("addMinProgram"),this.okBtn=this.owner.getChildByName("okBtn"),this.closeBtn=this.owner.getChildByName("closeBtn"),this.homeBtn=this.owner.getChildByName("homeBtn"),this.shareBtn=this.owner.getChildByName("shareBtn"),this.addMinProgram&&(this.addMinProgram.anchorY=.5,le.autoScreenSize([this.addMinProgram]),this._minX=Laya.stage.width/2-20,this._maxX=Laya.stage.width/2+20),this.offset=$.callAPIMethodByProxy("getOffsetOpenDomain")||this.offset}},{key:"onEnable",value:function(){this.addEvent()}},{key:"onDestroy",value:function(){this.onDisable()}},{key:"onDisable",value:function(){this.removeEvent()}},{key:"openView",value:function(e){this.owner.visible=!0,this.owner.height=Laya.stage.height,this._data=e||{}}},{key:"addEvent",value:function(){var e=this;this.addMinProgram&&(this._speed=-1,Laya.timer.frameLoop(1,this,function(){e.addMinProgram.x+=e._speed,e.addMinProgram.x<=e._minX?(e._speed=1,e.addMinProgram.x=e._minX):e.addMinProgram.x>=e._maxX&&(e._speed=-1,e.addMinProgram.x=e._maxX)}))}},{key:"removeEvent",value:function(){this._isClick=null,this.addMinProgram&&Laya.timer.clearAll(this.addMinProgram),Laya.timer.clearAll(this)}},{key:"closeView",value:function(e){if(this.owner){var t=this.owner.url;e&&e.notDestroy?q.instance.hideView(t):q.instance.closeView(t),"Rank.scene"==t&&$.callAPIMethodByProxy("setAuthorizationCheck",!0),this._data&&this._data.callback&&this._data.callback(e),this._data=null}}},{key:"tweenAniDown",value:function(e,t,i,n){var a=this;Laya.Tween.to(e,t,n,null,Laya.Handler.create(this,function(){a.tweenAniUp(e,t,i,n)}))}},{key:"tweenAniUp",value:function(e,t,i,n){var a=this;Laya.Tween.to(e,i,n,null,Laya.Handler.create(this,function(){a.tweenAniDown(e,t,i,n)}))}},{key:"OneCoinFlyAni",value:function(e,t,i){if(this.owner){var n=Laya.Pool.getItem("CONINAIN");if(null==n){var a=void 0;a=new he,this.owner.addChild(a),a.OVERhuoquAIn(e,t,i)}else{var s=void 0;s=n,this.owner.addChild(s),s.OVERhuoquAIn(e,t,i)}}}}]),BaseView}();!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(re||(re={}));var ue,de=function(e){function ConvergeAdListLoop(){var e;return _classCallCheck(this,ConvergeAdListLoop),(e=_possibleConstructorReturn(this,_getPrototypeOf(ConvergeAdListLoop).call(this))).moveSpeed=.5,e.noMove=!0,e._itemHeight=268,e._itemWidth=202,e._spaceX=17,e._spaceY=17,e._repeatX=0,e._repeatY=0,e.speedTime=500,e.viewWidth=638.5,e.viewHeight=769,e.imgWidth=202,e.imgHeight=268,e.labWidth=160,e.labHeight=30,e}return _inherits(ConvergeAdListLoop,Laya.Script),_createClass(ConvergeAdListLoop,[{key:"init",value:function(e){this.thisY=e.y}},{key:"start",value:function(e,t,i){var n=this;if(e&&!(e.length<=0)){this.owner.removeChildren(),this._cells=[],this.adInfos=e;var a=0,s=new ge;this.list=[];for(var o=this,r=function(){var e=o.adInfos[l],i=n._cells.length*(n._itemHeight+n._spaceY),r=new Laya.Image;r.pos(a*(n._itemWidth+n._spaceX),i),n.owner.addChild(r),r.width=n._itemWidth,r.height=n._itemHeight;var h=new Laya.Image;r.addChild(h),h.skin="aggregation/ad_bg02.png",h.pos(0,0),h.width=n._itemWidth,h.height=n._itemHeight;var c=new Laya.Image;r.addChild(c),c.pos(0,0),c.skin=e.param,c.width=n.imgWidth,c.height=n.imgHeight,c.on(Laya.Event.MOUSE_DOWN,n,function(){o.startTime=Laya.timer.currTimer}),c.name=l.toString(),c.on(Laya.Event.MOUSE_UP,n,function(){var e=Number(c.name),i=o.adInfos[e];Laya.timer.currTimer-o.startTime<=200&&o.tiaozhuang(i,t),o.startTime=Laya.timer.currTimer}),a++,s._posY=i,s._cells.push(r),a>2&&(n._cells.push(s),a=0,s=new ge),n.list.push(r)},l=0;l<o.adInfos.length;l++)r();0!=a&&this._cells.push(s),this.fristPosY=0,this.endPosY=this.viewHeight-this._itemHeight,this.setDirtion(re.DOWN),this._mouseDown=!1,this.noMove=this._cells[this._cells.length-1].getPosY()<=this.endPosY,this.autoMove(),this.owner.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),this.owner.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.owner.on(Laya.Event.MOUSE_OUT,this,this.mouseOut),this.owner.on(Laya.Event.FOCUS_CHANGE,this,this.mouseUp)}}},{key:"autoMove",value:function(){var e=this;this.noMove||(Laya.timer.clearAll(this),Laya.timer.loop(10,this,function(){e.move()}))}},{key:"move",value:function(){this._mouseDown||this.upMove(-.5)}},{key:"upMove",value:function(e){for(var t=this._itemHeight+this._spaceY,i=this._itemWidth+this._spaceX,n=0,a=this.list.length,s=0;s<a;s++){var o=this.list[s],r=o.y;o.y=r+e,o.y<this.fristPosY-t&&n++}var l=0,h=0;a>0&&(l=this.list[a-1].y,h=2);a>1&&(this.list[a-2].y==l&&(h=1));a>2&&(this.list[a-3].y==l&&(h=0));for(var c=0;n>0;){n--;var u=this.list.shift();u&&(2==h?(h--,u.pos(i,l)):1==h?(h--,u.pos(2*i,l)):0==h&&(u.pos(i*c,l+(this._itemHeight+this._spaceY)),c++),this.list.push(u))}}},{key:"downMove",value:function(e){this._itemHeight,this._spaceY;for(var t=this._itemWidth+this._spaceX,i=0,n=this.list.length,a=0;a<n;a++){var s=this.list[a],o=s.y;s.y=o+e,s.y>=this.viewHeight&&i++}var r=0,l=0;n>0&&(r=this.list[0].y,l=2);n>1&&(this.list[1].y==r&&(l=1));n>2&&(this.list[2].y==r&&(l=0));for(var h=2;i>0;){i--;var c=this.list.pop();c&&(2==l?(l--,c.pos(t,r)):1==l?(l--,c.pos(0,r)):0==l&&(c.pos(t*h,r-(this._itemHeight+this._spaceY)),h--),this.list.unshift(c))}}},{key:"setDirtion",value:function(e){this.moveDirection=e,this.moveDirection==re.DOWN?this.moveSpeed=.5:this.moveSpeed=-.5}},{key:"tiaozhuang",value:function(e,t,i){var n={my_uuid:t,to_appid:e.appid,appid:e.appid,toLinks:e.toLinks,callback:function(){Z.ald(i+"广告位跳出成功",{path:e.toLinks,appId:e.appid,position:e.position})}};Z.ald(i+"广告位跳出",{path:e.toLinks,appId:e.appid,position:e.position}),$.callAPIMethodByProxy("navigateToMiniProgram",n)}},{key:"mouseDown",value:function(){Laya.timer.clearAll(this),this._mouseDown=!0,this._mouseY=Laya.MouseManager.instance.mouseX}},{key:"mouseMove",value:function(){if(!this.noMove&&this._mouseDown){var e=Laya.MouseManager.instance.mouseY-this._mouseY;e=e>30?30:e<-30?-30:e,this._mouseY=Laya.MouseManager.instance.mouseY,e<0?this.upMove(e):e>0&&this.downMove(e)}}},{key:"mouseOut",value:function(e){Laya.MouseManager.instance.mouseY>this.thisY||this.mouseUp()}},{key:"mouseUp",value:function(){this._mouseDown=!1,this._mouseY=0,this.autoMove()}}]),ConvergeAdListLoop}(),ge=function(){function MyRow(){_classCallCheck(this,MyRow),this._cells=[],this._posY=0}return _createClass(MyRow,[{key:"setPosY",value:function(e){for(var t=0;t<this._cells.length;t++){var i=this._cells[t],n=i.x;i.pos(n,e)}this._posY=e}},{key:"getPosY",value:function(){return this._posY}}]),MyRow}();!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(ue||(ue={}));var me,fe=function(e){function AdListLoop(){var e;return _classCallCheck(this,AdListLoop),(e=_possibleConstructorReturn(this,_getPrototypeOf(AdListLoop).call(this)))._spaceX=8,e.speedTime=500,e.itemWidth=136,e}return _inherits(AdListLoop,Laya.Script),_createClass(AdListLoop,[{key:"init",value:function(e){this._cellWidth=e._cellWidth||136,this._spaceX=e._spaceX||8,this.speedTime=e.speedTime||500,this._cellHeight=e._cellHeight||162}},{key:"start",value:function(e,t,i){var n=this;if(e&&!(e.length<=0)){var a=this;this.owner.removeChildren(),this._cells=[];var s=e.length>4;this.posY=0;for(var o=function(){l=e[r];var o=new Laya.Image,h=new Laya.Image;n.owner.addChild(o);var c=new Laya.Text;o.addChild(h),s?o.pos((r-1)*(n._cellWidth+n._spaceX),n.posY):o.pos(r*(n._cellWidth+n._spaceX),n.posY),h.skin=l.param,h.width=n._cellWidth,h.height=n._cellHeight,o.width=n._cellWidth,o.height=140,c.text=l.name,c.y=118,c.text=l.name,c.width=n._cellWidth,c.height=24,c.fontSize=24,c.color="#4A4A4A",c.align="center",c.valign="middle",c.zOrder=10;var u=r;o.on(Laya.Event.MOUSE_DOWN,n,function(){a.startTime=Laya.timer.currTimer}),o.on(Laya.Event.MOUSE_UP,n,function(){Laya.timer.currTimer-a.startTime<=200&&a.tiaozhuang(e[u],t,i),a.startTime=Laya.timer.currTimer}),n._cells.push(o)},r=0;r<e.length;r++){var l;o()}this.fristPosX=this._cells[0].x,this.endPosX=this._cells[this._cells.length-1].x,this.moveDirection=ue.RIGHT,this._mouseDown=!1,this.autoMove(),this.owner.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.owner.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),this.owner.on(Laya.Event.MOUSE_OUT,this,this.mouseUp)}}},{key:"tiaozhuang",value:function(e,t,i){var n={my_uuid:t,to_appid:e.appid,appid:e.appid,toLinks:e.toLinks,callback:function(){Z.ald(i+"广告位跳出成功",{path:e.toLinks,appId:e.appid,position:e.position})}};Z.ald(i+"广告位跳出",{path:e.toLinks,appId:e.appid,position:e.position}),$.callAPIMethodByProxy("navigateToMiniProgram",n)}},{key:"autoMove",value:function(){this._cells.length<=4||(Laya.timer.clearAll(this),Laya.timer.loop(10,this,function(){this.move()}))}},{key:"move",value:function(){for(var e=-(this._cells[0].x-this.fristPosX),t=(Math.abs(this.speedTime/(this._cellWidth+this._spaceX)*e),0);t<this._cells.length;t++){var i=this._cells[t];i.pos(i.x-.5,this.posY)}this._cells[this._cells.length-1].x>this.endPosX&&this.endMoveToFrist(),this._cells[0].x<this.fristPosX&&this.firstMoveToEnd()}},{key:"firstMoveToEnd",value:function(){var e=this._cells[this._cells.length-1],t=this._cells.shift();t.pos(e.x+this._cellWidth+this._spaceX,this.posY),this._cells.push(t)}},{key:"endMoveToFrist",value:function(){var e=this._cells[0],t=this._cells.pop(),i=e.x-this._cellWidth-this._spaceX;t.pos(i,e.y),this._cells.unshift(t)}},{key:"mouseDown",value:function(){this._mouseDown=!0,Laya.timer.clearAll(this),this._mouseX=this._mouseX=Laya.MouseManager.instance.mouseX,Laya.timer.clearAll(this);for(var e=0;e<this._cells.length;e++){var t=this._cells[e];Laya.Tween.clearAll(t)}}},{key:"mouseMove",value:function(){if(this._mouseDown){var e=Laya.MouseManager.instance.mouseX-this._mouseX;this._mouseX=Laya.MouseManager.instance.mouseX;for(var t=0;t<this._cells.length;t++){var i=this._cells[t];i.pos(i.x+e,this.posY)}this._cells[this._cells.length-1].x>this.endPosX&&this.endMoveToFrist(),this._cells[0].x<this.fristPosX&&this.firstMoveToEnd()}}},{key:"mouseUp",value:function(e){this._mouseDown=!1,this.autoMove()}}]),AdListLoop}(),ye=function(e){function ConvergeAd(){var e;return _classCallCheck(this,ConvergeAd),(e=_possibleConstructorReturn(this,_getPrototypeOf(ConvergeAd).apply(this,arguments))).appid="",e}return _inherits(ConvergeAd,ce),_createClass(ConvergeAd,[{key:"onAwake",value:function(){_get(_getPrototypeOf(ConvergeAd.prototype),"onAwake",this).call(this),le.autoScreenSize([this.homeBtn]),this.anchorS=this.owner.getChildByName("anchorS"),this.TopADPlane=this.anchorS.getChildByName("TopADPlane"),this.ADPlane=this.anchorS.getChildByName("ADPlane"),this.bgMask=this.ADPlane.mask,this.convergeAdListLoop=this.ADPlane.getComponent(de),this.adListLoop=this.TopADPlane.getComponent(fe),$.callAPIMethodByProxy("destoryAllBannerAd")}},{key:"addEvent",value:function(){_get(_getPrototypeOf(ConvergeAd.prototype),"addEvent",this).call(this),this.okBtn.on(Laya.Event.CLICK,this,this.okClick),this.homeBtn.on(Laya.Event.CLICK,this,this.onClickHome)}},{key:"removeEvent",value:function(){_get(_getPrototypeOf(ConvergeAd.prototype),"removeEvent",this).call(this),this.okBtn.off(Laya.Event.CLICK,this,this.okClick),this.homeBtn.off(Laya.Event.CLICK,this,this.onClickHome)}},{key:"openView",value:function(e){var t=this;_get(_getPrototypeOf(ConvergeAd.prototype),"openView",this).call(this,e),$.callAPIMethodByProxy("destoryAllBannerAd"),1==oe.inviteSwitch[5]&&h.instance.emit("openFriendInvite"),1==oe.luckboxSwitch[5]&&oe.ctrlInfo.isWudian&&h.instance.emit("openGoldenEggView"),1==oe.gameboxSwitch[5]&&h.instance.emit("openGameBox"),this.homeBtn.visible=!1,Laya.timer.once(1e3,this,function(){t&&t.homeBtn&&(t.homeBtn.visible=!0)});var i=Laya.stage.height/2-Math.abs(this.ADPlane.y),n=Laya.stage.height-i;this.convergeAdListLoop.init({viewHeight:n,y:i}),this.convergeAdListLoop.start(oe.getAdData(120001),120001,"聚合界面下部列表广告"),Laya.timer.frameOnce(2,this,function(){t.adListLoop.init({_spaceX:8,_isLabel:!0}),t.adListLoop.start(oe.getAdData(110001),110001,"聚合界面上部跑马灯广告")})}},{key:"onClickHome",value:function(){this.closeView(),h.instance.emit(u)}},{key:"okClick",value:function(){this.closeView(),h.instance.emit(u),q.instance.getView("GameFighting.scene")||q.instance.getView("MainView.scene")||q.instance.getView("SkinTrial.scene")||(oe.ConvergeToMainUI=!0)}}]),ConvergeAd}();!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(me||(me={}));var ve,pe=function(e){function AdListLoop$1(){var e;return _classCallCheck(this,AdListLoop$1),(e=_possibleConstructorReturn(this,_getPrototypeOf(AdListLoop$1).call(this))).x=0,e.moveLeft=0,e.moveRight=0,e._isClick=!1,e._cellWidth=136,e._cellHeight=162,e._spaceX=17,e.speedTime=500,e.itemWidth=136,e}return _inherits(AdListLoop$1,Laya.Script),_createClass(AdListLoop$1,[{key:"init",value:function(e){this._cellWidth=e._cellWidth||136,this._spaceX=e._spaceX||17,this.speedTime=e.speedTime||500,this._cellHeight=e._cellHeight||162,this.x=this._cellWidth+this._spaceX,this.owner.removeChildren()}},{key:"start",value:function(e,t,i){var n=this;if(!le.isNull(e)){var a=this;this._cells=[];var s=e.length>4;this.posY=this.owner.height/2;for(var o=function(){l=e[r];var o=new Laya.Image;o.anchorX=.5,o.anchorY=.5;var h=new Laya.Image("mainview/tanhao.png");h.right=-10,h.top=-10,h.name="tanhao",h.visible=!1,o.addChild(h),n.owner.addChild(o),s?o.pos((r-1)*(n._cellWidth+n._spaceX)+n._cellWidth/2,n.posY):o.pos(r*(n._cellWidth+n._spaceX)+n._cellWidth/2,n.posY),o.skin=l.param,o.width=n._cellWidth,o.height=n._cellHeight;var c=r;o.on(Laya.Event.MOUSE_DOWN,n,function(){a.startTime=Laya.timer.currTimer}),o.on(Laya.Event.MOUSE_UP,n,function(){Laya.timer.currTimer-a.startTime<=200&&a.tiaozhuang(e[c],t,i),a.startTime=Laya.timer.currTimer}),n._cells.push(o),3==r&&(n._cells[r].getChildByName("tanhao").visible=!0,n._cells[r].scale(1.1,1.1))},r=0;r<e.length;r++){var l;o()}this.fristPosX=this._cells[1].x,this.endPosX=this._cells[this._cells.length-1].x,this.moveDirection=me.RIGHT,this._mouseDown=!1,this.autoMove(),this.owner.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.owner.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),this.owner.on(Laya.Event.MOUSE_OUT,this,this.mouseUp)}}},{key:"tiaozhuang",value:function(e,t,i){var n={my_uuid:t,to_appid:e.appid,appid:e.appid,toLinks:e.toLinks,callback:function(){Z.ald(i+"广告位跳出成功",{path:e.toLinks,appId:e.appid,position:e.position})}};Z.ald(i+"广告位跳出",{path:e.toLinks,appId:e.appid,position:e.position}),$.callAPIMethodByProxy("navigateToMiniProgram",n)}},{key:"autoMove",value:function(){this._cells.length<=4||(Laya.timer.clearAll(this),Laya.timer.loop(5e3,this,function(){this.move()}))}},{key:"move",value:function(){Laya.Tween.to(this.owner,{x:this.owner.x-this._cellWidth-this._spaceX},800,null,Laya.Handler.create(this,this.firstMoveToEnd));for(var e=0;e<this._cells.length;e++){this._cells[e];this._cells[e].getChildByName("tanhao").visible=!1,4==e&&(this._cells[e].getChildByName("tanhao").visible=!0,Laya.Tween.to(this._cells[e-1],{scaleX:1,scaleY:1},800),Laya.Tween.to(this._cells[e],{scaleX:1.1,scaleY:1.1},800))}}},{key:"firstMoveToEnd",value:function(){var e=this._cells[this._cells.length-1],t=this._cells.shift();t.pos(e.x+this._cellWidth+this._spaceX,this.posY),this._cells.push(t)}},{key:"endMoveToFrist",value:function(){var e=this._cells[0],t=this._cells.pop(),i=e.x-this._cellWidth-this._spaceX;t.pos(i,e.y),this._cells.unshift(t)}},{key:"mouseDown",value:function(){}},{key:"mouseMove",value:function(){}},{key:"mouseUp",value:function(e){}}]),AdListLoop$1}();!function(e){e.Scene="scene",e.Music="music"}(ve||(ve={}));var we,be=function(e){function ConvergeAdForMainView(){var e;return _classCallCheck(this,ConvergeAdForMainView),(e=_possibleConstructorReturn(this,_getPrototypeOf(ConvergeAdForMainView).apply(this,arguments))).waitSecondes=5,e.waitMusicLoopTimes=0,e.loadMusic=!1,e}return _inherits(ConvergeAdForMainView,ce),_createClass(ConvergeAdForMainView,[{key:"onAwake",value:function(){var e=this;_get(_getPrototypeOf(ConvergeAdForMainView.prototype),"onAwake",this).call(this),le.autoScreenSize([this.homeBtn]),this.anchorS=this.owner.getChildByName("anchorS"),this.TopADPlane=this.anchorS.getChildByName("TopADPlane"),this.ADPlane=this.anchorS.getChildByName("ADPlane"),this.typeLabel=this.anchorS.getChildByName("typeLabel"),this.secondLabel=this.anchorS.getChildByName("second"),this.secondLabel.text=this.waitSecondes+"",Laya.timer.loop(1e3,this,function(){e.waitSecondes--,e.waitSecondes>0?(e.secondLabel.text=e.waitSecondes+"",(e.type==ve.Scene&&ee.isLoad3DRes||e.type==ve.Music&&e.loadMusic)&&e.EnterGameFighting()):e.type==ve.Scene?(e.homeBtn.visible=!0,Laya.timer.clearAll(e)):e.type==ve.Music&&(e.waitMusicLoopTimes++,e.waitMusicLoopTimes>6?Y.Instance.BgmIsLoaded()||(Laya.loader.cancelLoadByUrl(Y.Instance.levelData.bgmAdress),X.instance.prepareLevelBGM("res/sound/0.mp3"),e.loadMusic=!0):(e.waitSecondes=5,e.secondLabel.text=e.waitSecondes+""),(e.loadMusic||Y.Instance.BgmIsLoaded())&&e.EnterGameFighting())}),this.bgMask=this.ADPlane.mask,this.convergeAdListLoop=this.ADPlane.getComponent(de),this.adListLoop=this.TopADPlane.getComponent(fe),$.callAPIMethodByProxy("destoryAllBannerAd")}},{key:"addEvent",value:function(){_get(_getPrototypeOf(ConvergeAdForMainView.prototype),"addEvent",this).call(this),this.homeBtn.on(Laya.Event.CLICK,this,this.onClickHome),h.instance.onEvent(I,this,this.EnterGameFighting)}},{key:"removeEvent",value:function(){_get(_getPrototypeOf(ConvergeAdForMainView.prototype),"removeEvent",this).call(this),this.homeBtn.off(Laya.Event.CLICK,this,this.onClickHome),h.instance.onOffEvent(I,this,this.EnterGameFighting)}},{key:"openView",value:function(e){var t=this;_get(_getPrototypeOf(ConvergeAdForMainView.prototype),"openView",this).call(this,e),this.type=e.type||"scene",this.action=e.action,$.callAPIMethodByProxy("destoryAllBannerAd"),this.loadMusic=!1,this.homeBtn.visible=!1,"music"==this.type?(this.typeLabel.text="正在加载关卡音乐",this.LoadLevelBgm()):this.typeLabel.text="正在加载游戏场景";var i=Laya.stage.height/2-Math.abs(this.ADPlane.y),n=Laya.stage.height-i;this.convergeAdListLoop.init({viewHeight:n,y:i}),this.convergeAdListLoop.start(oe.getAdData(120001),120001,"聚合界面下部列表广告"),Laya.timer.frameOnce(2,this,function(){t.adListLoop.init({_spaceX:8,_isLabel:!0}),t.adListLoop.start(oe.getAdData(110001),110001,"聚合界面上部跑马灯广告")})}},{key:"LoadLevelBgm",value:function(){var e=this;Y.Instance.BgmIsLoaded()||null!=Laya.loader.getRes(Y.Instance.levelData.bgmAdress)&&Y.Instance.SetBgmLoaded();if(Y.Instance.BgmIsLoaded())return this.loadMusic=!0,void X.instance.prepareLevelBGM(Y.Instance.levelData.bgmAdress);Laya.loader.load(Y.Instance.levelData.bgmAdress,Laya.Handler.create(this,function(t){e.onLoadBgmComplete(t)}),null,Laya.Loader.SOUND)}},{key:"onClickHome",value:function(){this.closeView(),h.instance.emit(u)}},{key:"onLoadBgmComplete",value:function(e){this.loadMusic=!0,null!=e?(Y.Instance.SetBgmLoaded(),X.instance.prepareLevelBGM(Y.Instance.levelData.bgmAdress),console.log("音乐加载界面完成加载")):X.instance.prepareLevelBGM("res/sound/0.mp3")}},{key:"EnterGameFighting",value:function(){Laya.timer.clearAll(this),this.closeView(),"startGame"==this.action&&h.instance.emit("openFighting")}}]),ConvergeAdForMainView}(),Le=function(e){function AppBannerAd(){var e;return _classCallCheck(this,AppBannerAd),(e=_possibleConstructorReturn(this,_getPrototypeOf(AppBannerAd).call(this))).bannerIndex=0,e}return _inherits(AppBannerAd,Laya.Script),_createClass(AppBannerAd,[{key:"init",value:function(e){}},{key:"start",value:function(e){var t=this;console.log("appbanner  id=",e),this.adId=e,this.bannerAd=oe.getAdData(e),this.bannerAd&&0!=this.bannerAd.length&&(this.bannerIndex=0,this.owner.visible=!0,this.owner.skin=this.bannerAd[this.bannerIndex].param,Laya.timer.loop(5e3,this,function(){t.bannerIndex++,t.bannerIndex==t.bannerAd.length&&(t.bannerIndex=0),t.owner.skin=t.bannerAd[t.bannerIndex].param}),this.owner.on(Laya.Event.CLICK,this,this.tiaozhuan))}},{key:"hideAppBanner",value:function(){this.owner.visible=!1}},{key:"tiaozhuan",value:function(){var e=this.bannerAd[this.bannerIndex],t={my_uuid:this.adId,to_appid:e.appid,appid:e.appid,toLinks:e.toLinks,callback:function(){Z.ald("结算页大图广告位跳出成功",{path:e.toLinks,appId:e.appid,position:e.position})}};Z.ald("结算页大图广告位跳出",{path:e.toLinks,appId:e.appid,position:e.position}),$.callAPIMethodByProxy("navigateToMiniProgram",t)}}]),AppBannerAd}(),ke=function(e){function FriendInvite(){return _classCallCheck(this,FriendInvite),_possibleConstructorReturn(this,_getPrototypeOf(FriendInvite).apply(this,arguments))}return _inherits(FriendInvite,ce),_createClass(FriendInvite,[{key:"onAwake",value:function(){_get(_getPrototypeOf(FriendInvite.prototype),"onAwake",this).call(this),this.appBanner=this.owner.getChildByName("appBanner").getComponent(Le),this.centerImg=this.owner.getChildByName("centerImg"),this.open=this.centerImg.getChildByName("open"),this.refuse=this.centerImg.getChildByName("refuse"),this.accept=this.centerImg.getChildByName("accept"),this.adPlane=this.owner.getChildByName("ADPanel").getChildByName("ADPanelBg").getComponent(pe)}},{key:"addEvent",value:function(){this.refuse.on(Laya.Event.CLICK,this,this.refuseFun),this.accept.on(Laya.Event.CLICK,this,this.acceptFun),h.instance.onEvent(v,this,this.showADPanel),_get(_getPrototypeOf(FriendInvite.prototype),"addEvent",this).call(this)}},{key:"removeEvent",value:function(){this.refuse.off(Laya.Event.CLICK,this,this.refuseFun),this.accept.off(Laya.Event.CLICK,this,this.acceptFun),h.instance.onOffEvent(v,this,this.showADPanel),_get(_getPrototypeOf(FriendInvite.prototype),"removeEvent",this).call(this)}},{key:"openView",value:function(e){if(_get(_getPrototypeOf(FriendInvite.prototype),"openView",this).call(this,e),$.callAPIMethodByProxy("destoryAllBannerAd"),this.ShowBanner(),1==oe.luckboxSwitch[8]&&oe.ctrlInfo.isWudian&&h.instance.emit("openGoldenEggView"),1==oe.gamelistSwitch[8]&&h.instance.emit("openConvergeAdNew"),1==oe.gameboxSwitch[8]&&h.instance.emit("openGameBox"),Laya.Browser.onMiniGame||this.close(),Laya.Browser.onMiniGame){if(this.clearWxOpen(),this.checkWxOpendata(),this.wxOpenData.width=540,this.wxOpenData.height=114,this.adInfo=oe.getAdData(130001),this.rand=le.randomSipArray(this.adInfo,1),null==this.rand||0==this.rand.length)return;var t=le.randomSipArray(oe.wordRankLst,1);Laya.Browser.window.wx.postMessage({type:"openFriendInvite",data:{gameName:this.rand[0].name,avatarUrl:t[0].headImage,nickname:t[0].nickname}})}}},{key:"refuseFun",value:function(){X.instance.playSound("button-small"),this.close()}},{key:"acceptFun",value:function(){var e=this;if(X.instance.playSound("button-small"),null!=this.rand&&0!=this.rand.length){var t={my_uuid:130001,to_appid:this.rand[0].appid,appid:this.rand[0].appid,toLinks:this.rand[0].toLinks,callback:function(){Z.ald("广告位跳出成功",{path:e.rand[0].toLinks,appId:e.rand[0].appid,position:e.rand[0].position})}};Z.ald("广告位跳出",{path:this.rand[0].toLinks,appId:this.rand[0].appid,position:this.rand[0].position}),this.close(),$.callAPIMethodByProxy("navigateToMiniProgram",t)}else this.close()}},{key:"checkWxOpendata",value:function(){null==this.wxOpenData&&(this.wxOpenData=new Laya.WXOpenDataViewer,this.open.addChild(this.wxOpenData))}},{key:"clearWxOpen",value:function(){null!=this.wxOpenData&&(this.open.removeChild(this.wxOpenData),this.wxOpenData.destroy(),this.wxOpenData=null)}},{key:"ShowBanner",value:function(){1==oe.bannerSwitch[8]?$.callAPIMethodByProxy("showBannerAdOnLineCoinReward")?this.hideADPanel():this.showADPanel():2==oe.bannerSwitch[8]?this.appBanner.start(40001):3==oe.bannerSwitch[8]&&this.showADPanel()}},{key:"showADPanel",value:function(){var e=this;null!=this.owner.getChildByName("ADPanel")&&(this.owner.getChildByName("ADPanel").visible=oe.getAdData(30001).length>0,Laya.timer.frameOnce(2,this,function(){e.adPlane.init({_cellWidth:136,_cellHeight:162,_spaceX:17}),e.adPlane.start(oe.getAdData(30001),30001,"首页")}))}},{key:"hideADPanel",value:function(){this.owner.getChildByName("ADPanel").visible=!1}},{key:"close",value:function(){Laya.Browser.onMiniGame&&Laya.Browser.window.wx.postMessage({type:"closeFriendInvite"}),$.callAPIMethodByProxy("destoryAllBannerAd"),h.instance.emit(u),_get(_getPrototypeOf(FriendInvite.prototype),"closeView",this).call(this)}}]),FriendInvite}();!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(we||(we={}));var _e,Ae=function(e){function MainAdListLoop(){var e;return _classCallCheck(this,MainAdListLoop),(e=_possibleConstructorReturn(this,_getPrototypeOf(MainAdListLoop).call(this))).moveSpeed=.5,e.noMove=!0,e.thisY=0,e._itemHeight=194,e._itemWidth=163,e._spaceX=42,e._spaceY=24,e._repeatX=0,e._repeatY=0,e.speedTime=500,e.viewHeight=758,e.imgWidth=163,e.imgHeight=194,e}return _inherits(MainAdListLoop,Laya.Script),_createClass(MainAdListLoop,[{key:"init",value:function(e){}},{key:"start",value:function(e,t,i){var n=this;if(e&&!(e.length<=0)){this.owner.removeChildren(),this._cells=[],this.adInfos=e;var a=0,s=new Ie;this.list=[];for(var o=this,r=function(){var e=o.adInfos[l],i=n._cells.length*(n._itemHeight+n._spaceY),r=new Laya.Image;r.pos(a*(n._itemWidth+n._spaceX),i),n.owner.addChild(r),r.width=n._itemWidth,r.height=n._itemHeight;var h=new Laya.Image;r.addChild(h),h.pos(0,0),h.skin=e.param,h.width=n.imgWidth,h.height=n.imgHeight,h.on(Laya.Event.MOUSE_DOWN,n,function(){o.startTime=Laya.timer.currTimer}),h.name=l.toString(),h.on(Laya.Event.MOUSE_UP,n,function(){var e=Number(h.name),i=o.adInfos[e];Laya.timer.currTimer-o.startTime<=200&&o.tiaozhuang(i,t),o.startTime=Laya.timer.currTimer}),a++,s._posY=i,s._cells.push(r),a>2&&(n._cells.push(s),a=0,s=new Ie),n.list.push(r)},l=0;l<o.adInfos.length;l++)r();0!=a&&this._cells.push(s),this.fristPosY=0,this.endPosY=this.viewHeight-this._itemHeight,this.setDirtion(we.DOWN),this._mouseDown=!1,this.noMove=this._cells[this._cells.length-1].getPosY()<=this.endPosY,this.autoMove(),this.owner.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),this.owner.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.owner.on(Laya.Event.MOUSE_OUT,this,this.mouseOut),this.owner.on(Laya.Event.FOCUS_CHANGE,this,this.mouseUp)}}},{key:"autoMove",value:function(){var e=this;this.noMove||(Laya.timer.clearAll(this),Laya.timer.loop(10,this,function(){e.move()}))}},{key:"move",value:function(){this._mouseDown||this.upMove(-.5)}},{key:"upMove",value:function(e){for(var t=this._itemHeight+this._spaceY,i=this._itemWidth+this._spaceX,n=0,a=this.list.length,s=0;s<a;s++){var o=this.list[s],r=o.y;o.y=r+e,o.y<this.fristPosY-t&&n++}var l=0,h=0;a>0&&(l=this.list[a-1].y,h=2);a>1&&(this.list[a-2].y==l&&(h=1));a>2&&(this.list[a-3].y==l&&(h=0));for(var c=0;n>0;){n--;var u=this.list.shift();u&&(2==h?(h--,u.pos(i,l)):1==h?(h--,u.pos(2*i,l)):0==h&&(u.pos(i*c,l+(this._itemHeight+this._spaceY)),c++),this.list.push(u))}}},{key:"downMove",value:function(e){this._itemHeight,this._spaceY;for(var t=this._itemWidth+this._spaceX,i=0,n=this.list.length,a=0;a<n;a++){var s=this.list[a],o=s.y;s.y=o+e,s.y>=this.viewHeight&&i++}var r=0,l=0;n>0&&(r=this.list[0].y,l=2);n>1&&(this.list[1].y==r&&(l=1));n>2&&(this.list[2].y==r&&(l=0));for(var h=2;i>0;){i--;var c=this.list.pop();c&&(2==l?(l--,c.pos(t,r)):1==l?(l--,c.pos(0,r)):0==l&&(c.pos(t*h,r-(this._itemHeight+this._spaceY)),h--),this.list.unshift(c))}}},{key:"setDirtion",value:function(e){this.moveDirection=e,this.moveDirection==we.DOWN?this.moveSpeed=.5:this.moveSpeed=-.5}},{key:"tiaozhuang",value:function(e,t,i){var n={my_uuid:t,to_appid:e.appid,appid:e.appid,toLinks:e.toLinks,callback:function(){Z.ald(i+"广告位跳出成功",{path:e.toLinks,appId:e.appid,position:e.position})}};Z.ald(i+"广告位跳出",{path:e.toLinks,appId:e.appid,position:e.position}),$.callAPIMethodByProxy("navigateToMiniProgram",n)}},{key:"mouseDown",value:function(){Laya.timer.clearAll(this),this._mouseDown=!0,this._mouseY=Laya.MouseManager.instance.mouseX}},{key:"mouseMove",value:function(){if(!this.noMove&&this._mouseDown){var e=Laya.MouseManager.instance.mouseY-this._mouseY;e=e>30?30:e<-30?-30:e,this._mouseY=Laya.MouseManager.instance.mouseY,e<0?this.upMove(e):e>0&&this.downMove(e)}}},{key:"mouseOut",value:function(e){Laya.MouseManager.instance.mouseY>this.thisY||this.mouseUp()}},{key:"mouseUp",value:function(){this._mouseDown=!1,this._mouseY=0,this.autoMove()}}]),MainAdListLoop}(),Ie=function(){function MyRow$1(){_classCallCheck(this,MyRow$1),this._cells=[],this._posY=0}return _createClass(MyRow$1,[{key:"setPosY",value:function(e){for(var t=0;t<this._cells.length;t++){var i=this._cells[t],n=i.x;i.pos(n,e)}this._posY=e}},{key:"getPosY",value:function(){return this._posY}}]),MyRow$1}(),Ce=function(e){function GameBox(){return _classCallCheck(this,GameBox),_possibleConstructorReturn(this,_getPrototypeOf(GameBox).apply(this,arguments))}return _inherits(GameBox,ce),_createClass(GameBox,[{key:"onAwake",value:function(){_get(_getPrototypeOf(GameBox.prototype),"onAwake",this).call(this),this.centerImg=this.owner.getChildByName("centerImg"),this.centerBg=this.centerImg.getChildByName("centerBg"),this.closeImg=this.centerBg.getChildByName("closeImg"),this.LeftAD=this.centerImg.getChildByName("LeftAD").getComponent(Ae)}},{key:"addEvent",value:function(){_get(_getPrototypeOf(GameBox.prototype),"addEvent",this).call(this),this.closeImg.on(Laya.Event.CLICK,this,this.closeBtnFun)}},{key:"removeEvent",value:function(){_get(_getPrototypeOf(GameBox.prototype),"removeEvent",this).call(this),this.closeImg.off(Laya.Event.CLICK,this,this.closeBtnFun)}},{key:"openView",value:function(e){_get(_getPrototypeOf(GameBox.prototype),"openView",this).call(this,e);var t=oe.getAdData(50001);this.LeftAD.start(t,50001),1==oe.luckboxSwitch[8]&&oe.ctrlInfo.isWudian&&h.instance.emit("openGoldenEggView"),1==oe.gamelistSwitch[8]&&h.instance.emit("openConvergeAdNew")}},{key:"closeBtnFun",value:function(){this.close()}},{key:"close",value:function(){_get(_getPrototypeOf(GameBox.prototype),"closeView",this).call(this)}}]),GameBox}(),Be=function(e){function MouseMgr(){return _classCallCheck(this,MouseMgr),_possibleConstructorReturn(this,_getPrototypeOf(MouseMgr).apply(this,arguments))}return _inherits(MouseMgr,Laya.Script),_createClass(MouseMgr,[{key:"onEnable",value:function(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.OnMyMouseDown),this.owner.on(Laya.Event.MOUSE_MOVE,this,this.OnMyMouseMove),this.owner.on(Laya.Event.MOUSE_UP,this,this.OnMyMouseUp)}},{key:"onDisable",value:function(){this.owner.off(Laya.Event.MOUSE_DOWN,this,this.OnMyMouseDown),this.owner.off(Laya.Event.MOUSE_MOVE,this,this.OnMyMouseMove),this.owner.off(Laya.Event.MOUSE_UP,this,this.OnMyMouseUp)}},{key:"OnMyMouseDown",value:function(){Y.Instance.gameStatus==z.Execute?(this.lastMouseX=Laya.MouseManager.instance.mouseX,this.startMouseX=Laya.MouseManager.instance.mouseX):Y.Instance.gameStatus==z.PassEmotion&&h.instance.emit(_)}},{key:"OnMyMouseMove",value:function(){if(Y.Instance.gameStatus==z.Execute&&!isNaN(this.lastMouseX)){var e=Laya.MouseManager.instance.mouseX-this.lastMouseX;this.lastMouseX=Laya.MouseManager.instance.mouseX;var t=2*e*4/(.5*Laya.stage.width);h.instance.emit(A,{moveX:t})}}},{key:"OnMyMouseUp",value:function(){this.lastMouseX=Number.NaN}}]),MouseMgr}(),Se=new(function(){function GameManager(){_classCallCheck(this,GameManager)}return _createClass(GameManager,[{key:"goHome",value:function(){Y.Instance.GameExit(),h.instance.emit("goHome"),X.instance.playBGM()}}]),GameManager}()),Pe=function(e){function GameFighting(){var e;return _classCallCheck(this,GameFighting),(e=_possibleConstructorReturn(this,_getPrototypeOf(GameFighting).apply(this,arguments))).endAngle=-90,e.lbl_bgmName_width=0,e.leftPlayer=1,e.isOpenSurpass=!1,e.showSettleTip=!1,e.isBuffEffect=!1,e.countDownCount=3,e}return _inherits(GameFighting,ce),_createClass(GameFighting,[{key:"onAwake",value:function(){_get(_getPrototypeOf(GameFighting.prototype),"onAwake",this).call(this),this.guideClickArea=this.owner.getChildByName("mouseArea").getChildByName("guideClickArea"),this.dragBeginnerGuide=this.owner.getChildByName("dragBeginnerGuide"),this.finger=this.dragBeginnerGuide.getChildByName("finger"),this.guideTop=this.dragBeginnerGuide.getChildByName("guideTop"),this.guideTop.centerY-=this.offset.y/2.5,this.progressNode=this.owner.getChildByName("progress"),this.progress=this.progressNode.getChildByName("progress"),this.lbl_level=this.progressNode.getChildByName("lbl_level"),this.leftPlayerTxt=this.progressNode.getChildByName("leftPlayerTxt"),this.endLevelBg=this.progressNode.getChildByName("img_2"),this.lbl_bgmName=this.progressNode.getChildByName("bgmGp").getChildByName("bgmNameTxt").getChildByName("lbl"),this.endAngle=-90,this.progressNode.visible=!1,this.dragBeginnerGuide.visible=!1,this.numberAddTxt=this.owner.getChildByName("numberAddTxt"),this.numberAddTxt.alpha=0,this.settleOperateTip=this.owner.getChildByName("settleOperateTip"),this.handTip=this.settleOperateTip.getChildByName("hand"),this.settleOperateTip.visible=!1,this.imgCountDown=this.owner.getChildByName("imgCountDown"),this.imgCountDown.visible=!1,this.buffingSkeleton=new Laya.Skeleton,this.buffingSkeleton.pos(45,45),this.buffingSkeleton.load("dragonBones/buffingEffect/eff_jineng.sk"),this.buffingSkeleton.visible=!1}},{key:"openView",value:function(e){_get(_getPrototypeOf(GameFighting.prototype),"openView",this).call(this,e),1==oe.inviteSwitch[9]&&h.instance.emit("openFriendInvite"),1==oe.luckboxSwitch[9]&&oe.ctrlInfo.isWudian&&h.instance.emit("openGoldenEggView"),1==oe.gamelistSwitch[9]&&h.instance.emit("openConvergeAdNew"),1==oe.gameboxSwitch[9]&&h.instance.emit("openGameBox"),this.lbl_bgmName.text=Y.Instance.levelData.bgmName+" -"+Y.Instance.levelData.bgmSinger,this.lbl_bgmName_width=this.lbl_bgmName.width,this.lbl_bgmName_width<=220?this.lbl_bgmName.x=(220-this.lbl_bgmName_width)/2:Laya.timer.frameLoop(1,this,this.moveBgmName),this._setLeftPlayerLayout(),this.isOpenSurpass=!1,oe.firstTimeOpenMainUI=!1,oe.beginnerGuide==ne.DRAGE&&(this.dragBeginnerGuide.visible=!0,this.fingerStartTime=Laya.timer.currTimer,Laya.timer.frameLoop(1,this,this.FigerAnim)),this.guideTop.visible=!e,e&&Y.Instance.GameRevive(),this.guideClickArea.on(Laya.Event.MOUSE_DOWN,this,this.mouseTouchFun,[e]),Laya.timer.frameLoop(5,this,this.updataProgress)}},{key:"mouseTouchFun",value:function(e){this.guideClickArea.off(Laya.Event.MOUSE_DOWN,this,this.mouseTouchFun),this.dragBeginnerGuide.visible=!1,Laya.timer.clear(this,this.FigerAnim),e?(Y.Instance.GameReviveStart(),this.prepareToStart()):o.isLogin?(X.instance.stopBGM(),this.countDownCount=3,this.imgCountDown.visible=!0,X.instance.playSound("djs-go"),Laya.timer.loop(500,this,this.countDown)):(h.instance.emit("openTip","正在获取用户信息,请稍等片刻..."),this.prepareToStart())}},{key:"prepareToStart",value:function(){this.imgCountDown.visible=!1,this.updateLevel(o.level),this.progressNode.visible=!0,Laya.timer.loop(t.deltaTime,this,this.updateBuffProgress)}},{key:"addEvent",value:function(){_get(_getPrototypeOf(GameFighting.prototype),"addEvent",this).call(this),h.instance.onEvent(w,this,this.PlayerState),h.instance.onEvent(b,this,this.PlayerCountChange)}},{key:"removeEvent",value:function(){_get(_getPrototypeOf(GameFighting.prototype),"removeEvent",this).call(this),h.instance.onOffEvent(w,this,this.PlayerState),h.instance.onOffEvent(b,this,this.PlayerCountChange),this.closeProvocationOther(),this.closeSurpassOther(),Laya.timer.clear(this,this.updataProgress)}},{key:"FigerAnim",value:function(){this.finger.x=475+485*(1-Math.abs((Laya.timer.currTimer-this.fingerStartTime)%2e3-1e3)/1e3)}},{key:"updataProgress",value:function(){var e=Y.Instance.moveDis/Y.Instance.endLen;e>=1&&(e=1,this.endLevelBg.skin="mainview/zhuye_level_bg1.png",Laya.timer.clear(this,this.updataProgress)),this.showSettleTip||Y.Instance.gameStatus!=z.PassEmotion||(this.showSettleTip=!0,this.showSettleOperateTip()),this.progress.width=290*e,this._updateNumAddTxtPos()}},{key:"updateBuffProgress",value:function(){Y.Instance.gameStatus==z.Execute?j.energy<1?(this.isBuffEffect&&(this.isBuffEffect=!1,this.imgBuff.skin="game/buff_charging.png",this.buffingSkeleton.visible=!1),this.endAngle=360*j.energy-90,this.updateBuffMask()):this.isBuffEffect?(this.endAngle=360*(1-(Laya.timer.currTimer-j.buffStartTime)/o.buffKeepTime)-90,this.updateBuffMask()):(this.isBuffEffect=!0,this.imgBuff.skin="game/buff_wudi.png",this.buffingSkeleton.visible=!0,this.endAngle=270,this.updateBuffMask()):Laya.timer.clear(this,this.updateBuffProgress)}},{key:"updateBuffMask",value:function(){}},{key:"updateLevel",value:function(e){this.lbl_level.value=e.toString()}},{key:"showSettleOperateTip",value:function(){this.settleOperateTip.visible=!0,this.tweenAniDown(this.handTip,{scaleX:1.05,scaleY:1.05},{scaleX:.9,scaleY:.9},300)}},{key:"moveBgmName",value:function(){this.lbl_bgmName.x-=1,this.lbl_bgmName.x<-this.lbl_bgmName_width&&(this.lbl_bgmName.x=210)}},{key:"PlayerCountChange",value:function(e){if(this.leftPlayer+=e,this._setLeftPlayerLayout(),Y.Instance.gameStatus==z.Execute){this.numberAddTxt.text=e>0?"+1":"-1";var t=j.isInBuff?2:1;this.numberAddTxt.scale(t,t),Laya.Tween.clearAll(this.numberAddTxt),this.numberAddTxt.alpha=1,this._updateNumAddTxtPos(),Laya.Tween.to(this.numberAddTxt,{alpha:0},2e3)}}},{key:"_setLeftPlayerLayout",value:function(){for(var e=36*-this.leftPlayer/2,t=1;t<=6;t++){var i=this.progressNode.getChildByName("player"+t);t<=this.leftPlayer?(i.visible=!0,i.x=e+36*(this.leftPlayer-t)+18):i.visible=!1}}},{key:"_updateNumAddTxtPos",value:function(){if(this.numberAddTxt.alpha>0){var e=R.Instance.GetTopPlayer();if(e){var t=j.isInBuff?2.29:1.36,i=T.Instance.WorldToScreen2(O.AddV(e.obj.transform.localPosition,new Laya.Vector3(0,t,0)));this.numberAddTxt.pos(i.x,i.y)}}}},{key:"PlayerState",value:function(e){this.removeEvent(),e?Se.goHome():(o.lastUnlockLevel=o.level++,o.hasUnlock=!0,Se.goHome())}},{key:"countDown",value:function(){this.countDownCount--,this.countDownCount>0?this.imgCountDown.skin="game/"+this.countDownCount+".png":0==this.countDownCount?this.imgCountDown.skin="game/go.png":(Laya.timer.clear(this,this.countDown),Y.Instance.GameStart(),this.prepareToStart())}},{key:"openProvocationOther",value:function(e){this.closeSurpassOther(),this.provocationOther||(this.provocationOther=new Laya.WXOpenDataViewer,this.owner.addChild(this.provocationOther),this.provocationOther.width=750,this.provocationOther.height=62,this.provocationOther.pos(0,247)),$.callSubDomainMethodByProxy("setOpenView",this.provocationOther),$.callSubDomainMethodByProxy("openProvocationOther",{_type:e}),Laya.timer.once(3e3,this,function(){$.callSubDomainMethodByProxy("closeProvocationOther")})}},{key:"closeProvocationOther",value:function(){this.provocationOther&&(this.provocationOther.destroy(),this.provocationOther=null),$.callSubDomainMethodByProxy("closeProvocationOther")}},{key:"openSurpassOther",value:function(e){}},{key:"closeSurpassOther",value:function(){}}]),GameFighting}();!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(_e||(_e={}));var Me=function(e){function OverAdListLoop(){var e;return _classCallCheck(this,OverAdListLoop),(e=_possibleConstructorReturn(this,_getPrototypeOf(OverAdListLoop).call(this))).moveSpeed=.5,e._itemHeight=244,e._itemWidth=184,e._spaceX=14,e._spaceY=12,e._repeatX=3,e._repeatY=3,e.speedTime=500,e.viewHeight=500,e}return _inherits(OverAdListLoop,Laya.Script),_createClass(OverAdListLoop,[{key:"init",value:function(e){this._itemHeight=e._itemHeight||244,this._itemWidth=e._itemWidth||184,this._spaceX=e._spaceX||14,this._spaceY=e._spaceY||12,this.viewHeight=e.viewHeight||500}},{key:"start",value:function(e,t){var i=this;if(!le.isNull(e)){this.owner.removeChildren(),this._cells=[],this.adInfos=e;for(var n=0,a=new Ee,s=this,o=function(){var e=s.adInfos[r],o=new Laya.Image;i.owner.addChild(o);var l=i._cells.length*(i._itemHeight+i._spaceY);o.pos(n*(i._itemWidth+i._spaceX),l),o.skin=e.param,o.width=i._itemWidth,o.height=i._itemHeight,o.on(Laya.Event.MOUSE_DOWN,i,function(){s.startTime=Laya.timer.currTimer}),o.name=r.toString(),o.on(Laya.Event.MOUSE_UP,i,function(){var e=Number(o.name),i=s.adInfos[e];Laya.timer.currTimer-s.startTime<=200&&s.tiaozhuang(i,t),s.startTime=Laya.timer.currTimer}),n++,a._posY=l,a._cells.push(o),n>2&&(i._cells.push(a),n=0,a=new Ee)},r=0;r<s.adInfos.length;r++)o();0!=n&&this._cells.push(a),this.fristPosY=0,this.endPosY=this.viewHeight-this._itemHeight,this.setDirtion(_e.DOWN),this._mouseDown=!1,this.autoMove(),this.owner.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),this.owner.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.owner.on(Laya.Event.MOUSE_OUT,this,this.mouseUp),this.owner.on(Laya.Event.FOCUS_CHANGE,this,this.mouseUp)}}},{key:"autoMove",value:function(){var e=this;Laya.timer.clearAll(this),Laya.timer.loop(10,this,function(){e.move()})}},{key:"move",value:function(){for(var e=-(this._cells[0].getPosY()-this.fristPosY),t=(Math.abs(this.speedTime/(this._itemHeight+this._spaceY)*e),0);t<this._cells.length;t++){var i=this._cells[t];i.setPosY(i.getPosY()+this.moveSpeed)}this.moveDirection==_e.DOWN&&this._cells[0].getPosY()>this.fristPosY&&this.setDirtion(_e.UP),this.moveDirection==_e.UP&&this._cells[this._cells.length-1].getPosY()<this.endPosY&&this.setDirtion(_e.DOWN)}},{key:"setDirtion",value:function(e){this.moveDirection=e,this.moveDirection==_e.DOWN?this.moveSpeed=.5:this.moveSpeed=-.5}},{key:"tiaozhuang",value:function(e,t){var i={my_uuid:t,to_appid:e.appid,appid:e.appid,toLinks:e.toLinks,callback:function(){Z.ald("结算页广告位跳出成功",{path:e.toLinks,appId:e.appid,position:e.position})}};Z.ald("结算页广告位跳出",{path:e.toLinks,appId:e.appid,position:e.position}),$.callAPIMethodByProxy("navigateToMiniProgram",i)}},{key:"mouseDown",value:function(){Laya.timer.clearAll(this),this._mouseDown=!0,this._mouseY=Laya.MouseManager.instance.mouseX}},{key:"mouseMove",value:function(){if(this._mouseDown){var e=Laya.MouseManager.instance.mouseY-this._mouseY;e=e>30?30:e<-30?-30:e,this._mouseY=Laya.MouseManager.instance.mouseY,e>0&&this._cells[0].getPosY()+e>this.fristPosY&&(e=this.fristPosY-this._cells[0].getPosY()),e<0&&this._cells[this._cells.length-1].getPosY()+e<this.endPosY&&(e=this.endPosY-this._cells[this._cells.length-1].getPosY());for(var t=0;t<this._cells.length;t++){var i=this._cells[t];i.setPosY(i.getPosY()+e)}}}},{key:"mouseUp",value:function(e){this._mouseDown=!1,this._mouseY=0,this.autoMove()}}]),OverAdListLoop}(),Ee=function(){function MyRow$2(){_classCallCheck(this,MyRow$2),this._cells=[],this._posY=0}return _createClass(MyRow$2,[{key:"setPosY",value:function(e){for(var t=0;t<this._cells.length;t++){var i=this._cells[t],n=i.x;i.pos(n,e)}this._posY=e}},{key:"getPosY",value:function(){return this._posY}}]),MyRow$2}(),De=function(e){function GameOver(){var e;return _classCallCheck(this,GameOver),(e=_possibleConstructorReturn(this,_getPrototypeOf(GameOver).call(this))).imgHintY=0,e.isPass=!1,e.isLoadAD=!1,e}return _inherits(GameOver,ce),_createClass(GameOver,[{key:"onAwake",value:function(){_get(_getPrototypeOf(GameOver.prototype),"onAwake",this).call(this),this.appBanner=this.owner.getChildByName("appBanner").getComponent(Le);var e=this.owner.getChildByName("content"),t=e.getChildByName("btnAnchor");this.btnAnchor=t,this.btnNext=t.getChildByName("btnNext"),this.btnHome=t.getChildByName("btnHome"),this.btnAgain=t.getChildByName("btnAgain"),this.btnFight=t.getChildByName("btnFight");var i=e.getChildByName("levelPanel");this.passNum=i.getChildByName("passNum"),this.imgFail=i.getChildByName("imgFail"),this.imgPass=i.getChildByName("imgPass"),this.levePanel=i,this.imgFail.visible=!1,this.imgPass.visible=!1;var n=e.getChildByName("scorePanel");this.scorePanel=n,this.score=n.getChildByName("scoreNum");var a=e.getChildByName("ADPlane");this._overListLoop=a.getComponent(Me);var s=oe.getAdData(80001);this._overListLoop.init({_cellWidth:184,_cellHeight:184,_spaceX:14,_spaceY:14,viewHeight:382}),this._overListLoop.start(s,80001),this.ButtonADPanel=this.owner.getChildByName("ButtonADPanel"),this.ButtonAdListloop=this.ButtonADPanel.getChildByName("ADPanelBg").getComponent(pe),this.ButtonADPanel.y+=this.offset.y/2,this.img_hint=this.btnFight.getChildByName("img_hint"),this.inviteIconImg=this.img_hint.getChildByName("inviteIconImg"),this.yqwLab=this.img_hint.getChildByName("yqwLab"),this.inviteGoldLab=this.img_hint.getChildByName("inviteGoldLab"),this.imgHintY=this.img_hint.y,this.videoBtn=e.getChildByName("videoBtn"),this.jumpBtn=e.getChildByName("jumpBtn");var r=1==oe.ctrlInfo.inviteFriendsControl&&oe.ctrlInfo.inviteShareMaxCount>o.inviteShareCount;this.yqwLab.visible=!r,this.inviteIconImg.visible=r,this.inviteGoldLab.visible=r,this.imgHintY=this.img_hint.y,oe.ctrlInfo.mergeResurrectionSettlement?(this.btnAnchor.visible=!1,this.videoBtn.visible=!0,this.jumpBtn.visible=!0,e.centerY=-50,this.videoBtn.y+=this.offset.y/10,this.jumpBtn.y+=this.offset.y/5,this.jumpBtnY=this.jumpBtn.y):(this.btnAnchor.visible=!0,this.videoBtn.visible=!1,this.jumpBtn.visible=!1,e.centerY=0),$.callAPIMethodByProxy("destoryAllBannerAd")}},{key:"addEvent",value:function(){this.btnNext.on(Laya.Event.CLICK,this,this.goHome),this.btnHome.on(Laya.Event.CLICK,this,this.goHome),this.btnAgain.on(Laya.Event.CLICK,this,this.goFighting),this.btnFight.on(Laya.Event.CLICK,this,this.goShare,[0]),h.instance.onEvent(u,this,this.ListenShowBanner),h.instance.onEvent(y,this,this.showADPanel),this.videoBtn.on(Laya.Event.CLICK,this,this.videoClick),this.jumpBtn.on(Laya.Event.CLICK,this,this.jumpClick),_get(_getPrototypeOf(GameOver.prototype),"addEvent",this).call(this)}},{key:"removeEvent",value:function(){this.btnNext.off(Laya.Event.CLICK,this,this.goHome),this.btnHome.off(Laya.Event.CLICK,this,this.goHome),this.btnAgain.off(Laya.Event.CLICK,this,this.goFighting),this.btnFight.off(Laya.Event.CLICK,this,this.goShare),h.instance.onOffEvent(u,this,this.ListenShowBanner),h.instance.onOffEvent(y,this,this.showADPanel),this.videoBtn.off(Laya.Event.CLICK,this,this.videoClick),this.jumpBtn.off(Laya.Event.CLICK,this,this.jumpClick),_get(_getPrototypeOf(GameOver.prototype),"removeEvent",this).call(this)}},{key:"onEnable",value:function(){_get(_getPrototypeOf(GameOver.prototype),"onEnable",this).call(this),this.img_hint.y=this.imgHintY,Laya.Tween.clearTween(this.img_hint),this.tweenAniDown(this.img_hint,{y:this.img_hint.y+10},{y:this.img_hint.y},500)}},{key:"onDisable",value:function(){_get(_getPrototypeOf(GameOver.prototype),"onDisable",this).call(this),$.callAPIMethodByProxy("destoryAllBannerAd"),$.callAPIMethodByProxy("hideInterstitialAD")}},{key:"openView",value:function(e){var t=this;this.isPass=e.isPass,_get(_getPrototypeOf(GameOver.prototype),"openView",this).call(this,this.isPass),this.ShowBanner(),1==oe.inviteSwitch[3]&&h.instance.emit("openFriendInvite"),1==oe.luckboxSwitch[3]&&oe.ctrlInfo.isWudian&&h.instance.emit("openGoldenEggView"),1==oe.gamelistSwitch[3]&&h.instance.emit("openConvergeAdNew"),1==oe.gameboxSwitch[3]&&h.instance.emit("openGameBox"),this.scorePanel.visible=!1,this.levePanel.visible=!0,this.imgFail.visible=!this.isPass,this.imgPass.visible=this.isPass,this.btnNext.visible=this.isPass,this.btnAgain.visible=!this.isPass;var i=e.currLevel;this.passNum.value=i+"";var n=(i+"").length-1;if(this.passNum.x=26*n-52,oe.ctrlInfo.isWudian&&1==oe.wudian_level[3]){this.btnAnchor.visible=!1,Laya.timer.once(oe.ctrlInfo.btuAppear[3]+300,this,function(){t.btnAnchor.visible=!0});var a=le.random(560,590);this.btnAnchor.y=a,Laya.timer.once(oe.ctrlInfo.btuMove[3],this,function(){Laya.Tween.to(t.btnAnchor,{y:346},300,Laya.Ease.backOut)})}else this.btnAnchor.y=346,this.btnAnchor.visible=!0;$.callAPIMethodByProxy("showInterstitialAD")}},{key:"onRender",value:function(e,t){e.getChildAt(0).skin=this.adData[t].param}},{key:"onClickItem",value:function(e,t){if(e.type==Laya.Event.CLICK&&e.target instanceof Laya.Box){var i=e.target,n=this.adData[t],a={my_uuid:n.position,to_appid:n.appid,appid:n.appid,toLinks:n.toLinks,notShowAd:!0,callback:function(){Z.ald("结算页广告位跳出成功",{path:n.toLinks,appId:n.appid,position:n.position})}};if(Z.ald("结算页广告位跳出",{path:n.toLinks,appId:n.appid,position:n.position}),$.callAPIMethodByProxy("navigateToMiniProgram",a),this.adDataRandom.length>0){var s=i.getChildAt(0);this.adDataRandom.push(n),this.adData[t]=this.adDataRandom.shift(),s.skin=this.adData[t].param}}}},{key:"goFighting",value:function(){X.instance.playSound("button-small"),Y.Instance.GameRestart(),h.instance.emit("openFighting")}},{key:"goHome",value:function(){X.instance.playSound("button-small"),Y.Instance.GameExit(),1==oe.ctrlInfo.backHomeControl?h.instance.emit("openConvergeAdNew"):(h.instance.emit("goHome"),X.instance.playBGM())}},{key:"goShare",value:function(e){var t=this,i={caller:this,callback:function(e){e.success?(h.instance.emit("openTip","分享成功"),t.inviteGoldLab.visible&&(se.instance.shareCallback(t,function(){o.inviteShareCount>=oe.ctrlInfo.inviteShareMaxCount&&(t.yqwLab.visible=!0,t.inviteIconImg.visible=!1,t.inviteGoldLab.visible=!1)}),h.instance.emit("openTip","获得"+t.inviteGoldLab.text+"金币"))):$.callAPIMethodByProxy("ShareFileTip",function(e){e.confirm&&t.goShare(1)})},type:2,inviteType:e};o.isShare=!0,$.callAPIMethodByProxy("shareAppMessage",i)}},{key:"videoClick",value:function(){var e=this;this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),$.ptAPI?(this.isLoadAD=!0,Z.ald("立即复活--视频"),$.callAPIMethodByProxy("showVideo",{posID:202,_type:B.RESURGENCE,caller:this,callBackSuc:function(){e.openFighting(),e.isLoadAD=!1,Z.ald("立即复活成功--视频")},callBackFail:function(){h.instance.emit("openTip","看完视频才能复活"),e.isLoadAD=!1},callBackErro:function(){h.instance.emit("openTip","今日视频次数已用完"),e.isLoadAD=!1}})):this.openFighting())}},{key:"openFighting",value:function(){h.instance.emit("openFighting",!0)}},{key:"jumpClick",value:function(){var e=this;if(!this._isClick&&!this.isLoadAD){this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null});var t=Math.floor(Y.Instance.GameScore()*o.curMultiple);this.score.value=t.toString(),se.instance.Settlement(t),this.goHome()}}},{key:"nextLevelFunc",value:function(){X.instance.playSound("button-small"),Y.Instance.GameRestart(),Y.Instance.BgmIsLoaded()?h.instance.emit("openFighting"):h.instance.emit("openConvergeAdForMainView",{action:"startGame",type:"music"})}},{key:"ListenShowBanner",value:function(){var e=0;q.instance.getView("FriendInvite.scene")&&e++,q.instance.getView("ConvergeAdNew.scene")&&e++,q.instance.getView("GoldenEggView.scene")&&e++,e>1||this.ShowBanner()}},{key:"ShowBanner",value:function(){var e=this;1==oe.bannerSwitch[3]?$.callAPIMethodByProxy("showBannerAdGameOver")?this.hideADPanel():1==oe.ctrlInfo.isWudian&&1==oe.wudian_level[3]?Laya.timer.once(oe.ctrlInfo.lateDelay[3],this,function(){e.showADPanel()}):this.showADPanel():2==oe.bannerSwitch[3]?1==oe.ctrlInfo.isWudian&&1==oe.wudian_level[3]?Laya.timer.once(oe.ctrlInfo.lateDelay[3],this,function(){e.appBanner.start(40001)}):this.appBanner.start(40001):3==oe.bannerSwitch[3]&&(1==oe.ctrlInfo.isWudian&&1==oe.wudian_level[3]?Laya.timer.once(oe.ctrlInfo.lateDelay[3],this,function(){e.showADPanel()}):this.showADPanel())}},{key:"showADPanel",value:function(){var e=this;this.ButtonADPanel.visible=!0,Laya.timer.frameOnce(2,this,function(){e.ButtonAdListloop.init({_cellWidth:136,_cellHeight:162,_spaceX:17}),e.ButtonAdListloop.start(oe.getAdData(30001),30001,"结算页")})}},{key:"hideADPanel",value:function(){this.ButtonADPanel.visible=!1}}]),GameOver}(),Te=function(e){function PromotionAnimation(){var e;return _classCallCheck(this,PromotionAnimation),(e=_possibleConstructorReturn(this,_getPrototypeOf(PromotionAnimation).call(this))).isClick=!1,e.toLinks="",e.toAppId="",e.thePosition=1,e.nowidx=0,e.maxdix=0,e.isAnim=!0,e.isChange=!1,e.lastRand=0,e}return _inherits(PromotionAnimation,Laya.Script),_createClass(PromotionAnimation,[{key:"onAwake",value:function(){this.owner.on(Laya.Event.CLICK,this,this.jumpOtherGame)}},{key:"init",value:function(e){this.typeScene=e,this.adImg=this.owner.getChildByName("ADImg")}},{key:"start",value:function(e,t,i){Laya.Tween.clearAll(this);var n=oe.getAdData(i);!n||n.length<=0?this.owner.visible=!1:(this.owner.visible=!0,this.owner.rotation=0,this.owner.scale(1,1),this.isAnim=e,this.isChange=t,this.thePosition=i,this.nowidx=0,this.maxdix=n.length-1,this.randomAD(),this.isAnim&&this.adAnim(),Laya.timer.clearAll(this),this.startAnim())}},{key:"startAnim",value:function(){var e=this,t=oe.getAdData(this.thePosition);Laya.timer.loop(5e3,this,function(){null!=t?t.length>1&&e.isChange?e.changeAD():e.randomAD():e.isChange?e.changeAD():e.randomAD()})}},{key:"randomAD",value:function(){var e=oe.getAdData(this.thePosition);if(e){e.length;var t=le.random(0,this.maxdix);this.lastRand==t&&(t+=1)>this.maxdix&&(t=0),this.lastRand=t,this.nowidx=t,this.toAppId=e[this.nowidx].appid,this.toLinks=e[this.nowidx].toLinks,this.adImg?this.adImg.skin=e[this.nowidx].param:this.owner.skin=e[this.nowidx].param}}},{key:"changeAD",value:function(){var e=this,t=this.owner;t.scale(1,1),Laya.Tween.clearAll(t),Laya.Tween.to(t,{scaleX:0,scaleY:0},300,null,Laya.Handler.create(this,function(){e.randomAD(),Laya.Tween.to(t,{scaleX:0,scaleY:0},100,null,Laya.Handler.create(e,function(){Laya.Tween.to(t,{scaleX:1,scaleY:1},300,null,Laya.Handler.create(e,function(){e.adAnim()}))}))}))}},{key:"adAnim",value:function(){var e=this,t=this.owner;t.rotation=0,Laya.Tween.clearAll(t),Laya.Tween.to(t,{rotation:10},300,null,Laya.Handler.create(this,function(){Laya.Tween.to(t,{rotation:0},300,null,Laya.Handler.create(e,function(){Laya.Tween.to(t,{rotation:-10},300,null,Laya.Handler.create(e,function(){Laya.Tween.to(t,{rotation:0},300,null,Laya.Handler.create(e,function(){e.adAnim2()}))}))}))}))}},{key:"adAnim2",value:function(){var e=this,t=this.owner;t.rotation=0,Laya.Tween.to(t,{rotation:10},300,null,Laya.Handler.create(this,function(){Laya.Tween.to(t,{rotation:0},300,null,Laya.Handler.create(e,function(){Laya.Tween.to(t,{rotation:-10},300,null,Laya.Handler.create(e,function(){Laya.Tween.to(t,{rotation:0},300,null,Laya.Handler.create(e,function(){}))}))}))}))}},{key:"jumpOtherGame",value:function(){var e=this;if(Laya.Browser.onMiniGame){var t=this.toAppId;if(t){var i={my_uuid:this.thePosition,to_appid:t,appid:this.toAppId,toLinks:this.toLinks};console.log("开始跳转"),Z.ald("首页两侧广告位跳出",{path:this.toLinks,appId:this.toAppId,position:this.thePosition}),i.callback=function(){Z.ald("首页两侧广告位跳出成功",{path:e.toLinks,appId:e.toAppId,position:e.thePosition})},$.callAPIMethodByProxy("navigateToMiniProgram",i),Laya.timer.clearAll(this),Laya.Tween.clearAll(this.owner),this.adAnim(),this.changeAD(),this.startAnim()}else if(Laya.Browser.onMiniGame){var n={title:"跳转失败"};window.wx.showToast(n)}}else Laya.timer.clearAll(this),Laya.Tween.clearAll(this.owner),this.adAnim(),this.changeAD(),this.startAnim()}}]),PromotionAnimation}(),xe=function(e){function GoldenEggView(){var e;return _classCallCheck(this,GoldenEggView),(e=_possibleConstructorReturn(this,_getPrototypeOf(GoldenEggView).apply(this,arguments))).clickCount=0,e.isEnd=!1,e.isShowBanner=!1,e.spaceTime=0,e}return _inherits(GoldenEggView,ce),_createClass(GoldenEggView,[{key:"onAwake",value:function(){var e=this;_get(_getPrototypeOf(GoldenEggView.prototype),"onAwake",this).call(this),this.clickCount=0,this.progressNum=0,Laya.timer.frameLoop(25,this,function(){e.isEnd||null!=e&&null!=e&&(e.progressNum-=.06,e.updataProgress())}),this.appBanner=this.owner.getChildByName("appBanner").getComponent(Le),this.center=this.owner.getChildByName("center"),this.promotion1=this.center.getChildByName("adImage1"),this.promotion2=this.center.getChildByName("adImage2"),this.promotion3=this.center.getChildByName("adImage3"),this.promotion4=this.center.getChildByName("adImage4"),this.promotion5=this.center.getChildByName("adImage5"),this.promotion6=this.center.getChildByName("adImage6"),this.promotion1.getComponent(Te).start(!0,!0,90001),this.promotion2.getComponent(Te).start(!0,!0,90002),this.promotion3.getComponent(Te).start(!0,!0,90003),this.promotion4.getComponent(Te).start(!0,!0,100001),this.promotion5.getComponent(Te).start(!0,!0,100002),this.promotion6.getComponent(Te).start(!0,!0,100003),this.centerImg=this.owner.getChildByName("centerImg"),this.anchor=this.owner.getChildByName("anchor"),this.anchor.y=this.anchor.y+this.offset.y/2,this.okBtn=this.anchor.getChildByName("btnClick"),this.iconClose=this.centerImg.getChildByName("iconClose"),this.iconOpen=this.centerImg.getChildByName("iconOpen"),this.closeBtn=this.owner.getChildByName("closeBtn"),this.bar=this.iconClose.getChildByName("bar"),this.btnJump=this.anchor.getChildByName("btnJump"),this.btnVideo=this.anchor.getChildByName("btnVideo"),this.btnReceive=this.anchor.getChildByName("btnReceive"),this.adPlane=this.owner.getChildByName("ADPanel").getChildByName("ADPanelBg").getComponent(pe),this.centerImg.y=this.centerImg.y+this.offset.y/2}},{key:"addEvent",value:function(){this.okBtn.on(Laya.Event.CLICK,this,this.btnClick),this.closeBtn.on(Laya.Event.CLICK,this,this.closeView),this.btnVideo.on(Laya.Event.CLICK,this,this.videoReceiveClick),this.btnReceive.on(Laya.Event.CLICK,this,this.receiveClick),this.btnJump.on(Laya.Event.CLICK,this,this.close),h.instance.onEvent(p,this,this.showADPanel),_get(_getPrototypeOf(GoldenEggView.prototype),"addEvent",this).call(this)}},{key:"removeEvent",value:function(){this.okBtn.off(Laya.Event.CLICK,this,this.btnClick),this.closeBtn.off(Laya.Event.CLICK,this,this.closeView),this.btnVideo.off(Laya.Event.CLICK,this,this.videoReceiveClick),this.btnReceive.off(Laya.Event.CLICK,this,this.receiveClick),this.btnJump.off(Laya.Event.CLICK,this,this.close),h.instance.onOffEvent(p,this,this.showADPanel),_get(_getPrototypeOf(GoldenEggView.prototype),"removeEvent",this).call(this)}},{key:"openView",value:function(e){var t=this;_get(_getPrototypeOf(GoldenEggView.prototype),"openView",this).call(this,e),e&&e.isAutoOpen&&(this.isAutoOpen=e.isAutoOpen),$.callAPIMethodByProxy("destoryAllBannerAd"),1==oe.inviteSwitch[7]&&h.instance.emit("openFriendInvite"),1==oe.gamelistSwitch[7]&&h.instance.emit("openConvergeAdNew"),1==oe.gameboxSwitch[7]&&h.instance.emit("openGameBox"),this.rand=le.random(Number(oe.luckboxProgressBar[0]),Number(oe.luckboxProgressBar[1]))/100,this.rand2=le.random(Number(oe.luckboxVideoProgressBar[0]),Number(oe.luckboxVideoProgressBar[1]))/100,console.log(this.rand,this.rand2),oe.ctrlInfo.isWudian&&1==oe.wudian_level[7]?(this.btnJump.alpha=0,this.anchor.y=0+this.offset.y,Laya.timer.once(oe.ctrlInfo.btuAppear[7],this,function(){Laya.Tween.to(t.btnJump,{alpha:1},300)})):this.anchor.y=this.offset.y/2-280}},{key:"btnClick",value:function(){var e=this,t=Date.now();return t-this.spaceTime>oe.luckboxClickInterval?this.progressNum+=oe.luckboxFirstClick:this.progressNum+=oe.luckboxContinueClick,this.spaceTime=t,this.progressNum>=1?(this.isEnd=!0,this.btnJump.visible=!1,this.okBtn.visible=!1,this.anchor.getChildByName("hand").visible=!1,this.centerImg.getChildByName("iconClose").visible=!1,this.centerImg.getChildByName("label_1").visible=!1,this.centerImg.getChildByName("iconOpen").visible=!0,this.centerImg.getChildByName("iconOpen").getChildByName("Num").text=oe.ctrlInfo.randomRewardNum,this.centerImg.getChildByName("label_2").visible=!0,this.btnVideo.visible=!0,void(this.btnReceive.visible=!0)):(this.updataProgress(),this.progressNum>=this.rand&&!this.isShowBanner&&(this.isShowBanner=!0,console.log("======>showbanner"),this.ShowBanner(),oe.ctrlInfo.isWudian&&1==oe.wudian_level[7]&&Laya.timer.once(oe.ctrlInfo.btuMove[7],this,function(){Laya.Tween.to(e.anchor,{y:e.offset.y/2-280},300,Laya.Ease.backOut)})),this.progressNum>=this.rand2?(this.isEnd=!0,this.btnJump.visible=!1,this.okBtn.visible=!1,this.anchor.getChildByName("hand").visible=!1,this.centerImg.getChildByName("iconClose").visible=!1,this.centerImg.getChildByName("label_1").visible=!1,this.centerImg.getChildByName("iconOpen").visible=!0,this.centerImg.getChildByName("iconOpen").getChildByName("Num").text=String(oe.ctrlInfo.randomRewardNum),this.centerImg.getChildByName("label_2").visible=!0,this.btnVideo.visible=!0,void(this.btnReceive.visible=!0)):void 0)}},{key:"videoReceiveClick",value:function(){var e=this;this._isClick||(this._isClick=!0,Laya.timer.once(1e3,this,function(){e._isClick=null}),$.ptAPI?$.callAPIMethodByProxy("showVideo",{posID:202,_type:B.EGG,caller:this,callBackSuc:function(){e.receiveReword(!0)},callBackFail:function(){h.instance.emit("openTip","看完视频才能获得奖励翻倍")},callBackErro:function(){h.instance.emit("openTip","今日视频次数已用完")}}):this.receiveReword(!0))}},{key:"receiveClick",value:function(){this.receiveReword(!1)}},{key:"receiveReword",value:function(e){var t,i=this,n=oe.ctrlInfo.randomRewardNum;t=e?2*n:n,se.instance.updateUserMoney(t,function(){h.instance.emit("openTip","获得"+t+"金币"),h.instance.emit(k),i.close()})}},{key:"ShowBanner",value:function(){1==oe.bannerSwitch[7]?$.callAPIMethodByProxy("showBannerAdGoldenEgg")?this.hideADPanel():this.showADPanel():2==oe.bannerSwitch[7]?this.appBanner.start(40001):3==oe.bannerSwitch[7]&&this.showADPanel()}},{key:"showADPanel",value:function(){var e=this;this.owner.getChildByName("ADPanel").visible=oe.getAdData(30001).length>0,Laya.timer.frameOnce(2,this,function(){e.adPlane.init({_cellWidth:136,_cellHeight:162,_spaceX:17}),e.adPlane.start(oe.getAdData(30001),30001,"首页")})}},{key:"hideADPanel",value:function(){this.owner.getChildByName("ADPanel").visible=!1}},{key:"updataProgress",value:function(){this.progressNum>=1?this.progressNum=1:this.progressNum<=.07&&(this.progressNum=.07),this.bar.width=375*this.progressNum}},{key:"close",value:function(){$.callAPIMethodByProxy("destoryAllBannerAd"),h.instance.emit(u),this.isAutoOpen&&h.instance.emit("AUTO_STARTGAME"),_get(_getPrototypeOf(GoldenEggView.prototype),"closeView",this).call(this)}}]),GoldenEggView}(),Oe=function(e){function QHFullScreen(){return _classCallCheck(this,QHFullScreen),_possibleConstructorReturn(this,_getPrototypeOf(QHFullScreen).apply(this,arguments))}return _inherits(QHFullScreen,Laya.Script),_createClass(QHFullScreen,[{key:"onAwake",value:function(){var e=this.owner;e.width=Laya.stage.width,e.height=Laya.stage.height}}]),QHFullScreen}(),je=function(e){function MainHomeView(){return _classCallCheck(this,MainHomeView),_possibleConstructorReturn(this,_getPrototypeOf(MainHomeView).apply(this,arguments))}return _inherits(MainHomeView,ce),_createClass(MainHomeView,[{key:"onAwake",value:function(){_get(_getPrototypeOf(MainHomeView.prototype),"onAwake",this).call(this),this.btn_start=this.owner.getChildByName("spBC").getChildByName("btn_start"),this.btn_start.on(Laya.Event.CLICK,this,this.startGame),this.levelList=this.owner.getChildByName("levelList"),this.levelList.hScrollBarSkin="",this.levelList.selectEnable=!0,this.levelList.renderHandler=new Laya.Handler(this,this.onRenderLevelItem),this.levelList.selectHandler=new Laya.Handler(this,this.onSelectLevelItem)}},{key:"onRenderLevelItem",value:function(e,t){var i=o.levelData.cfgLvInfos[t],n=o.getLevelById(i.ID),a=n>=0,s=n>=i.unlock_number,r=e.getChildByName("unlockGp"),l=e.getChildByName("lockGp");if(a)r.visible=!0,l.visible=!1,r.getChildByName("levelTxt1").value=i.ID;else{r.visible=!1,l.visible=!0;var h=l.getChildByName("levelLockTip"),c=l.getChildByName("videoTipBg");if(l.getChildByName("levelTxt2").value=i.ID,1==i.unlock_type)h.visible=!0,c.visible=!1,h.text="完成第"+i.last_ID+"关解锁";else if(2==i.unlock_type){if(i.last_ID>0){var u=o.levelData.GetLevelInfo(i.last_ID);null!=u&&o.getLevelById(i.last_ID)>=u.unlock_number}h.visible=!0,c.visible=!1,h.text="完成第"+i.last_ID+"关解锁"}}e.getChildByName("passMark").visible=s;var d=e.getChildByName("selectImg"),g=e.getChildByName("arrow");this.currSelectIdx==t?(d.visible=!0,g.visible=!0,this.tweenAniDown(g,{y:232},{y:238},200)):(d.visible=!1,Laya.Tween.clearAll(g),g.visible=!1);var m=o.levelData.GetBgmInfo(i.bgm_ID),f=e.getChildByName("bgmNameTxt").getChildByName("lbl");f.text=m.bgm_name;var y=f.width,v=y>158;v||(f.x=(158-y)/2);var p=e.getChildByName("bgmSingerTxt").getChildByName("lbl");p.text=m.bgm_singer;var w=p.width,b=w>158;b||(p.x=(158-w)/2),Laya.timer.clearAll(e),(v||b)&&Laya.timer.frameLoop(1,e,function(){v&&(f.x-=1,f.x<-y&&(f.x=148)),b&&(p.x-=1,p.x<-w&&(p.x=148))})}},{key:"onSelectLevelItem",value:function(e){X.instance.playSound("button-small"),this.clearSelection();var t=this.levelList.getCell(e);t.getChildByName("selectImg").visible=!0;var i=t.getChildByName("arrow");if(i.visible=!0,this.tweenAniDown(i,{y:232},{y:238},200),this.currSelectIdx<0)this.levelList.scrollTo(Math.max(0,e-1));else if(e>this.levelList.startIndex+2){if(this.levelList.scrollBar){this.levelList.scrollBar.stopScroll();var n=228*(this.levelList.startIndex+1);Laya.Tween.to(this.levelList.scrollBar,{value:n},200,null,null,0,!0)}}else{var a=Math.max(0,228*(e-1));this.levelList.scrollBar&&a<this.levelList.scrollBar.value&&(this.levelList.scrollBar.stopScroll(),Laya.Tween.to(this.levelList.scrollBar,{value:a},200,null,null,0,!0))}this.currSelectIdx=e}},{key:"clearSelection",value:function(){if(this.currSelectIdx>=0){var e=this.levelList.getCell(this.currSelectIdx);if(null==e)return;e.getChildByName("selectImg").visible=!1;var t=e.getChildByName("arrow");Laya.Tween.clearAll(t),t.visible=!1}}},{key:"openView",value:function(e){if(_get(_getPrototypeOf(MainHomeView.prototype),"openView",this).call(this,e),this.currSelectIdx=-1,this.levelList.array=o.levelData.cfgLvInfos,this.levelList.refresh(),oe.firstTimeOpenMainUI){oe.firstTimeOpenMainUI=!1;var t=this.hasLevelUnLockId(o.lastUnlockLevel);this.levelList.selectedIndex=t>0?t-1:o.lastUnlockLevel-1}else if(o.hasUnlock)o.hasUnlock=!1,this.levelList.selectedIndex=o.lastUnlockLevel-1;else{var i=this.hasLevelUnLockId(o.level);this.levelList.selectedIndex=i>0?i-1:o.level-1}}},{key:"hasLevelUnLockId",value:function(e){var t=o.levelData.GetLevelInfo(e);if(null!=t&&o.getLevelById(e)>=t.unlock_number)for(var i=0;i<o.levelData.cfgLvInfos.length;i++)if(o.levelData.cfgLvInfos[i].last_ID===e)return o.levelData.cfgLvInfos[i].ID;return 0}},{key:"startGame",value:function(){var e=this;if(!this._isClick)if(o.isLogin)if(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),this.currSelectIdx>=0&&this.currSelectIdx<o.levelData.cfgLvInfos.length){var t=o.levelData.cfgLvInfos[this.currSelectIdx];o.getLevelById(t.ID);this.startGameFuncEntrance()}else this.startGameFuncEntrance();else h.instance.emit("openTip","用户信息正在获取中……请稍后！")}},{key:"startGameFuncEntrance",value:function(){Y.Instance.InitLevelData(),h.instance.emit("openFighting")}}]),MainHomeView}(),Ve=function(e){function ZUIWidget(){var e;return _classCallCheck(this,ZUIWidget),(e=_possibleConstructorReturn(this,_getPrototypeOf(ZUIWidget).apply(this,arguments))).fitLeft=!1,e.fitRight=!1,e.fitTop=!1,e.fitDown=!1,e.fitHorCenter=!1,e.fitVerCenter=!1,e._sWidth=0,e._sHeight=0,e._localWidth=0,e._localHeight=0,e}return _inherits(ZUIWidget,Laya.Script),_createClass(ZUIWidget,[{key:"initInfo",value:function(){this._sWidth=Laya.stage.width,this._sHeight=Laya.stage.height,this._localWidth=this.owner.width,this._localHeight=this.owner.height}},{key:"onEnable",value:function(){this.initInfo(),this.handleFit()}},{key:"handleLeftWorld",value:function(){var e=this.owner.parent.globalToLocal(new Laya.Point(0,0));this.owner.x=e.x}},{key:"handleRightWorld",value:function(){var e=this._sWidth-this._localWidth-0,t=this.owner.parent.globalToLocal(new Laya.Point(e,0));this.owner.x=t.x}},{key:"handleTopWorld",value:function(){var e=this.owner.parent.globalToLocal(new Laya.Point(0,0));this.owner.y=e.y}},{key:"handleBottomWorld",value:function(){var e=this._sHeight-this._localHeight-0,t=this.owner.parent.globalToLocal(new Laya.Point(0,e));this.owner.y=t.y}},{key:"handlerHorCenterWorld",value:function(){var e=(this._sWidth-this._localWidth)/2,t=this.owner.parent.globalToLocal(new Laya.Point(e,0));this.owner.x=t.x}},{key:"handleVerCenterWorld",value:function(){var e=(this._sHeight-this._localHeight)/2,t=this.owner.parent.globalToLocal(new Laya.Point(0,e));this.owner.y=t.y}},{key:"handleFit",value:function(){1==this.fitHorCenter?this.handlerHorCenterWorld():1==this.fitLeft?this.handleLeftWorld():1==this.fitRight&&this.handleRightWorld(),1==this.fitVerCenter?this.handleVerCenterWorld():1==this.fitTop?this.handleTopWorld():1==this.fitDown&&this.handleBottomWorld()}},{key:"checkCanvasSize",value:function(){var e=Laya.stage.width,t=Laya.stage.height;e==this._sWidth&&t==this._sHeight||(this.initInfo(),this.handleFit())}}]),ZUIWidget}(),Ge=function(e){function MainView(){var e;return _classCallCheck(this,MainView),(e=_possibleConstructorReturn(this,_getPrototypeOf(MainView).call(this))).isLoadAD=!1,e.currSelectIdx=-1,e.cfgAllAttr1=null,e.cfgAllAttr2=null,e}return _inherits(MainView,ce),_createClass(MainView,[{key:"onAwake",value:function(){_get(_getPrototypeOf(MainView.prototype),"onAwake",this).call(this),this.emptyClickArea=this.owner.getChildByName("emptyClickArea"),this.centerImg=this.owner.getChildByName("centerImg"),this.imgLogo=this.centerImg.getChildByName("img_logo"),this.promotion1=this.centerImg.getChildByName("adImage1"),this.promotion2=this.centerImg.getChildByName("adImage2"),this.promotion5=this.centerImg.getChildByName("adImage5"),this.promotion6=this.centerImg.getChildByName("adImage6"),this.promotion7=this.centerImg.getChildByName("adImage7"),this.levelList=this.owner.getChildByName("levelList"),this.settingPop=this.owner.getChildByName("settingPop"),this.btnSound=this.settingPop.getChildByName("musicBtn"),this.btnVirbort=this.settingPop.getChildByName("vibrateBtn"),this.switchOptionUI(),this.img_adMove=this.owner.getChildByName("img_adMove"),this.btnStart=this.img_adMove.getChildByName("btn_start"),this.btnAttr1=this.img_adMove.getChildByName("btnAttr1"),this.btnAttr2=this.img_adMove.getChildByName("btnAttr2"),this.attrShareGroup=this.img_adMove.getChildByName("attrShareGroup"),this.currAttrValue1=this.attrShareGroup.getChildByName("currAttrValue1"),this.btnShare=this.attrShareGroup.getChildByName("btnShare"),this.imgWordUpgrade1=this.btnShare.getChildByName("txtUpgrade"),this.imgWordMax1=this.btnShare.getChildByName("txtMax"),this.attrVideoGroup=this.img_adMove.getChildByName("attrVideoGroup"),this.currAttrValue2=this.attrVideoGroup.getChildByName("currAttrValue2"),this.btnVideo=this.attrVideoGroup.getChildByName("btnVideo"),this.imgWordUpgrade2=this.btnVideo.getChildByName("txtUpgrade"),this.imgWordMax2=this.btnVideo.getChildByName("txtMax"),this.promotion1.getComponent(Te).start(!0,!0,10001),this.promotion2.getComponent(Te).start(!0,!0,10002),this.promotion5.getComponent(Te).start(!0,!0,20001),this.promotion6.getComponent(Te).start(!0,!0,20002),this.promotion7.getComponent(Te).start(!0,!0,20003),this.moreGame=this.centerImg.getChildByName("moreGame"),this.tips=this.moreGame.getChildByName("tips"),le.autoScreenSize([this.settingPop]),this.adPlane=this.owner.getChildByName("ADPanel").getChildByName("ADPanelBg").getComponent(pe),this.appBanner=this.owner.getChildByName("appBanner").getComponent(Le);var e=this;Laya.timer.frameOnce(20,this,function(){$.callAPIMethodByProxy("createAuthorizationButton",{x:e.btnStart.x,y:e.btnStart.y-this.offset.y,width:e.btnStart.width,isFull:!1,height:e.btnStart.height,successBack:e[e.btnStart.name+"Func"],failBack:e[e.btnStart.name+"Func"]})})}},{key:"onEnable",value:function(){_get(_getPrototypeOf(MainView.prototype),"onEnable",this).call(this),this.setAttrOfShare(),this.setAttrOfVideo()}},{key:"switchOptionUI",value:function(){oe.isSound?this.btnSound.skin="mainview/zhuye_sound_open.png":this.btnSound.skin="mainview/zhuye_sound_close.png",oe.isVirbort?this.btnVirbort.skin="mainview/zhuye_virbort_open.png":this.btnVirbort.skin="mainview/zhuye_virbort_close.png"}},{key:"openView",value:function(e){_get(_getPrototypeOf(MainView.prototype),"openView",this).call(this,e),this.isLoadAD=!1;var t=!0;if(this.currSelectIdx=-1,this.levelList.array=o.levelData.cfgLvInfos,this.levelList.refresh(),oe.firstTimeOpenMainUI){oe.firstTimeOpenMainUI=!1,t=!1;var i=this.hasLevelUnLockId(o.lastUnlockLevel);this.levelList.selectedIndex=i>0?i-1:o.lastUnlockLevel-1}else if(o.hasUnlock)o.hasUnlock=!1,this.levelList.selectedIndex=o.lastUnlockLevel-1;else{var n=this.hasLevelUnLockId(o.level);this.levelList.selectedIndex=n>0?n-1:o.level-1}this.ShowBanner(),1==oe.inviteSwitch[4]&&h.instance.emit("openFriendInvite"),1==oe.luckboxSwitch[4]&&oe.ctrlInfo.isWudian&&h.instance.emit("openGoldenEggView"),1==oe.gamelistSwitch[4]&&h.instance.emit("openConvergeAdNew"),1==oe.gameboxSwitch[4]&&h.instance.emit("openGameBox"),Laya.timer.loop(5e3,this,this.ani),t&&$.callAPIMethodByProxy("showInterstitialAD")}},{key:"ani",value:function(){var e=this;Laya.Tween.to(this.moreGame,{scaleY:.7,scaleX:.7},500,null,Laya.Handler.create(this,function(){Laya.Tween.to(e.moreGame,{scaleY:1,scaleX:1},500,null,Laya.Handler.create(e,function(){Laya.Tween.to(e.moreGame,{scaleY:.7,scaleX:.7},500,null,Laya.Handler.create(e,function(){Laya.Tween.to(e.moreGame,{scaleY:1,scaleX:1},500,null,Laya.Handler.create(e,function(){}))}))}))}))}},{key:"addEvent",value:function(){_get(_getPrototypeOf(MainView.prototype),"addEvent",this).call(this),this.btnSound.on(Laya.Event.CLICK,this,this.soundBtnClick),this.btnVirbort.on(Laya.Event.CLICK,this,this.virbortBtnClick),this.emptyClickArea.on(Laya.Event.CLICK,this,this.emptyClickAreaFunc),this.btnAttr1.on(Laya.Event.CLICK,this,this.btnAttrShareFunc),this.btnAttr2.on(Laya.Event.CLICK,this,this.btnAttrVideoFunc),this.btnShare.on(Laya.Event.CLICK,this,this.btnShareFunc),this.btnVideo.on(Laya.Event.CLICK,this,this.btnVideoFunc),this.moreGame.on(Laya.Event.CLICK,this,this.moreGameFunc),this.btnStart.on(Laya.Event.CLICK,this,this.btnStartFunc),this.imgLogo.on(Laya.Event.DOUBLE_CLICK,this,this.showUserIdFunc),h.instance.onEvent("AUTO_STARTGAME",this,this.startGameFunc),h.instance.onEvent(u,this,this.ListenShowBanner),h.instance.onEvent(d,this,this.showADPanel)}},{key:"removeEvent",value:function(){this.btnSound.off(Laya.Event.CLICK,this,this.soundBtnClick),this.btnVirbort.off(Laya.Event.CLICK,this,this.virbortBtnClick),this.emptyClickArea.on(Laya.Event.CLICK,this,this.emptyClickAreaFunc),this.btnStart.off(Laya.Event.CLICK,this,this.btnStartFunc),this.btnAttr1.off(Laya.Event.CLICK,this,this.btnAttrShareFunc),this.btnAttr2.off(Laya.Event.CLICK,this,this.btnAttrVideoFunc),this.btnShare.off(Laya.Event.CLICK,this,this.btnShareFunc),this.btnVideo.off(Laya.Event.CLICK,this,this.btnVideoFunc),this.moreGame.off(Laya.Event.CLICK,this,this.moreGameFunc),this.imgLogo.off(Laya.Event.DOUBLE_CLICK,this,this.showUserIdFunc),h.instance.onOffEvent(u,this,this.ListenShowBanner),h.instance.onOffEvent(d,this,this.showADPanel),$.callAPIMethodByProxy("destoryAuthorization"),_get(_getPrototypeOf(MainView.prototype),"removeEvent",this).call(this)}},{key:"hasLevelUnLockId",value:function(e){var t=o.levelData.GetLevelInfo(e);if(null!=t&&o.getLevelById(e)>=t.unlock_number)for(var i=0;i<o.levelData.cfgLvInfos.length;i++)if(o.levelData.cfgLvInfos[i].last_ID===e)return o.levelData.cfgLvInfos[i].ID;return 0}},{key:"virbortBtnClick",value:function(){X.instance.playSound("button-small"),oe.isVirbort=!oe.isVirbort,oe.isVirbort?this.btnVirbort.skin="mainview/zhuye_virbort_open.png":this.btnVirbort.skin="mainview/zhuye_virbort_close.png",oe.setVirbort(oe.isVirbort?"":"1")}},{key:"soundBtnClick",value:function(){X.instance.playSound("button-small"),oe.isSound=!oe.isSound,oe.isSound?this.btnSound.skin="mainview/zhuye_sound_open.png":this.btnSound.skin="mainview/zhuye_sound_close.png",oe.isSound?(oe.setSound(""),X.instance.playBGM()):(oe.setSound("1"),X.instance.stopBGM())}},{key:"showUserIdFunc",value:function(){var e=this;this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),h.instance.emit("openTip","您的用户ID："+o.userId))}},{key:"btnServiceFunc",value:function(){var e=this;X.instance.playSound("button-small"),this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),$.callAPIMethodByProxy("openCustomerServiceConversation"))}},{key:"btnStartFunc",value:function(){var e=this;X.instance.playSound("button-small"),this.attrShareGroup.visible?Laya.Tween.to(this.attrShareGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrShareGroup.visible=!1,e.btnStartLogicFunc()})):this.attrVideoGroup.visible?Laya.Tween.to(this.attrVideoGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrVideoGroup.visible=!1,e.btnStartLogicFunc()})):this.btnStartLogicFunc()}},{key:"btnStartLogicFunc",value:function(){var e=this,t=null;Laya.Browser.onMiniGame?(t=$.callAPIMethodByProxy("getLaunchData"))&&(1011!=t.scene&&1012!=t.scene&&1013!=t.scene&&1005!=t.scene&&1006!=t.scene?oe.ctrlInfo.isWudian&&oe.autoVideo[0]&&$.ptAPI?$.callAPIMethodByProxy("showVideo",{posID:201,_type:B.NORMAL,caller:this,callBackSuc:function(){e.autoOpenGoldnEgg()},callBackFail:function(){e.autoOpenGoldnEgg()},callBackErro:function(){e.autoOpenGoldnEgg()}}):this.autoOpenGoldnEgg():this.startGameFunc()):this.startGameFunc()}},{key:"autoOpenGoldnEgg",value:function(){if(oe.ctrlInfo.isWudian&&oe.autoVideo[1]){this.hideADPanel();h.instance.emit("openGoldenEggView",{isAutoOpen:!0})}else this.startGameFunc()}},{key:"startGameFunc",value:function(){var e=this;if(!this._isClick)if(o.isLogin){if(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),this.currSelectIdx>=0&&this.currSelectIdx<o.levelData.cfgLvInfos.length){var t=o.levelData.cfgLvInfos[this.currSelectIdx];if(!(o.getLevelById(t.ID)>=0)){if(1==t.unlock_type)return void h.instance.emit("openTip","关卡解锁后才能开始挑战哦！");var i=!0;if(t.last_ID>0){var n=o.levelData.GetLevelInfo(t.last_ID);null!=n&&(i=o.getLevelById(t.last_ID)>=n.unlock_number)}return void(i?this.startGameFuncEntrance():h.instance.emit("openTip","关卡解锁后才能开始挑战哦！"))}o.level=t.ID}this.startGameFuncEntrance()}else h.instance.emit("openTip","用户信息正在获取中……请稍后！")}},{key:"startGameFuncEntrance",value:function(){Y.Instance.InitLevelData(),o.curMultiple<=1&&Z.ald("开始游戏--视频"),$.callAPIMethodByProxy("destoryAuthorization"),$.callAPIMethodByProxy("destoryAllBannerAd"),$.callAPIMethodByProxy("hideInterstitialAD"),ee.isLoad3DRes?Y.Instance.BgmIsLoaded()?h.instance.emit("openFighting"):h.instance.emit("openConvergeAdForMainView",{action:"startGame",type:"music"}):h.instance.emit("openConvergeAdForMainView",{action:"startGame"})}},{key:"videoUnlockLevelFunc",value:function(e){var t=this;$.ptAPI?(this.isLoadAD=!0,Z.ald("充电属性升级--视频"),$.callAPIMethodByProxy("showVideo",{posID:202,_type:B.UNLOCK_LEVEL,caller:this,callBackSuc:function(){t.isLoadAD=!1,se.instance.videoUnlockLevel(e,function(){o.level=e,t.startGameFuncEntrance()}),Z.ald("解锁关卡成功--视频")},callBackFail:function(){h.instance.emit("openTip","看完视频才能解锁关卡"),t.isLoadAD=!1},callBackErro:function(){h.instance.emit("openTip","今日视频次数已用完"),t.isLoadAD=!1}})):se.instance.videoUnlockLevel(e,function(){o.level=e,t.startGameFuncEntrance()})}},{key:"moreGameFunc",value:function(){oe.mainViewTips&&(oe.mainViewTips=!1),h.instance.emit("openGameBox")}},{key:"emptyClickAreaFunc",value:function(){var e=this;this.attrShareGroup.visible&&this.attrShareGroup.scaleX>=1?Laya.Tween.to(this.attrShareGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrShareGroup.visible=!1})):this.attrVideoGroup.visible&&this.attrVideoGroup.scaleX>=1&&Laya.Tween.to(this.attrVideoGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrVideoGroup.visible=!1}))}},{key:"btnAttrShareFunc",value:function(){var e=this;this.attrShareGroup.visible&&this.attrShareGroup.scaleX<1||(X.instance.playSound("button-small"),this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),this.attrVideoGroup.visible?Laya.Tween.to(this.attrVideoGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrVideoGroup.visible=!1,e.attrShareGroup.scale(0,0),e.attrShareGroup.visible=!0,Laya.Tween.to(e.attrShareGroup,{scaleX:1,scaleY:1},500,Laya.Ease.bounceOut)})):this.attrShareGroup.visible&&this.attrShareGroup.scaleX>=1?Laya.Tween.to(this.attrShareGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrShareGroup.visible=!1})):(this.attrShareGroup.scale(0,0),this.attrShareGroup.visible=!0,Laya.Tween.to(this.attrShareGroup,{scaleX:1,scaleY:1},500,Laya.Ease.bounceOut))))}},{key:"btnAttrVideoFunc",value:function(){var e=this;this.attrVideoGroup.visible&&this.attrVideoGroup.scaleX<1||(X.instance.playSound("button-small"),this._isClick||(Laya.timer.once(500,this,function(){e._isClick=null}),this.attrShareGroup.visible?Laya.Tween.to(this.attrShareGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrShareGroup.visible=!1,e.attrVideoGroup.scale(0,0),e.attrVideoGroup.visible=!0,Laya.Tween.to(e.attrVideoGroup,{scaleX:1,scaleY:1},500,Laya.Ease.bounceOut)})):this.attrVideoGroup.visible&&this.attrVideoGroup.scaleX>=1?Laya.Tween.to(this.attrVideoGroup,{scaleX:0,scaleY:0},250,Laya.Ease.quadInOut,Laya.Handler.create(this,function(){e.attrVideoGroup.visible=!1})):(this.attrVideoGroup.scale(0,0),this.attrVideoGroup.visible=!0,Laya.Tween.to(this.attrVideoGroup,{scaleX:1,scaleY:1},500,Laya.Ease.bounceOut))))}},{key:"setAttrOfShare",value:function(){if(null==this.cfgAllAttr1){var e=oe.GetLocaleConfig("attribute");this.cfgAllAttr1=e[1]}var t=o.attrShareLevel;if(t>=this.cfgAllAttr1.length){t=this.cfgAllAttr1.length;var i=this.cfgAllAttr1[t-1];this.currAttrValue1.text=i.para+"s",this.imgWordUpgrade1.visible=!1,this.imgWordMax1.visible=!0,o.buffKeepTime=1e3*i.para}else{var n=this.cfgAllAttr1[t-1];this.currAttrValue1.text=n.para+"s",o.buffKeepTime=1e3*n.para}}},{key:"setAttrOfVideo",value:function(){if(null==this.cfgAllAttr2){var e=oe.GetLocaleConfig("attribute");this.cfgAllAttr2=e[2]}var t=o.attrVideoLevel;if(t>=this.cfgAllAttr2.length){t=this.cfgAllAttr2.length;var i=this.cfgAllAttr2[t-1];this.currAttrValue2.text=(100*i.para).toFixed(1)+"%",this.imgWordUpgrade2.visible=!1,this.imgWordMax2.visible=!0,o.kickBoardCharging=i.para}else{var n=this.cfgAllAttr2[t-1];this.currAttrValue2.text=(100*n.para).toFixed(1)+"%",o.kickBoardCharging=n.para}}},{key:"btnShareFunc",value:function(){var e=this;X.instance.playSound("button-small"),this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),$.ptAPI?$.callAPIMethodByProxy("shareAppMessage",{caller:this,callback:function(t){e._isClick=!1,t.success?e.requestUpgradeAttr(2):$.callAPIMethodByProxy("ShareFileTip",function(t){t.confirm&&e.btnShareFunc()})},args:{},type:1}):this.requestUpgradeAttr(2))}},{key:"btnVideoFunc",value:function(){var e=this;X.instance.playSound("button-small"),this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),$.ptAPI?(this.isLoadAD=!0,Z.ald("充电属性升级--视频"),$.callAPIMethodByProxy("showVideo",{posID:202,_type:B.ATTR_UPGRADE,caller:this,callBackSuc:function(){e.isLoadAD=!1,e.requestUpgradeAttr(1),Z.ald("充电属性升级成功--视频")},callBackFail:function(){h.instance.emit("openTip","看完视频才能升级属性"),e.isLoadAD=!1},callBackErro:function(){h.instance.emit("openTip","今日视频次数已用完"),e.isLoadAD=!1}})):this.requestUpgradeAttr(1))}},{key:"requestUpgradeAttr",value:function(e){var t=this;se.instance.upgradeAttr(e,function(){1==e?t.setAttrOfVideo():2==e&&t.setAttrOfShare(),h.instance.emit("openTip","属性升级成功")})}},{key:"ListenShowBanner",value:function(){var e=0;q.instance.getView("GoldenEggView.scene")&&e++,q.instance.getView("ConvergeAdNew.scene")&&e++,q.instance.getView("FriendInvite.scene")&&e++,q.instance.getView("ConvergeAdForMainView.scene")&&e++,e>1||this.ShowBanner()}},{key:"ShowBanner",value:function(){1==oe.bannerSwitch[4]?$.callAPIMethodByProxy("showBannerAdHome")?this.hideADPanel():this.showADPanel():2==oe.bannerSwitch[4]?this.appBanner.start(40001):3==oe.bannerSwitch[4]&&this.showADPanel()}},{key:"showADPanel",value:function(){var e=this;null!=this.owner&&(this.owner.getChildByName("ADPanel").visible=!0,Laya.timer.frameOnce(2,this,function(){e.adPlane.init({_cellWidth:136,_cellHeight:162,_spaceX:17}),e.adPlane.start(oe.getAdData(30001),30001,"首页")}))}},{key:"hideADPanel",value:function(){this.owner.getChildByName("ADPanel").visible=!1}}]),MainView}(),Ne=function(e){function Resurgence(){var e;return _classCallCheck(this,Resurgence),(e=_possibleConstructorReturn(this,_getPrototypeOf(Resurgence).call(this))).endAngle=-90,e.isLoadingAD=!1,e.goShareAdc=!1,e.resurgenceTime=7e3,e}return _inherits(Resurgence,ce),_createClass(Resurgence,[{key:"onAwake",value:function(){_get(_getPrototypeOf(Resurgence.prototype),"onAwake",this).call(this),this.endAngle=-90,this.appBanner=this.owner.getChildByName("appBanner").getComponent(Le),this.btnAnchor=this.owner.getChildByName("btnAnchor"),this.btnShare=this.btnAnchor.getChildByName("shareBtn"),this.btnVideo=this.btnAnchor.getChildByName("videoBtn"),this.btnJump=this.btnAnchor.getChildByName("skipBtn"),this.progressBg=this.owner.getChildByName("progressBg"),this.progressMask=this.progressBg.getChildByName("progressBg").mask,this.progressMask.graphics.clear(),this.progressMask.graphics.drawPie(153,153,153,-90,this.endAngle,"#ff0000"),this.adPlane=this.btnAnchor.getChildByName("ADPlane"),this.adPlaneBg=this.btnAnchor.getChildByName("bg"),this._overListLoop=this.adPlane.getComponent(Me),this.reviveCount=this.progressBg.getChildByName("reviveCount"),this.isLoadingAD=!1,this.ButtonADPanel=this.owner.getChildByName("ButtonADPanel"),this.ButtonAdListloop=this.ButtonADPanel.getChildByName("ADPanelBg").getComponent(pe),this.ButtonADPanel.y+=this.offset.y/3,this.btnAnchor.centerY+=this.offset.y/3,this.ButtonADPanel.y+=this.offset.y/3}},{key:"addEvent",value:function(){this.btnShare.on(Laya.Event.CLICK,this,this.shareClick),this.btnVideo.on(Laya.Event.CLICK,this,this.videoClick),this.btnJump.on(Laya.Event.CLICK,this,this.jumpClick),h.instance.onEvent(u,this,this.ShowBanner),h.instance.onEvent(m,this,this.showADPanel),_get(_getPrototypeOf(Resurgence.prototype),"addEvent",this).call(this)}},{key:"removeEvent",value:function(){this.btnShare.off(Laya.Event.CLICK,this,this.shareClick),this.btnVideo.off(Laya.Event.CLICK,this,this.videoClick),this.btnJump.off(Laya.Event.CLICK,this,this.jumpClick),h.instance.onOffEvent(u,this,this.ShowBanner),h.instance.onOffEvent(m,this,this.showADPanel),_get(_getPrototypeOf(Resurgence.prototype),"removeEvent",this).call(this)}},{key:"countDown",value:function(){if(!this.goShareAdc){var e=this.resurgenceTime-1e3;e<100?(this.reviveCount.text=Math.ceil(e/1e3).toString(),this.resurgenceTime=e,this.progressMask.graphics.clear(),this.progressMask.graphics.drawPie(153,153,153,-90,270,"#ff0000"),this.openOver()):(this.reviveCount.text=Math.ceil(e/1e3).toString(),this.resurgenceTime=e,this.endAngle+=51.4,this.progressMask.graphics.drawPie(153,153,153,-90,this.endAngle,"#ff0000"),X.instance.playSound("djs"))}}},{key:"sptVideoAni",value:function(){Laya.Tween.clearTween(this.btnVideo),this.tweenAniDown(this.btnVideo,{scaleX:1.05,scaleY:1.05},{scaleX:.95,scaleY:.95},400)}},{key:"openView",value:function(){var e=this;if(_get(_getPrototypeOf(Resurgence.prototype),"openView",this).call(this),1==oe.inviteSwitch[1]&&h.instance.emit("openFriendInvite"),1==oe.luckboxSwitch[1]&&h.instance.emit("openGoldenEggView"),1==oe.gamelistSwitch[1]&&h.instance.emit("openConvergeAdNew"),1==oe.gameboxSwitch[1]&&h.instance.emit("openGameBox"),Laya.timer.clearAll(this),this.reviveCount.text="7",this.resurgenceTime=7e3,this.ShowBanner(),Laya.timer.loop(1e3,this,this.countDown),this.btnShare.visible=!1,this.btnVideo.visible=!1,1==oe.reviveSwitch[0]&&(this.btnVideo.visible=!0,this.sptVideoAni()),1==oe.reviveSwitch[1]&&(this.btnShare.visible=!0),1==oe.reviveSwitch[2]){this.progressBg.visible=!1;var t=oe.getAdData(80001);this.adPlaneBg.visible=t.length>0,this.adPlane.visible=t.length>0,this._overListLoop.start(t,80001)}else this.progressBg.visible=!0,this.adPlaneBg.visible=!1,this.adPlane.visible=!1,this.openGoingSurpassOther(ie.LEVEL);if(oe.ctrlInfo.isWudian&&1==oe.wudian_level[1]){var i=le.random(590,620);this.btnJump.y=i,this.btnJump.alpha=0,Laya.timer.once(oe.ctrlInfo.btuAppear[1]-0,this,function(){Laya.Tween.to(e.btnJump,{alpha:1},300)}),Laya.timer.once(oe.ctrlInfo.btuMove[1]-0,this,function(){Laya.Tween.to(e.btnJump,{y:367},500,Laya.Ease.backOut,null,500)})}else this.btnJump.y=367}},{key:"openGoingSurpassOther",value:function(e){$.subDomain&&(this.goingSurpassOther||(this.goingSurpassOther=new Laya.WXOpenDataViewer,this.owner.addChild(this.goingSurpassOther)),this.goingSurpassOther.pos(0,142),this.goingSurpassOther.width=750,this.goingSurpassOther.height=92,$.subDomain.setOpenView(this.goingSurpassOther),$.subDomain.openGoingSurpassOther(e))}},{key:"closeGoingSurpassOther",value:function(){$.subDomain&&($.subDomain.closeGoingSurpassOther(),this.goingSurpassOther&&(this.goingSurpassOther.destroy(),this.goingSurpassOther=null))}},{key:"onEnable",value:function(){_get(_getPrototypeOf(Resurgence.prototype),"onEnable",this).call(this)}},{key:"onDisable",value:function(){_get(_getPrototypeOf(Resurgence.prototype),"onDisable",this).call(this),$.callAPIMethodByProxy("destoryAllBannerAd"),this.closeGoingSurpassOther()}},{key:"videoClick",value:function(){var e=this;X.instance.playSound("button-small"),this._isClick||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),$.ptAPI?(this.isLoadingAD=!0,this.goShareAdc=!0,Z.ald("立即复活--视频"),$.callAPIMethodByProxy("showVideo",{posID:202,_type:B.RESURGENCE,caller:this,callBackSuc:function(){e.openFighting(),e.isLoadingAD=!1,e.goShareAdc=!1,Z.ald("立即复活成功--视频")},callBackFail:function(){h.instance.emit("openTip","看完视频才能复活"),e.isLoadingAD=!1,e.goShareAdc=!1},callBackErro:function(){h.instance.emit("openTip","今日视频次数已用完"),e.isLoadingAD=!1,e.goShareAdc=!1}})):this.openFighting())}},{key:"shareClick",value:function(){var e=this;this._isClick||this.isLoadingAD||(this.goShareAdc=!0,this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),X.instance.playSound("button-small"),Z.ald("分享复活"),$.ptAPI?$.callAPIMethodByProxy("shareAppMessage",{caller:this,callback:function(t){e.goShareAdc=!1,e._isClick=!1,e.isLoadingAD=!1,t.success?e.openFighting():$.callAPIMethodByProxy("ShareFileTip",function(t){t.confirm&&e.shareClick()})},args:{},type:1}):this.openFighting())}},{key:"jumpClick",value:function(){var e=this;X.instance.playSound("button-small"),this._isClick||this.isLoadingAD||(this._isClick=!0,Laya.timer.once(500,this,function(){e._isClick=null}),this.closeView(),this.openOver())}},{key:"openFighting",value:function(){h.instance.emit("openFighting",!0)}},{key:"openOver",value:function(){X.instance.playBGM(),se.instance.passLevel(2,o.level,Y.Instance.gameResultPlayer,null),h.instance.emit("openGameOver",{isPass:!1,currLevel:o.level})}},{key:"ShowBanner",value:function(){var e=this;1==oe.bannerSwitch[1]?$.callAPIMethodByProxy("showBannerAdResurgence")?this.hideADPanel():1==oe.ctrlInfo.isWudian&&1==oe.wudian_level[1]?(Laya.timer.clear(this,this.showADPanel),Laya.timer.once(oe.ctrlInfo.lateDelay[1],this,this.showADPanel)):this.showADPanel():2==oe.bannerSwitch[1]?1==oe.ctrlInfo.isWudian&&1==oe.wudian_level[1]?Laya.timer.once(oe.ctrlInfo.lateDelay[1],this,function(){e.appBanner.start(40001)}):this.appBanner.start(40001):3==oe.bannerSwitch[1]&&(1==oe.ctrlInfo.isWudian&&1==oe.wudian_level[1]?(Laya.timer.clear(this,this.showADPanel),Laya.timer.once(oe.ctrlInfo.lateDelay[1],this,this.showADPanel)):this.showADPanel())}},{key:"showADPanel",value:function(){var e=this;this.ButtonADPanel.visible=!0,Laya.timer.frameOnce(2,this,function(){e.ButtonAdListloop.init({_cellWidth:130,_cellHeight:156,_spaceX:23}),e.ButtonAdListloop.start(oe.getAdData(30001),30001,"复活页")})}},{key:"hideADPanel",value:function(){this.ButtonADPanel.visible=!1}}]),Resurgence}(),Re=function(e){function TipView(){return _classCallCheck(this,TipView),_possibleConstructorReturn(this,_getPrototypeOf(TipView).apply(this,arguments))}return _inherits(TipView,ce),_createClass(TipView,[{key:"onAwake",value:function(){_get(_getPrototypeOf(TipView.prototype),"onAwake",this).call(this),this.tipLbl=this.owner.getChildByName("image").getChildByName("Label")}},{key:"addEvent",value:function(){this.owner.on(Laya.Event.CLICK,this,this.closeView),_get(_getPrototypeOf(TipView.prototype),"addEvent",this).call(this)}},{key:"removeEvent",value:function(){this.owner.off(Laya.Event.CLICK,this,this.closeView),_get(_getPrototypeOf(TipView.prototype),"removeEvent",this).call(this)}},{key:"openView",value:function(e){var t=this;_get(_getPrototypeOf(TipView.prototype),"openView",this).call(this,e),this.tipLbl.text=e,Laya.timer.once(2e3,this,function(){t.closeView()})}}]),TipView}(),We=function(){function GameConfig(){_classCallCheck(this,GameConfig)}return _createClass(GameConfig,null,[{key:"init",value:function(){var t=Laya.ClassUtils.regClass;t("script/views/ButtonAnim.ts",e),t("script/views/ConvergeAd.ts",ye),t("script/views/ConvergeAdListLoop.ts",de),t("script/views/AdListLoop.ts",pe),t("script/views/AdListLoopNew.ts",fe),t("script/views/ConvergeAdForMainView.ts",be),t("script/views/AppBannerAd.ts",Le),t("script/views/FriendInvite.ts",ke),t("script/views/MainAdListLoop.ts",Ae),t("script/views/GameBox.ts",Ce),t("script/mgr3d/MouseMgr.ts",Be),t("script/views/GameFighting.ts",Pe),t("script/views/GameOver.ts",De),t("script/views/OverAdListLoop.ts",Me),t("script/views/GoldenEggView.ts",xe),t("script/views/PromotionAnimation.ts",Te),t("script/platform/wx/WXLaunch.ts",ee),t("mod/utils/QHFullScreen.ts",Oe),t("mod/views/MainHomeView.ts",je),t("mod/utils/ZUIWidget.ts",Ve),t("script/views/MainView.ts",Ge),t("script/views/Resurgence.ts",Ne),t("script/views/TipView.ts",Re)}}]),GameConfig}();We.width=1334,We.height=750,We.scaleMode="fixedwidth",We.screenMode="horizontal",We.alignV="middle",We.alignH="center",We.startScene="Launch.scene",We.sceneRoot="",We.debug=!1,We.stat=!1,We.physicsDebug=!1,We.exportSceneToJson=!0,We.init();var Fe=function(){function MyInit(){_classCallCheck(this,MyInit)}return _createClass(MyInit,null,[{key:"init",value:function(){oe.initLocal(),$.initPlatform(),q.instance.init(),M.instance.init()}}]),MyInit}();new(function(){function Main(){_classCallCheck(this,Main),Laya.isWXPosMsg=!0,Laya.isWXOpenDataContext=!1,Laya.Text.CharacterCache=!1,Laya.MouseManager.multiTouchEnabled=!1,window.Laya3D?Laya3D.init(We.width,We.height):Laya.init(We.width,We.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=We.scaleMode,Laya.stage.screenMode=We.screenMode,Laya.URL.exportSceneToJson=We.exportSceneToJson,(We.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),We.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),We.stat&&Laya.Stat.show(),Fe.init(),this.onVersionLoaded()}return _createClass(Main,[{key:"onVersionLoaded",value:function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}},{key:"onConfigLoaded",value:function(){var e=[{url:"loading/loading.atlas",type:Laya.Loader.ATLAS}];Laya.loader.load(e,Laya.Handler.create(this,function(){We.startScene&&Laya.Scene.open(We.startScene)}))}}]),Main}())}();